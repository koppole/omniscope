┌──────────────────────────────────────────────────────────────────────────────┐
│                                 PyRosetta-4                                  │
│              Created in JHU by Sergey Lyskov and PyRosetta Team              │
│              (C) Copyright Rosetta Commons Member Institutions               │
│                                                                              │
│ NOTE: USE OF PyRosetta FOR COMMERCIAL PURPOSES REQUIRE PURCHASE OF A LICENSE │
│         See LICENSE.PyRosetta.md or email license@uw.edu for details         │
└──────────────────────────────────────────────────────────────────────────────┘
PyRosetta-4 2025 [Rosetta PyRosetta4.Release.python313.m1 2025.17+release.356248d2035a0749e09a4a79479678a8f54e7220 2025-04-17T21:51:51] retrieved from: http://www.pyrosetta.org
Loaded antibody Ab0 from AB0_Antibody.pdb
Loaded antibody Ab1 from AB1_Antibody.pdb
Loaded peptide 5_peptide_25mer from linear-peptides/5_peptide_25mer.pdb
Loaded peptide 2_peptide_15mer from linear-peptides/2_peptide_15mer.pdb
Loaded peptide 4_peptide_25mer from linear-peptides/4_peptide_25mer.pdb
Loaded peptide 3_peptide_15mer from linear-peptides/3_peptide_15mer.pdb
Loaded peptide 1_peptide_25mer from linear-peptides/1_peptide_25mer.pdb
Loaded peptide 2_peptide_25mer from linear-peptides/2_peptide_25mer.pdb
Loaded peptide 5_peptide_15mer from linear-peptides/5_peptide_15mer.pdb
Loaded peptide 1_peptide_15mer from linear-peptides/1_peptide_15mer.pdb
Loaded peptide 3_peptide_25mer from linear-peptides/3_peptide_25mer.pdb
Loaded peptide 4_peptide_15mer from linear-peptides/4_peptide_15mer.pdb
Loaded peptide 3_peptide_20mer from linear-peptides/3_peptide_20mer.pdb
Loaded peptide 5_peptide_12mer from linear-peptides/5_peptide_12mer.pdb
Loaded peptide 1_peptide_12mer from linear-peptides/1_peptide_12mer.pdb
Loaded peptide 2_peptide_20mer from linear-peptides/2_peptide_20mer.pdb
Loaded peptide 4_peptide_12mer from linear-peptides/4_peptide_12mer.pdb
Loaded peptide 2_peptide_12mer from linear-peptides/2_peptide_12mer.pdb
Loaded peptide 1_peptide_20mer from linear-peptides/1_peptide_20mer.pdb
Loaded peptide 4_peptide_20mer from linear-peptides/4_peptide_20mer.pdb
Loaded peptide 3_peptide_12mer from linear-peptides/3_peptide_12mer.pdb
Loaded peptide 5_peptide_20mer from linear-peptides/5_peptide_20mer.pdb
Extracted sequence for 5_peptide_25mer: PHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLYTYR

===== Analyzing stability for peptide: 5_peptide_25mer =====

Relaxing structure for peptide: 5_peptide_25mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: -0.07

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -0.10, improvement = 0.03
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 4.87, improvement = -4.94
After minimization: energy = 0.31, improvement = -0.38

Relaxation cycle 2/25
After repacking: energy = 4.66, improvement = -4.73
After minimization: energy = 0.33, improvement = -0.40

Relaxation cycle 3/25
After repacking: energy = 4.71, improvement = -4.78
After minimization: energy = 0.33, improvement = -0.40

Relaxation cycle 4/25
After repacking: energy = 4.73, improvement = -4.80
After minimization: energy = 0.35, improvement = -0.42

Relaxation cycle 5/25
After repacking: energy = 4.71, improvement = -4.78
After minimization: energy = 0.30, improvement = -0.37
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = 4.71, improvement = -4.78
After minimization: energy = 0.33, improvement = -0.40

Relaxation cycle 7/25
After repacking: energy = 4.73, improvement = -4.80
After minimization: energy = 0.33, improvement = -0.40

Relaxation cycle 8/25
After repacking: energy = 4.75, improvement = -4.82
After minimization: energy = 0.35, improvement = -0.42

Relaxation cycle 9/25
After repacking: energy = 4.69, improvement = -4.76
After minimization: energy = 0.33, improvement = -0.40

Relaxation cycle 10/25
After repacking: energy = 4.68, improvement = -4.76
After minimization: energy = 0.33, improvement = -0.40
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 4.74, improvement = -4.81
After minimization: energy = 0.31, improvement = -0.38

Relaxation cycle 12/25
After repacking: energy = 4.74, improvement = -4.82
After minimization: energy = 0.33, improvement = -0.40

Relaxation cycle 13/25
After repacking: energy = 4.72, improvement = -4.79
After minimization: energy = 0.36, improvement = -0.43

Relaxation cycle 14/25
After repacking: energy = 4.63, improvement = -4.70
After minimization: energy = 0.33, improvement = -0.40

Relaxation cycle 15/25
After repacking: energy = 4.74, improvement = -4.81
After minimization: energy = 0.31, improvement = -0.38
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 4.67, improvement = -4.74
After minimization: energy = 0.33, improvement = -0.40

Relaxation cycle 17/25
After repacking: energy = 4.73, improvement = -4.80
After minimization: energy = 0.31, improvement = -0.38

Relaxation cycle 18/25
After repacking: energy = 4.79, improvement = -4.86
After minimization: energy = 0.89, improvement = -0.96

Relaxation cycle 19/25
After repacking: energy = 3.88, improvement = -3.95
After minimization: energy = 1.33, improvement = -1.41

Relaxation cycle 20/25
After repacking: energy = 3.77, improvement = -3.84
After minimization: energy = 1.33, improvement = -1.40
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 3.77, improvement = -3.84
After minimization: energy = 1.31, improvement = -1.38

Relaxation cycle 22/25
After repacking: energy = 3.76, improvement = -3.83
After minimization: energy = 1.31, improvement = -1.38

Relaxation cycle 23/25
After repacking: energy = 3.76, improvement = -3.83
After minimization: energy = 1.31, improvement = -1.38

Relaxation cycle 24/25
After repacking: energy = 3.76, improvement = -3.83
After minimization: energy = 1.31, improvement = -1.38

Relaxation cycle 25/25
After repacking: energy = 3.76, improvement = -3.83
After minimization: energy = 1.31, improvement = -1.38
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: -0.07
Final energy: -0.10
Total energy improvement: 0.03 (39.5%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.01 Å, All-atom RMSD = 0.03 Å
Secondary structure before: LLLLLLLLLLLLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/5_peptide_25mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 5_peptide_25mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -0.10
Wrote residue energies to stability_results/5_peptide_25mer_residue_energies.txt
Unstable residues (high energy outliers): [23, 25, 1]
Secondary structure: LLLLLLLLLLLLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.0/10 (Very Low)
Wrote comprehensive stability report to stability_results/5_peptide_25mer_stability_report.txt

Simulating flexibility for relaxed peptide: 5_peptide_25mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 1.62 Å
Maximum pairwise RMSD: 2.04 Å
Peptide flexibility: Medium
Extracted sequence for 2_peptide_15mer: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLYSER

===== Analyzing stability for peptide: 2_peptide_15mer =====

Relaxing structure for peptide: 2_peptide_15mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: -1.15

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -1.86, improvement = 0.71
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 1.20, improvement = -2.35
After minimization: energy = -1.87, improvement = 0.72
Cycle 1 produced the best structure so far

Relaxation cycle 2/25
After repacking: energy = 1.21, improvement = -2.36
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 3/25
After repacking: energy = 1.30, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 4/25
After repacking: energy = 1.30, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 5/25
After repacking: energy = 1.30, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71
Still seeing improvements (best was cycle 1)

Relaxation cycle 6/25
After repacking: energy = 1.30, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 7/25
After repacking: energy = 1.29, improvement = -2.44
After minimization: energy = -1.87, improvement = 0.72

Relaxation cycle 8/25
After repacking: energy = 1.21, improvement = -2.37
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 9/25
After repacking: energy = 1.30, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 10/25
After repacking: energy = 1.29, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71
No improvement in last 5 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 1.29, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 12/25
After repacking: energy = 1.29, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 13/25
After repacking: energy = 1.29, improvement = -2.44
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 14/25
After repacking: energy = 1.29, improvement = -2.44
After minimization: energy = -1.87, improvement = 0.72
Cycle 14 produced the best structure so far

Relaxation cycle 15/25
After repacking: energy = 1.21, improvement = -2.36
After minimization: energy = -1.87, improvement = 0.71
Still seeing improvements (best was cycle 14)

Relaxation cycle 16/25
After repacking: energy = 1.29, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.72

Relaxation cycle 17/25
After repacking: energy = 1.22, improvement = -2.37
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 18/25
After repacking: energy = 1.29, improvement = -2.44
After minimization: energy = -1.87, improvement = 0.72

Relaxation cycle 19/25
After repacking: energy = 1.21, improvement = -2.37
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 20/25
After repacking: energy = 1.30, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.72
Cycle 20 produced the best structure so far
Still seeing improvements (best was cycle 20)

Relaxation cycle 21/25
After repacking: energy = 1.20, improvement = -2.35
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 22/25
After repacking: energy = 1.30, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 23/25
After repacking: energy = 1.30, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 24/25
After repacking: energy = 1.30, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71

Relaxation cycle 25/25
After repacking: energy = 1.30, improvement = -2.45
After minimization: energy = -1.87, improvement = 0.71
Still seeing improvements (best was cycle 20)

=== Relaxation Summary ===
Initial energy: -1.15
Final energy: -1.87
Total energy improvement: 0.72 (62.1%)
Best structure was from cycle 20
Structure change: CA RMSD = 0.01 Å, All-atom RMSD = 0.51 Å
Secondary structure before: LLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/2_peptide_15mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 2_peptide_15mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -1.87
Wrote residue energies to stability_results/2_peptide_15mer_residue_energies.txt
Unstable residues (high energy outliers): [9]
Secondary structure: LLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.3/10 (Very Low)
Wrote comprehensive stability report to stability_results/2_peptide_15mer_stability_report.txt

Simulating flexibility for relaxed peptide: 2_peptide_15mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.59 Å
Maximum pairwise RMSD: 0.72 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 4_peptide_25mer: TYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLY

===== Analyzing stability for peptide: 4_peptide_25mer =====

Relaxing structure for peptide: 4_peptide_25mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: 5.45

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -2.18, improvement = 7.62
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 2.42, improvement = 3.03
After minimization: energy = -2.18, improvement = 7.63
Cycle 1 produced the best structure so far

Relaxation cycle 2/25
After repacking: energy = 2.31, improvement = 3.14
After minimization: energy = -2.19, improvement = 7.64
Cycle 2 produced the best structure so far

Relaxation cycle 3/25
After repacking: energy = 2.27, improvement = 3.18
After minimization: energy = -2.19, improvement = 7.64

Relaxation cycle 4/25
After repacking: energy = 2.30, improvement = 3.15
After minimization: energy = -2.17, improvement = 7.62

Relaxation cycle 5/25
After repacking: energy = 2.27, improvement = 3.18
After minimization: energy = -2.16, improvement = 7.61
Still seeing improvements (best was cycle 2)

Relaxation cycle 6/25
After repacking: energy = 2.30, improvement = 3.15
After minimization: energy = -2.17, improvement = 7.62

Relaxation cycle 7/25
After repacking: energy = 2.41, improvement = 3.04
After minimization: energy = -2.19, improvement = 7.64
Cycle 7 produced the best structure so far

Relaxation cycle 8/25
After repacking: energy = 2.32, improvement = 3.13
After minimization: energy = -2.17, improvement = 7.62

Relaxation cycle 9/25
After repacking: energy = 2.40, improvement = 3.05
After minimization: energy = -2.17, improvement = 7.62

Relaxation cycle 10/25
After repacking: energy = 2.45, improvement = 3.00
After minimization: energy = -2.17, improvement = 7.62
Still seeing improvements (best was cycle 7)

Relaxation cycle 11/25
After repacking: energy = 2.41, improvement = 3.04
After minimization: energy = -2.19, improvement = 7.64
Cycle 11 produced the best structure so far

Relaxation cycle 12/25
After repacking: energy = 2.26, improvement = 3.19
After minimization: energy = -2.19, improvement = 7.64

Relaxation cycle 13/25
After repacking: energy = 2.25, improvement = 3.20
After minimization: energy = -2.19, improvement = 7.63

Relaxation cycle 14/25
After repacking: energy = 2.34, improvement = 3.11
After minimization: energy = -2.19, improvement = 7.64

Relaxation cycle 15/25
After repacking: energy = 2.28, improvement = 3.17
After minimization: energy = -2.19, improvement = 7.64
Still seeing improvements (best was cycle 11)

Relaxation cycle 16/25
After repacking: energy = 2.26, improvement = 3.19
After minimization: energy = -2.17, improvement = 7.62

Relaxation cycle 17/25
After repacking: energy = 2.40, improvement = 3.05
After minimization: energy = -2.19, improvement = 7.64

Relaxation cycle 18/25
After repacking: energy = 2.29, improvement = 3.15
After minimization: energy = -2.19, improvement = 7.64
Cycle 18 produced the best structure so far

Relaxation cycle 19/25
After repacking: energy = 2.24, improvement = 3.21
After minimization: energy = -2.19, improvement = 7.64

Relaxation cycle 20/25
After repacking: energy = 2.35, improvement = 3.10
After minimization: energy = -2.17, improvement = 7.62
Still seeing improvements (best was cycle 18)

Relaxation cycle 21/25
After repacking: energy = 2.40, improvement = 3.05
After minimization: energy = -2.17, improvement = 7.62

Relaxation cycle 22/25
After repacking: energy = 2.39, improvement = 3.06
After minimization: energy = -2.17, improvement = 7.62

Relaxation cycle 23/25
After repacking: energy = 2.40, improvement = 3.05
After minimization: energy = -2.17, improvement = 7.62

Relaxation cycle 24/25
After repacking: energy = 2.44, improvement = 3.01
After minimization: energy = -2.17, improvement = 7.62

Relaxation cycle 25/25
After repacking: energy = 2.42, improvement = 3.03
After minimization: energy = -2.17, improvement = 7.62
No improvement in last 5 cycles (best was cycle 18)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: 5.45
Final energy: -2.19
Total energy improvement: 7.64 (140.3%)
Best structure was from cycle 18
Structure change: CA RMSD = 0.27 Å, All-atom RMSD = 0.30 Å
Secondary structure before: LLLLLLLLLLLLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/4_peptide_25mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 4_peptide_25mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -2.19
Wrote residue energies to stability_results/4_peptide_25mer_residue_energies.txt
Unstable residues (high energy outliers): [3, 1, 12]
Secondary structure: LLLLLLLLLLLLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.2/10 (Very Low)
Wrote comprehensive stability report to stability_results/4_peptide_25mer_stability_report.txt

Simulating flexibility for relaxed peptide: 4_peptide_25mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 1.39 Å
Maximum pairwise RMSD: 2.11 Å
Peptide flexibility: Medium
Extracted sequence for 3_peptide_15mer: ASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASN

===== Analyzing stability for peptide: 3_peptide_15mer =====

Relaxing structure for peptide: 3_peptide_15mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: 2.64

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = 2.37, improvement = 0.27
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 3.53, improvement = -0.89
After minimization: energy = 2.35, improvement = 0.29
Cycle 1 produced the best structure so far

Relaxation cycle 2/25
After repacking: energy = 3.33, improvement = -0.69
After minimization: energy = 2.34, improvement = 0.30
Cycle 2 produced the best structure so far

Relaxation cycle 3/25
After repacking: energy = 3.31, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 4/25
After repacking: energy = 3.31, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 5/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30
Still seeing improvements (best was cycle 2)

Relaxation cycle 6/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 7/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 8/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 9/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 10/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30
No improvement in last 5 cycles (best was cycle 2)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 3.31, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 12/25
After repacking: energy = 3.31, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 13/25
After repacking: energy = 3.31, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 14/25
After repacking: energy = 3.31, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 15/25
After repacking: energy = 3.32, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30
No improvement in last 5 cycles (best was cycle 2)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 17/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 18/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 19/25
After repacking: energy = 3.31, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 20/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30
No improvement in last 5 cycles (best was cycle 2)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 3.31, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 22/25
After repacking: energy = 3.31, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 23/25
After repacking: energy = 3.32, improvement = -0.67
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 24/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30

Relaxation cycle 25/25
After repacking: energy = 3.32, improvement = -0.68
After minimization: energy = 2.34, improvement = 0.30
No improvement in last 5 cycles (best was cycle 2)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: 2.64
Final energy: 2.34
Total energy improvement: 0.30 (11.3%)
Best structure was from cycle 2
Structure change: CA RMSD = 0.03 Å, All-atom RMSD = 0.09 Å
Secondary structure before: LLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/3_peptide_15mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 3_peptide_15mer

=== Computing Peptide Stability Metrics ===
Overall energy score: 2.34
Wrote residue energies to stability_results/3_peptide_15mer_residue_energies.txt
Unstable residues (high energy outliers): [5]
Secondary structure: LLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.0/10 (Very Low)
Wrote comprehensive stability report to stability_results/3_peptide_15mer_stability_report.txt

Simulating flexibility for relaxed peptide: 3_peptide_15mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.82 Å
Maximum pairwise RMSD: 1.37 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 1_peptide_25mer: LEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLY

===== Analyzing stability for peptide: 1_peptide_25mer =====

Relaxing structure for peptide: 1_peptide_25mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: 1.03

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = 0.37, improvement = 0.67
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 4.02, improvement = -2.99
After minimization: energy = 0.71, improvement = 0.33

Relaxation cycle 2/25
After repacking: energy = 3.60, improvement = -2.56
After minimization: energy = 0.67, improvement = 0.36

Relaxation cycle 3/25
After repacking: energy = 3.66, improvement = -2.62
After minimization: energy = 0.68, improvement = 0.36

Relaxation cycle 4/25
After repacking: energy = 3.65, improvement = -2.61
After minimization: energy = 0.67, improvement = 0.36

Relaxation cycle 5/25
After repacking: energy = 3.65, improvement = -2.62
After minimization: energy = 0.68, improvement = 0.35
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = 3.62, improvement = -2.59
After minimization: energy = 0.71, improvement = 0.33

Relaxation cycle 7/25
After repacking: energy = 3.59, improvement = -2.55
After minimization: energy = 0.67, improvement = 0.36

Relaxation cycle 8/25
After repacking: energy = 3.66, improvement = -2.62
After minimization: energy = 0.68, improvement = 0.35

Relaxation cycle 9/25
After repacking: energy = 3.63, improvement = -2.60
After minimization: energy = 0.68, improvement = 0.35

Relaxation cycle 10/25
After repacking: energy = 3.62, improvement = -2.59
After minimization: energy = 0.67, improvement = 0.36
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 3.65, improvement = -2.62
After minimization: energy = 0.68, improvement = 0.35

Relaxation cycle 12/25
After repacking: energy = 3.61, improvement = -2.58
After minimization: energy = 0.68, improvement = 0.35

Relaxation cycle 13/25
After repacking: energy = 3.63, improvement = -2.60
After minimization: energy = 0.68, improvement = 0.35

Relaxation cycle 14/25
After repacking: energy = 3.60, improvement = -2.57
After minimization: energy = 0.68, improvement = 0.36

Relaxation cycle 15/25
After repacking: energy = 3.65, improvement = -2.62
After minimization: energy = 0.68, improvement = 0.35
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 3.63, improvement = -2.60
After minimization: energy = 0.67, improvement = 0.36

Relaxation cycle 17/25
After repacking: energy = 3.66, improvement = -2.62
After minimization: energy = 0.67, improvement = 0.36

Relaxation cycle 18/25
After repacking: energy = 3.66, improvement = -2.62
After minimization: energy = 0.68, improvement = 0.35

Relaxation cycle 19/25
After repacking: energy = 3.62, improvement = -2.59
After minimization: energy = 0.67, improvement = 0.36

Relaxation cycle 20/25
After repacking: energy = 3.67, improvement = -2.64
After minimization: energy = 0.68, improvement = 0.35
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 3.61, improvement = -2.57
After minimization: energy = 0.68, improvement = 0.35

Relaxation cycle 22/25
After repacking: energy = 3.62, improvement = -2.59
After minimization: energy = 0.67, improvement = 0.36

Relaxation cycle 23/25
After repacking: energy = 3.66, improvement = -2.62
After minimization: energy = 0.68, improvement = 0.35

Relaxation cycle 24/25
After repacking: energy = 3.62, improvement = -2.59
After minimization: energy = 0.68, improvement = 0.35

Relaxation cycle 25/25
After repacking: energy = 3.63, improvement = -2.59
After minimization: energy = 0.68, improvement = 0.35
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: 1.03
Final energy: 0.37
Total energy improvement: 0.67 (64.4%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.01 Å, All-atom RMSD = 0.04 Å
Secondary structure before: LLLLLLLLLLLLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/1_peptide_25mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 1_peptide_25mer

=== Computing Peptide Stability Metrics ===
Overall energy score: 0.37
Wrote residue energies to stability_results/1_peptide_25mer_residue_energies.txt
Unstable residues (high energy outliers): [24]
Secondary structure: LLLLLLLLLLLLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.0/10 (Very Low)
Wrote comprehensive stability report to stability_results/1_peptide_25mer_stability_report.txt

Simulating flexibility for relaxed peptide: 1_peptide_25mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 1.75 Å
Maximum pairwise RMSD: 2.92 Å
Peptide flexibility: Medium
Extracted sequence for 2_peptide_25mer: TYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVAL

===== Analyzing stability for peptide: 2_peptide_25mer =====

Relaxing structure for peptide: 2_peptide_25mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: -2.32

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -2.31, improvement = -0.01

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 2.88, improvement = -5.20
After minimization: energy = -2.11, improvement = -0.21

Relaxation cycle 2/25
After repacking: energy = 3.10, improvement = -5.42
After minimization: energy = -2.11, improvement = -0.21

Relaxation cycle 3/25
After repacking: energy = 3.09, improvement = -5.41
After minimization: energy = -2.11, improvement = -0.21

Relaxation cycle 4/25
After repacking: energy = 3.13, improvement = -5.45
After minimization: energy = -2.11, improvement = -0.21

Relaxation cycle 5/25
After repacking: energy = 2.92, improvement = -5.24
After minimization: energy = -2.14, improvement = -0.18
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = 2.91, improvement = -5.23
After minimization: energy = -2.12, improvement = -0.20

Relaxation cycle 7/25
After repacking: energy = 2.92, improvement = -5.24
After minimization: energy = -2.14, improvement = -0.18

Relaxation cycle 8/25
After repacking: energy = 2.91, improvement = -5.24
After minimization: energy = -2.14, improvement = -0.19

Relaxation cycle 9/25
After repacking: energy = 2.90, improvement = -5.22
After minimization: energy = -2.13, improvement = -0.19

Relaxation cycle 10/25
After repacking: energy = 2.94, improvement = -5.26
After minimization: energy = -2.14, improvement = -0.18
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 2.91, improvement = -5.24
After minimization: energy = -2.14, improvement = -0.18

Relaxation cycle 12/25
After repacking: energy = 2.92, improvement = -5.24
After minimization: energy = -2.11, improvement = -0.21

Relaxation cycle 13/25
After repacking: energy = 3.08, improvement = -5.40
After minimization: energy = -2.12, improvement = -0.20

Relaxation cycle 14/25
After repacking: energy = 2.98, improvement = -5.30
After minimization: energy = -2.14, improvement = -0.18

Relaxation cycle 15/25
After repacking: energy = 2.92, improvement = -5.24
After minimization: energy = -2.14, improvement = -0.18
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 2.91, improvement = -5.23
After minimization: energy = -2.12, improvement = -0.20

Relaxation cycle 17/25
After repacking: energy = 2.95, improvement = -5.27
After minimization: energy = -2.11, improvement = -0.21

Relaxation cycle 18/25
After repacking: energy = 3.11, improvement = -5.43
After minimization: energy = -2.12, improvement = -0.20

Relaxation cycle 19/25
After repacking: energy = 2.97, improvement = -5.29
After minimization: energy = -2.14, improvement = -0.18

Relaxation cycle 20/25
After repacking: energy = 2.91, improvement = -5.23
After minimization: energy = -2.14, improvement = -0.18
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 2.92, improvement = -5.24
After minimization: energy = -2.14, improvement = -0.18

Relaxation cycle 22/25
After repacking: energy = 2.91, improvement = -5.23
After minimization: energy = -2.14, improvement = -0.18

Relaxation cycle 23/25
After repacking: energy = 2.91, improvement = -5.23
After minimization: energy = -2.12, improvement = -0.20

Relaxation cycle 24/25
After repacking: energy = 2.93, improvement = -5.25
After minimization: energy = -2.14, improvement = -0.18

Relaxation cycle 25/25
After repacking: energy = 2.91, improvement = -5.24
After minimization: energy = -2.14, improvement = -0.18
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: -2.32
Final energy: -2.32
Total energy improvement: 0.00 (0.0%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.00 Å, All-atom RMSD = 0.00 Å
Secondary structure before: LLLLLLLLLLLLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/2_peptide_25mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 2_peptide_25mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -2.32
Wrote residue energies to stability_results/2_peptide_25mer_residue_energies.txt
Unstable residues (high energy outliers): [25]
Secondary structure: LLLLLLLLLLLLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.2/10 (Very Low)
Wrote comprehensive stability report to stability_results/2_peptide_25mer_stability_report.txt

Simulating flexibility for relaxed peptide: 2_peptide_25mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 1.65 Å
Maximum pairwise RMSD: 2.28 Å
Peptide flexibility: Medium
Extracted sequence for 5_peptide_15mer: PHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLN

===== Analyzing stability for peptide: 5_peptide_15mer =====

Relaxing structure for peptide: 5_peptide_15mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: 1.97

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -1.12, improvement = 3.08
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 2.29, improvement = -0.32
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 2/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 3/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 4/25
After repacking: energy = 2.30, improvement = -0.33
After minimization: energy = 0.55, improvement = 1.42

Relaxation cycle 5/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = 2.30, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 7/25
After repacking: energy = 2.30, improvement = -0.33
After minimization: energy = 0.55, improvement = 1.42

Relaxation cycle 8/25
After repacking: energy = 2.30, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 9/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.55, improvement = 1.42

Relaxation cycle 10/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.55, improvement = 1.42
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.55, improvement = 1.42

Relaxation cycle 12/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 13/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 14/25
After repacking: energy = 2.29, improvement = -0.32
After minimization: energy = 0.55, improvement = 1.42

Relaxation cycle 15/25
After repacking: energy = 2.30, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 17/25
After repacking: energy = 2.30, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 18/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.55, improvement = 1.42

Relaxation cycle 19/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 20/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.55, improvement = 1.42

Relaxation cycle 22/25
After repacking: energy = 2.29, improvement = -0.33
After minimization: energy = 0.55, improvement = 1.42

Relaxation cycle 23/25
After repacking: energy = 2.30, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 24/25
After repacking: energy = 2.30, improvement = -0.33
After minimization: energy = 0.54, improvement = 1.42

Relaxation cycle 25/25
After repacking: energy = 2.30, improvement = -0.33
After minimization: energy = 0.55, improvement = 1.42
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: 1.97
Final energy: -1.12
Total energy improvement: 3.08 (156.9%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.14 Å, All-atom RMSD = 1.00 Å
Secondary structure before: LLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/5_peptide_15mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 5_peptide_15mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -1.12
Wrote residue energies to stability_results/5_peptide_15mer_residue_energies.txt
Unstable residues (high energy outliers): [13]
Secondary structure: LLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.2/10 (Very Low)
Wrote comprehensive stability report to stability_results/5_peptide_15mer_stability_report.txt

Simulating flexibility for relaxed peptide: 5_peptide_15mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.79 Å
Maximum pairwise RMSD: 1.11 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 1_peptide_15mer: ARGARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLY

===== Analyzing stability for peptide: 1_peptide_15mer =====

Relaxing structure for peptide: 1_peptide_15mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: 5.50

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = 3.44, improvement = 2.06
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 5.05, improvement = 0.44
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 2/25
After repacking: energy = 4.96, improvement = 0.54
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 3/25
After repacking: energy = 4.92, improvement = 0.58
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 4/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 5/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 7/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 8/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 9/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 10/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 12/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 13/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 14/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 15/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 17/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 18/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 19/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 20/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 4.90, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 22/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 23/25
After repacking: energy = 4.90, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 24/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05

Relaxation cycle 25/25
After repacking: energy = 4.91, improvement = 0.59
After minimization: energy = 3.45, improvement = 2.05
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: 5.50
Final energy: 3.44
Total energy improvement: 2.06 (37.4%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.03 Å, All-atom RMSD = 0.40 Å
Secondary structure before: LLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/1_peptide_15mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 1_peptide_15mer

=== Computing Peptide Stability Metrics ===
Overall energy score: 3.44
Wrote residue energies to stability_results/1_peptide_15mer_residue_energies.txt
Unstable residues (high energy outliers): [10]
Secondary structure: LLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.0/10 (Very Low)
Wrote comprehensive stability report to stability_results/1_peptide_15mer_stability_report.txt

Simulating flexibility for relaxed peptide: 1_peptide_15mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.78 Å
Maximum pairwise RMSD: 1.37 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 3_peptide_25mer: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSER

===== Analyzing stability for peptide: 3_peptide_25mer =====

Relaxing structure for peptide: 3_peptide_25mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: -0.95

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -3.71, improvement = 2.76
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 1.39, improvement = -2.34
After minimization: energy = -3.71, improvement = 2.76

Relaxation cycle 2/25
After repacking: energy = 1.49, improvement = -2.44
After minimization: energy = -3.72, improvement = 2.77
Cycle 2 produced the best structure so far

Relaxation cycle 3/25
After repacking: energy = 1.40, improvement = -2.35
After minimization: energy = -3.70, improvement = 2.75

Relaxation cycle 4/25
After repacking: energy = 1.43, improvement = -2.38
After minimization: energy = -3.70, improvement = 2.75

Relaxation cycle 5/25
After repacking: energy = 1.41, improvement = -2.36
After minimization: energy = -3.69, improvement = 2.74
Still seeing improvements (best was cycle 2)

Relaxation cycle 6/25
After repacking: energy = 1.48, improvement = -2.43
After minimization: energy = -3.70, improvement = 2.75

Relaxation cycle 7/25
After repacking: energy = 1.51, improvement = -2.46
After minimization: energy = -3.72, improvement = 2.77
Cycle 7 produced the best structure so far

Relaxation cycle 8/25
After repacking: energy = 1.34, improvement = -2.29
After minimization: energy = -3.72, improvement = 2.77

Relaxation cycle 9/25
After repacking: energy = 1.39, improvement = -2.34
After minimization: energy = -3.69, improvement = 2.74

Relaxation cycle 10/25
After repacking: energy = 1.44, improvement = -2.39
After minimization: energy = -3.69, improvement = 2.74
Still seeing improvements (best was cycle 7)

Relaxation cycle 11/25
After repacking: energy = 1.47, improvement = -2.42
After minimization: energy = -3.69, improvement = 2.74

Relaxation cycle 12/25
After repacking: energy = 1.48, improvement = -2.43
After minimization: energy = -3.71, improvement = 2.75

Relaxation cycle 13/25
After repacking: energy = 1.50, improvement = -2.45
After minimization: energy = -3.72, improvement = 2.77

Relaxation cycle 14/25
After repacking: energy = 1.35, improvement = -2.30
After minimization: energy = -3.72, improvement = 2.77

Relaxation cycle 15/25
After repacking: energy = 1.40, improvement = -2.35
After minimization: energy = -3.70, improvement = 2.75
No improvement in last 5 cycles (best was cycle 7)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 1.48, improvement = -2.43
After minimization: energy = -3.72, improvement = 2.77

Relaxation cycle 17/25
After repacking: energy = 1.35, improvement = -2.30
After minimization: energy = -3.70, improvement = 2.75

Relaxation cycle 18/25
After repacking: energy = 1.39, improvement = -2.34
After minimization: energy = -3.72, improvement = 2.77

Relaxation cycle 19/25
After repacking: energy = 1.37, improvement = -2.32
After minimization: energy = -3.72, improvement = 2.77
Cycle 19 produced the best structure so far

Relaxation cycle 20/25
After repacking: energy = 1.37, improvement = -2.32
After minimization: energy = -3.72, improvement = 2.77
Still seeing improvements (best was cycle 19)

Relaxation cycle 21/25
After repacking: energy = 1.28, improvement = -2.24
After minimization: energy = -3.70, improvement = 2.75

Relaxation cycle 22/25
After repacking: energy = 1.38, improvement = -2.33
After minimization: energy = -3.72, improvement = 2.77

Relaxation cycle 23/25
After repacking: energy = 1.34, improvement = -2.29
After minimization: energy = -3.70, improvement = 2.75

Relaxation cycle 24/25
After repacking: energy = 1.40, improvement = -2.35
After minimization: energy = -3.72, improvement = 2.77

Relaxation cycle 25/25
After repacking: energy = 1.32, improvement = -2.27
After minimization: energy = -3.70, improvement = 2.75
No improvement in last 5 cycles (best was cycle 19)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: -0.95
Final energy: -3.72
Total energy improvement: 2.77 (291.6%)
Best structure was from cycle 19
Structure change: CA RMSD = 0.03 Å, All-atom RMSD = 0.85 Å
Secondary structure before: LLLLLLLLLLLLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/3_peptide_25mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 3_peptide_25mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -3.72
Wrote residue energies to stability_results/3_peptide_25mer_residue_energies.txt
Unstable residues (high energy outliers): [9, 18]
Secondary structure: LLLLLLLLLLLLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.3/10 (Very Low)
Wrote comprehensive stability report to stability_results/3_peptide_25mer_stability_report.txt

Simulating flexibility for relaxed peptide: 3_peptide_25mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 1.36 Å
Maximum pairwise RMSD: 1.72 Å
Peptide flexibility: Medium
Extracted sequence for 4_peptide_15mer: CYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLYTYR

===== Analyzing stability for peptide: 4_peptide_15mer =====

Relaxing structure for peptide: 4_peptide_15mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: 2.60

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = 1.58, improvement = 1.02
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 4.03, improvement = -1.43
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 2/25
After repacking: energy = 3.92, improvement = -1.32
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 3/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 4/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 5/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 7/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 8/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 9/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 10/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 12/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 13/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 14/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60

Relaxation cycle 15/25
After repacking: energy = 3.91, improvement = -1.31
After minimization: energy = 2.00, improvement = 0.60
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 3.91, improvement = -1.30
After minimization: energy = 2.00, improvement = 0.61

Relaxation cycle 17/25
After repacking: energy = 3.90, improvement = -1.30
After minimization: energy = 2.00, improvement = 0.61

Relaxation cycle 18/25
After repacking: energy = 3.91, improvement = -1.30
After minimization: energy = 2.00, improvement = 0.61

Relaxation cycle 19/25
After repacking: energy = 3.91, improvement = -1.30
After minimization: energy = 2.00, improvement = 0.61

Relaxation cycle 20/25
After repacking: energy = 3.90, improvement = -1.30
After minimization: energy = 2.00, improvement = 0.61
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 3.90, improvement = -1.30
After minimization: energy = 2.00, improvement = 0.61

Relaxation cycle 22/25
After repacking: energy = 3.91, improvement = -1.30
After minimization: energy = 2.00, improvement = 0.61

Relaxation cycle 23/25
After repacking: energy = 3.90, improvement = -1.30
After minimization: energy = 2.00, improvement = 0.61

Relaxation cycle 24/25
After repacking: energy = 3.91, improvement = -1.30
After minimization: energy = 2.00, improvement = 0.61

Relaxation cycle 25/25
After repacking: energy = 3.90, improvement = -1.30
After minimization: energy = 2.00, improvement = 0.61
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: 2.60
Final energy: 1.58
Total energy improvement: 1.02 (39.2%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.00 Å, All-atom RMSD = 0.32 Å
Secondary structure before: LLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/4_peptide_15mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 4_peptide_15mer

=== Computing Peptide Stability Metrics ===
Overall energy score: 1.58
Wrote residue energies to stability_results/4_peptide_15mer_residue_energies.txt
Unstable residues (high energy outliers): [13, 15]
Secondary structure: LLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.0/10 (Very Low)
Wrote comprehensive stability report to stability_results/4_peptide_15mer_stability_report.txt

Simulating flexibility for relaxed peptide: 4_peptide_15mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.95 Å
Maximum pairwise RMSD: 1.51 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 3_peptide_20mer: SERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLYTYR

===== Analyzing stability for peptide: 3_peptide_20mer =====

Relaxing structure for peptide: 3_peptide_20mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: -0.20

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -0.50, improvement = 0.31
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 2.33, improvement = -2.52
After minimization: energy = -0.11, improvement = -0.09

Relaxation cycle 2/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.10, improvement = -0.10

Relaxation cycle 3/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.11, improvement = -0.09

Relaxation cycle 4/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.10, improvement = -0.10

Relaxation cycle 5/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.11, improvement = -0.09
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = 2.22, improvement = -2.41
After minimization: energy = -0.10, improvement = -0.10

Relaxation cycle 7/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.11, improvement = -0.09

Relaxation cycle 8/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.10, improvement = -0.10

Relaxation cycle 9/25
After repacking: energy = 2.21, improvement = -2.40
After minimization: energy = -0.11, improvement = -0.09

Relaxation cycle 10/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.10, improvement = -0.10
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.11, improvement = -0.09

Relaxation cycle 12/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.10, improvement = -0.10

Relaxation cycle 13/25
After repacking: energy = 2.21, improvement = -2.40
After minimization: energy = -0.10, improvement = -0.10

Relaxation cycle 14/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.08, improvement = -0.12

Relaxation cycle 15/25
After repacking: energy = 2.21, improvement = -2.40
After minimization: energy = -0.11, improvement = -0.09
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 2.22, improvement = -2.41
After minimization: energy = -0.11, improvement = -0.09

Relaxation cycle 17/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.10, improvement = -0.10

Relaxation cycle 18/25
After repacking: energy = 2.20, improvement = -2.40
After minimization: energy = -0.08, improvement = -0.12

Relaxation cycle 19/25
After repacking: energy = 2.22, improvement = -2.41
After minimization: energy = -0.11, improvement = -0.09

Relaxation cycle 20/25
After repacking: energy = 2.22, improvement = -2.41
After minimization: energy = -0.10, improvement = -0.10
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 2.21, improvement = -2.41
After minimization: energy = -0.11, improvement = -0.09

Relaxation cycle 22/25
After repacking: energy = 2.22, improvement = -2.41
After minimization: energy = -0.07, improvement = -0.12

Relaxation cycle 23/25
After repacking: energy = 2.22, improvement = -2.41
After minimization: energy = -0.11, improvement = -0.09

Relaxation cycle 24/25
After repacking: energy = 2.22, improvement = -2.41
After minimization: energy = -0.08, improvement = -0.12

Relaxation cycle 25/25
After repacking: energy = 2.21, improvement = -2.40
After minimization: energy = -0.10, improvement = -0.10
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: -0.20
Final energy: -0.50
Total energy improvement: 0.31 (156.6%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.01 Å, All-atom RMSD = 0.03 Å
Secondary structure before: LLLLLLLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/3_peptide_20mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 3_peptide_20mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -0.50
Wrote residue energies to stability_results/3_peptide_20mer_residue_energies.txt
Unstable residues (high energy outliers): [18, 20]
Secondary structure: LLLLLLLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.1/10 (Very Low)
Wrote comprehensive stability report to stability_results/3_peptide_20mer_stability_report.txt

Simulating flexibility for relaxed peptide: 3_peptide_20mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 1.12 Å
Maximum pairwise RMSD: 1.99 Å
Peptide flexibility: Medium
Extracted sequence for 5_peptide_12mer: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYR

===== Analyzing stability for peptide: 5_peptide_12mer =====

Relaxing structure for peptide: 5_peptide_12mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: 3.01

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = 2.74, improvement = 0.26
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 3.87, improvement = -0.86
After minimization: energy = 2.74, improvement = 0.26
Cycle 1 produced the best structure so far

Relaxation cycle 2/25
After repacking: energy = 3.85, improvement = -0.85
After minimization: energy = 2.74, improvement = 0.26
Cycle 2 produced the best structure so far

Relaxation cycle 3/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 4/25
After repacking: energy = 3.84, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.27
Cycle 4 produced the best structure so far

Relaxation cycle 5/25
After repacking: energy = 3.84, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26
Still seeing improvements (best was cycle 4)

Relaxation cycle 6/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 7/25
After repacking: energy = 3.84, improvement = -0.83
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 8/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 9/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 10/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26
No improvement in last 5 cycles (best was cycle 4)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 3.84, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 12/25
After repacking: energy = 3.84, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 13/25
After repacking: energy = 3.84, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 14/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.27

Relaxation cycle 15/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26
No improvement in last 5 cycles (best was cycle 4)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.27
Cycle 16 produced the best structure so far

Relaxation cycle 17/25
After repacking: energy = 3.84, improvement = -0.83
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 18/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 19/25
After repacking: energy = 3.84, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 20/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26
Still seeing improvements (best was cycle 16)

Relaxation cycle 21/25
After repacking: energy = 3.84, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 22/25
After repacking: energy = 3.85, improvement = -0.85
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 23/25
After repacking: energy = 3.84, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 24/25
After repacking: energy = 3.85, improvement = -0.84
After minimization: energy = 2.74, improvement = 0.26

Relaxation cycle 25/25
After repacking: energy = 3.84, improvement = -0.83
After minimization: energy = 2.74, improvement = 0.26
No improvement in last 5 cycles (best was cycle 16)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: 3.01
Final energy: 2.74
Total energy improvement: 0.27 (8.8%)
Best structure was from cycle 16
Structure change: CA RMSD = 0.02 Å, All-atom RMSD = 0.23 Å
Secondary structure before: LLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLL
Saved relaxed structure to stability_results/5_peptide_12mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 5_peptide_12mer

=== Computing Peptide Stability Metrics ===
Overall energy score: 2.74
Wrote residue energies to stability_results/5_peptide_12mer_residue_energies.txt
Unstable residues (high energy outliers): [9]
Secondary structure: LLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.0/10 (Very Low)
Wrote comprehensive stability report to stability_results/5_peptide_12mer_stability_report.txt

Simulating flexibility for relaxed peptide: 5_peptide_12mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.53 Å
Maximum pairwise RMSD: 0.70 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 1_peptide_12mer: ALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLN

===== Analyzing stability for peptide: 1_peptide_12mer =====

Relaxing structure for peptide: 1_peptide_12mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: -1.42

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -1.43, improvement = 0.01
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 0.92, improvement = -2.34
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 2/25
After repacking: energy = 0.98, improvement = -2.39
After minimization: energy = -1.42, improvement = -0.00

Relaxation cycle 3/25
After repacking: energy = 0.93, improvement = -2.35
After minimization: energy = -1.42, improvement = -0.00

Relaxation cycle 4/25
After repacking: energy = 0.93, improvement = -2.35
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 5/25
After repacking: energy = 0.97, improvement = -2.39
After minimization: energy = -1.42, improvement = -0.00
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = 0.93, improvement = -2.35
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 7/25
After repacking: energy = 0.94, improvement = -2.36
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 8/25
After repacking: energy = 0.93, improvement = -2.35
After minimization: energy = -1.42, improvement = -0.00

Relaxation cycle 9/25
After repacking: energy = 0.92, improvement = -2.34
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 10/25
After repacking: energy = 0.97, improvement = -2.39
After minimization: energy = -1.42, improvement = -0.00
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 0.93, improvement = -2.35
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 12/25
After repacking: energy = 0.94, improvement = -2.36
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 13/25
After repacking: energy = 0.94, improvement = -2.36
After minimization: energy = -1.42, improvement = -0.00

Relaxation cycle 14/25
After repacking: energy = 0.92, improvement = -2.34
After minimization: energy = -1.40, improvement = -0.01

Relaxation cycle 15/25
After repacking: energy = 0.98, improvement = -2.39
After minimization: energy = -1.42, improvement = -0.00
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 0.93, improvement = -2.34
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 17/25
After repacking: energy = 0.94, improvement = -2.36
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 18/25
After repacking: energy = 0.94, improvement = -2.36
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 19/25
After repacking: energy = 0.93, improvement = -2.35
After minimization: energy = -1.42, improvement = -0.00

Relaxation cycle 20/25
After repacking: energy = 0.92, improvement = -2.34
After minimization: energy = -1.42, improvement = -0.00
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 0.92, improvement = -2.34
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 22/25
After repacking: energy = 0.93, improvement = -2.35
After minimization: energy = -1.42, improvement = -0.00

Relaxation cycle 23/25
After repacking: energy = 0.93, improvement = -2.35
After minimization: energy = -1.41, improvement = -0.00

Relaxation cycle 24/25
After repacking: energy = 0.93, improvement = -2.35
After minimization: energy = -1.41, improvement = -0.01

Relaxation cycle 25/25
After repacking: energy = 0.94, improvement = -2.36
After minimization: energy = -1.42, improvement = -0.00
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: -1.42
Final energy: -1.43
Total energy improvement: 0.01 (0.7%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.01 Å, All-atom RMSD = 0.02 Å
Secondary structure before: LLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLL
Saved relaxed structure to stability_results/1_peptide_12mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 1_peptide_12mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -1.43
Wrote residue energies to stability_results/1_peptide_12mer_residue_energies.txt
Unstable residues (high energy outliers): [10]
Secondary structure: LLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.3/10 (Very Low)
Wrote comprehensive stability report to stability_results/1_peptide_12mer_stability_report.txt

Simulating flexibility for relaxed peptide: 1_peptide_12mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.55 Å
Maximum pairwise RMSD: 0.91 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 2_peptide_20mer: ILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASN

===== Analyzing stability for peptide: 2_peptide_20mer =====

Relaxing structure for peptide: 2_peptide_20mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: -1.25

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -1.92, improvement = 0.67
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = -0.10, improvement = -1.15
After minimization: energy = -1.88, improvement = 0.64

Relaxation cycle 2/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 3/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 4/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 5/25
After repacking: energy = -0.08, improvement = -1.16
After minimization: energy = -1.89, improvement = 0.64
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.88, improvement = 0.64

Relaxation cycle 7/25
After repacking: energy = -0.07, improvement = -1.18
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 8/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 9/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 10/25
After repacking: energy = -0.08, improvement = -1.16
After minimization: energy = -1.89, improvement = 0.64
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = -0.06, improvement = -1.19
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 12/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 13/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 14/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.90, improvement = 0.65

Relaxation cycle 15/25
After repacking: energy = -0.10, improvement = -1.14
After minimization: energy = -1.90, improvement = 0.65
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 17/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 18/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 19/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 20/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 22/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 23/25
After repacking: energy = -0.08, improvement = -1.17
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 24/25
After repacking: energy = -0.09, improvement = -1.16
After minimization: energy = -1.89, improvement = 0.64

Relaxation cycle 25/25
After repacking: energy = -0.09, improvement = -1.16
After minimization: energy = -1.90, improvement = 0.65
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: -1.25
Final energy: -1.92
Total energy improvement: 0.67 (53.7%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.01 Å, All-atom RMSD = 0.10 Å
Secondary structure before: LLLLLLLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/2_peptide_20mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 2_peptide_20mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -1.92
Wrote residue energies to stability_results/2_peptide_20mer_residue_energies.txt
Unstable residues (high energy outliers): [1, 8]
Secondary structure: LLLLLLLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.2/10 (Very Low)
Wrote comprehensive stability report to stability_results/2_peptide_20mer_stability_report.txt

Simulating flexibility for relaxed peptide: 2_peptide_20mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 1.40 Å
Maximum pairwise RMSD: 2.34 Å
Peptide flexibility: Medium
Extracted sequence for 4_peptide_12mer: GLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSER

===== Analyzing stability for peptide: 4_peptide_12mer =====

Relaxing structure for peptide: 4_peptide_12mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: -2.29

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -2.51, improvement = 0.23
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = -1.28, improvement = -1.01
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 2/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 3/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.46, improvement = 0.18

Relaxation cycle 4/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.47, improvement = 0.19

Relaxation cycle 5/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.48, improvement = 0.19
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 7/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.48, improvement = 0.19

Relaxation cycle 8/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 9/25
After repacking: energy = -1.36, improvement = -0.93
After minimization: energy = -2.48, improvement = 0.19

Relaxation cycle 10/25
After repacking: energy = -1.36, improvement = -0.92
After minimization: energy = -2.47, improvement = 0.18
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.48, improvement = 0.19

Relaxation cycle 12/25
After repacking: energy = -1.36, improvement = -0.93
After minimization: energy = -2.48, improvement = 0.19

Relaxation cycle 13/25
After repacking: energy = -1.36, improvement = -0.92
After minimization: energy = -2.48, improvement = 0.19

Relaxation cycle 14/25
After repacking: energy = -1.36, improvement = -0.92
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 15/25
After repacking: energy = -1.38, improvement = -0.91
After minimization: energy = -2.48, improvement = 0.19
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = -1.36, improvement = -0.92
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 17/25
After repacking: energy = -1.37, improvement = -0.91
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 18/25
After repacking: energy = -1.36, improvement = -0.93
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 19/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.48, improvement = 0.19

Relaxation cycle 20/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.48, improvement = 0.19
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = -1.37, improvement = -0.91
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 22/25
After repacking: energy = -1.37, improvement = -0.91
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 23/25
After repacking: energy = -1.36, improvement = -0.93
After minimization: energy = -2.48, improvement = 0.19

Relaxation cycle 24/25
After repacking: energy = -1.37, improvement = -0.92
After minimization: energy = -2.47, improvement = 0.18

Relaxation cycle 25/25
After repacking: energy = -1.36, improvement = -0.92
After minimization: energy = -2.48, improvement = 0.19
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: -2.29
Final energy: -2.51
Total energy improvement: 0.23 (9.9%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.07 Å, All-atom RMSD = 0.11 Å
Secondary structure before: LLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLL
Saved relaxed structure to stability_results/4_peptide_12mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 4_peptide_12mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -2.51
Wrote residue energies to stability_results/4_peptide_12mer_residue_energies.txt
Unstable residues (high energy outliers): [5]
Secondary structure: LLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.5/10 (Very Low)
Wrote comprehensive stability report to stability_results/4_peptide_12mer_stability_report.txt

Simulating flexibility for relaxed peptide: 4_peptide_12mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.65 Å
Maximum pairwise RMSD: 1.07 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 2_peptide_12mer: LEUPHEILETYRALAGLYSERGLUGLYPHEASNCYS

===== Analyzing stability for peptide: 2_peptide_12mer =====

Relaxing structure for peptide: 2_peptide_12mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: 3.66

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = 3.56, improvement = 0.10
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 4.85, improvement = -1.19
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 2/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.10

Relaxation cycle 3/25
After repacking: energy = 4.91, improvement = -1.25
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 4/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 5/25
After repacking: energy = 4.91, improvement = -1.25
After minimization: energy = 3.56, improvement = 0.09
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 7/25
After repacking: energy = 4.91, improvement = -1.25
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 8/25
After repacking: energy = 4.91, improvement = -1.25
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 9/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 10/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 12/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 13/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 14/25
After repacking: energy = 4.90, improvement = -1.25
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 15/25
After repacking: energy = 4.88, improvement = -1.22
After minimization: energy = 3.56, improvement = 0.09
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 4.91, improvement = -1.25
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 17/25
After repacking: energy = 4.91, improvement = -1.25
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 18/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 19/25
After repacking: energy = 4.90, improvement = -1.25
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 20/25
After repacking: energy = 4.89, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 22/25
After repacking: energy = 4.90, improvement = -1.25
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 23/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 24/25
After repacking: energy = 4.90, improvement = -1.24
After minimization: energy = 3.56, improvement = 0.09

Relaxation cycle 25/25
After repacking: energy = 4.88, improvement = -1.22
After minimization: energy = 3.56, improvement = 0.09
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: 3.66
Final energy: 3.56
Total energy improvement: 0.10 (2.6%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.00 Å, All-atom RMSD = 0.01 Å
Secondary structure before: LLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLL
Saved relaxed structure to stability_results/2_peptide_12mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 2_peptide_12mer

=== Computing Peptide Stability Metrics ===
Overall energy score: 3.56
Wrote residue energies to stability_results/2_peptide_12mer_residue_energies.txt
Unstable residues (high energy outliers): [12]
Secondary structure: LLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.0/10 (Very Low)
Wrote comprehensive stability report to stability_results/2_peptide_12mer_stability_report.txt

Simulating flexibility for relaxed peptide: 2_peptide_12mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.52 Å
Maximum pairwise RMSD: 0.74 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 1_peptide_20mer: ASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLN

===== Analyzing stability for peptide: 1_peptide_20mer =====

Relaxing structure for peptide: 1_peptide_20mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: -0.43

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -1.77, improvement = 1.34
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 2.38, improvement = -2.80
After minimization: energy = -1.77, improvement = 1.34
Cycle 1 produced the best structure so far

Relaxation cycle 2/25
After repacking: energy = 2.46, improvement = -2.88
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 3/25
After repacking: energy = 2.47, improvement = -2.89
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 4/25
After repacking: energy = 2.46, improvement = -2.88
After minimization: energy = -1.77, improvement = 1.34
Cycle 4 produced the best structure so far

Relaxation cycle 5/25
After repacking: energy = 2.47, improvement = -2.90
After minimization: energy = -1.77, improvement = 1.34
Still seeing improvements (best was cycle 4)

Relaxation cycle 6/25
After repacking: energy = 2.48, improvement = -2.90
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 7/25
After repacking: energy = 2.45, improvement = -2.88
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 8/25
After repacking: energy = 2.46, improvement = -2.88
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 9/25
After repacking: energy = 2.47, improvement = -2.90
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 10/25
After repacking: energy = 2.46, improvement = -2.89
After minimization: energy = -1.77, improvement = 1.34
No improvement in last 5 cycles (best was cycle 4)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 2.46, improvement = -2.89
After minimization: energy = -1.77, improvement = 1.34
Cycle 11 produced the best structure so far

Relaxation cycle 12/25
After repacking: energy = 2.46, improvement = -2.89
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 13/25
After repacking: energy = 2.45, improvement = -2.87
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 14/25
After repacking: energy = 2.47, improvement = -2.90
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 15/25
After repacking: energy = 2.46, improvement = -2.88
After minimization: energy = -1.77, improvement = 1.34
Still seeing improvements (best was cycle 11)

Relaxation cycle 16/25
After repacking: energy = 2.47, improvement = -2.90
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 17/25
After repacking: energy = 2.46, improvement = -2.89
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 18/25
After repacking: energy = 2.43, improvement = -2.86
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 19/25
After repacking: energy = 2.46, improvement = -2.89
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 20/25
After repacking: energy = 2.46, improvement = -2.89
After minimization: energy = -1.77, improvement = 1.34
No improvement in last 5 cycles (best was cycle 11)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 2.47, improvement = -2.90
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 22/25
After repacking: energy = 2.47, improvement = -2.89
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 23/25
After repacking: energy = 2.46, improvement = -2.88
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 24/25
After repacking: energy = 2.46, improvement = -2.89
After minimization: energy = -1.77, improvement = 1.34

Relaxation cycle 25/25
After repacking: energy = 2.46, improvement = -2.89
After minimization: energy = -1.77, improvement = 1.34
No improvement in last 5 cycles (best was cycle 11)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: -0.43
Final energy: -1.77
Total energy improvement: 1.34 (314.3%)
Best structure was from cycle 11
Structure change: CA RMSD = 0.02 Å, All-atom RMSD = 0.45 Å
Secondary structure before: LLLLLLLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/1_peptide_20mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 1_peptide_20mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -1.77
Wrote residue energies to stability_results/1_peptide_20mer_residue_energies.txt
Unstable residues (high energy outliers): [5, 18]
Secondary structure: LLLLLLLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.2/10 (Very Low)
Wrote comprehensive stability report to stability_results/1_peptide_20mer_stability_report.txt

Simulating flexibility for relaxed peptide: 1_peptide_20mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.99 Å
Maximum pairwise RMSD: 1.34 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 4_peptide_20mer: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYS

===== Analyzing stability for peptide: 4_peptide_20mer =====

Relaxing structure for peptide: 4_peptide_20mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: 2.59

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = 2.47, improvement = 0.12
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 4.56, improvement = -1.97
After minimization: energy = 2.47, improvement = 0.12
Cycle 1 produced the best structure so far

Relaxation cycle 2/25
After repacking: energy = 4.44, improvement = -1.85
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 3/25
After repacking: energy = 4.39, improvement = -1.80
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 4/25
After repacking: energy = 4.38, improvement = -1.79
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 5/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12
Still seeing improvements (best was cycle 1)

Relaxation cycle 6/25
After repacking: energy = 4.36, improvement = -1.77
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 7/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 8/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 9/25
After repacking: energy = 4.36, improvement = -1.77
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 10/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12
No improvement in last 5 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 12/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 13/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 14/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 15/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12
No improvement in last 5 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 4.38, improvement = -1.79
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 17/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12
Cycle 17 produced the best structure so far

Relaxation cycle 18/25
After repacking: energy = 4.39, improvement = -1.80
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 19/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 20/25
After repacking: energy = 4.38, improvement = -1.79
After minimization: energy = 2.47, improvement = 0.12
Still seeing improvements (best was cycle 17)

Relaxation cycle 21/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 22/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 23/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 24/25
After repacking: energy = 4.39, improvement = -1.80
After minimization: energy = 2.47, improvement = 0.12

Relaxation cycle 25/25
After repacking: energy = 4.37, improvement = -1.78
After minimization: energy = 2.47, improvement = 0.12
No improvement in last 5 cycles (best was cycle 17)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: 2.59
Final energy: 2.47
Total energy improvement: 0.12 (4.8%)
Best structure was from cycle 17
Structure change: CA RMSD = 0.07 Å, All-atom RMSD = 0.10 Å
Secondary structure before: LLLLLLLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/4_peptide_20mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 4_peptide_20mer

=== Computing Peptide Stability Metrics ===
Overall energy score: 2.47
Wrote residue energies to stability_results/4_peptide_20mer_residue_energies.txt
Unstable residues (high energy outliers): [20, 9]
Secondary structure: LLLLLLLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.0/10 (Very Low)
Wrote comprehensive stability report to stability_results/4_peptide_20mer_stability_report.txt

Simulating flexibility for relaxed peptide: 4_peptide_20mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.66 Å
Maximum pairwise RMSD: 1.00 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 3_peptide_12mer: GLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLN

===== Analyzing stability for peptide: 3_peptide_12mer =====

Relaxing structure for peptide: 3_peptide_12mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: -1.74

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -1.80, improvement = 0.06
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = -0.10, improvement = -1.64
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 2/25
After repacking: energy = -0.10, improvement = -1.64
After minimization: energy = -1.73, improvement = -0.02

Relaxation cycle 3/25
After repacking: energy = -0.16, improvement = -1.58
After minimization: energy = -1.80, improvement = 0.06
Cycle 3 produced the best structure so far

Relaxation cycle 4/25
After repacking: energy = -0.11, improvement = -1.63
After minimization: energy = -1.80, improvement = 0.06
Cycle 4 produced the best structure so far

Relaxation cycle 5/25
After repacking: energy = -0.11, improvement = -1.63
After minimization: energy = -1.80, improvement = 0.06
Still seeing improvements (best was cycle 4)

Relaxation cycle 6/25
After repacking: energy = -0.11, improvement = -1.63
After minimization: energy = -1.80, improvement = 0.05

Relaxation cycle 7/25
After repacking: energy = -0.08, improvement = -1.66
After minimization: energy = -1.78, improvement = 0.04

Relaxation cycle 8/25
After repacking: energy = -0.05, improvement = -1.69
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 9/25
After repacking: energy = -0.11, improvement = -1.63
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 10/25
After repacking: energy = -0.10, improvement = -1.64
After minimization: energy = -1.80, improvement = 0.06
No improvement in last 5 cycles (best was cycle 4)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = -0.08, improvement = -1.67
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 12/25
After repacking: energy = -0.11, improvement = -1.63
After minimization: energy = -1.80, improvement = 0.05

Relaxation cycle 13/25
After repacking: energy = -0.07, improvement = -1.67
After minimization: energy = -1.73, improvement = -0.01

Relaxation cycle 14/25
After repacking: energy = -0.14, improvement = -1.60
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 15/25
After repacking: energy = -0.10, improvement = -1.64
After minimization: energy = -1.78, improvement = 0.04
No improvement in last 5 cycles (best was cycle 4)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = -0.06, improvement = -1.68
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 17/25
After repacking: energy = -0.09, improvement = -1.65
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 18/25
After repacking: energy = -0.10, improvement = -1.64
After minimization: energy = -1.80, improvement = 0.05

Relaxation cycle 19/25
After repacking: energy = -0.07, improvement = -1.67
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 20/25
After repacking: energy = -0.07, improvement = -1.67
After minimization: energy = -1.80, improvement = 0.06
No improvement in last 5 cycles (best was cycle 4)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = -0.11, improvement = -1.63
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 22/25
After repacking: energy = -0.10, improvement = -1.64
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 23/25
After repacking: energy = -0.10, improvement = -1.64
After minimization: energy = -1.80, improvement = 0.06

Relaxation cycle 24/25
After repacking: energy = -0.10, improvement = -1.64
After minimization: energy = -1.78, improvement = 0.04

Relaxation cycle 25/25
After repacking: energy = -0.05, improvement = -1.69
After minimization: energy = -1.80, improvement = 0.05
No improvement in last 5 cycles (best was cycle 4)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: -1.74
Final energy: -1.80
Total energy improvement: 0.06 (3.5%)
Best structure was from cycle 4
Structure change: CA RMSD = 0.02 Å, All-atom RMSD = 0.03 Å
Secondary structure before: LLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLL
Saved relaxed structure to stability_results/3_peptide_12mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 3_peptide_12mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -1.80
Wrote residue energies to stability_results/3_peptide_12mer_residue_energies.txt
Secondary structure: LLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.3/10 (Very Low)
Wrote comprehensive stability report to stability_results/3_peptide_12mer_stability_report.txt

Simulating flexibility for relaxed peptide: 3_peptide_12mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.71 Å
Maximum pairwise RMSD: 1.13 Å
Peptide flexibility: Low (Rigid)
Extracted sequence for 5_peptide_20mer: PHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHR

===== Analyzing stability for peptide: 5_peptide_20mer =====

Relaxing structure for peptide: 5_peptide_20mer

=== Relaxing Peptide Structure (25 cycles) ===
Initial total energy: 0.07

Attempting comprehensive FastRelax protocol...
FastRelax result: energy = -2.33, improvement = 2.40
FastRelax produced the best structure so far

Performing 25 cycles of manual optimization...

Relaxation cycle 1/25
After repacking: energy = 1.36, improvement = -1.29
After minimization: energy = -2.31, improvement = 2.38

Relaxation cycle 2/25
After repacking: energy = 1.27, improvement = -1.20
After minimization: energy = -2.31, improvement = 2.38

Relaxation cycle 3/25
After repacking: energy = 1.30, improvement = -1.22
After minimization: energy = -2.31, improvement = 2.38

Relaxation cycle 4/25
After repacking: energy = 1.33, improvement = -1.26
After minimization: energy = -2.31, improvement = 2.38

Relaxation cycle 5/25
After repacking: energy = 1.31, improvement = -1.24
After minimization: energy = -2.26, improvement = 2.34
Still seeing improvements (best was cycle 0)

Relaxation cycle 6/25
After repacking: energy = 1.43, improvement = -1.36
After minimization: energy = -1.37, improvement = 1.44

Relaxation cycle 7/25
After repacking: energy = 0.43, improvement = -0.35
After minimization: energy = -1.35, improvement = 1.42

Relaxation cycle 8/25
After repacking: energy = 0.42, improvement = -0.35
After minimization: energy = -1.33, improvement = 1.40

Relaxation cycle 9/25
After repacking: energy = 0.44, improvement = -0.37
After minimization: energy = -1.35, improvement = 1.42

Relaxation cycle 10/25
After repacking: energy = 0.42, improvement = -0.35
After minimization: energy = -1.35, improvement = 1.42
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 11/25
After repacking: energy = 0.43, improvement = -0.35
After minimization: energy = -1.35, improvement = 1.42

Relaxation cycle 12/25
After repacking: energy = 0.43, improvement = -0.36
After minimization: energy = -1.33, improvement = 1.40

Relaxation cycle 13/25
After repacking: energy = 0.44, improvement = -0.37
After minimization: energy = -1.32, improvement = 1.39

Relaxation cycle 14/25
After repacking: energy = 0.44, improvement = -0.37
After minimization: energy = -1.35, improvement = 1.42

Relaxation cycle 15/25
After repacking: energy = 0.43, improvement = -0.36
After minimization: energy = -1.33, improvement = 1.40
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 16/25
After repacking: energy = 0.44, improvement = -0.37
After minimization: energy = -1.35, improvement = 1.42

Relaxation cycle 17/25
After repacking: energy = 0.41, improvement = -0.34
After minimization: energy = -1.33, improvement = 1.40

Relaxation cycle 18/25
After repacking: energy = 0.44, improvement = -0.37
After minimization: energy = -1.35, improvement = 1.43

Relaxation cycle 19/25
After repacking: energy = 0.41, improvement = -0.34
After minimization: energy = -1.33, improvement = 1.40

Relaxation cycle 20/25
After repacking: energy = 0.44, improvement = -0.37
After minimization: energy = -1.32, improvement = 1.39
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

Relaxation cycle 21/25
After repacking: energy = 0.43, improvement = -0.35
After minimization: energy = -1.32, improvement = 1.39

Relaxation cycle 22/25
After repacking: energy = 0.43, improvement = -0.35
After minimization: energy = -1.35, improvement = 1.43

Relaxation cycle 23/25
After repacking: energy = 0.41, improvement = -0.34
After minimization: energy = -1.32, improvement = 1.39

Relaxation cycle 24/25
After repacking: energy = 0.43, improvement = -0.36
After minimization: energy = -1.32, improvement = 1.39

Relaxation cycle 25/25
After repacking: energy = 0.43, improvement = -0.35
After minimization: energy = -1.33, improvement = 1.40
No improvement in last 5 cycles (best was cycle 0)
Continuing relaxation in case we can escape local minimum...

=== Relaxation Summary ===
Initial energy: 0.07
Final energy: -2.33
Total energy improvement: 2.40 (3330.4%)
Best structure was from cycle 0
Structure change: CA RMSD = 0.05 Å, All-atom RMSD = 0.42 Å
Secondary structure before: LLLLLLLLLLLLLLLLLLLL
Secondary structure after:  LLLLLLLLLLLLLLLLLLLL
Saved relaxed structure to stability_results/5_peptide_20mer_relaxed.pdb

Computing stability metrics for relaxed peptide: 5_peptide_20mer

=== Computing Peptide Stability Metrics ===
Overall energy score: -2.33
Wrote residue energies to stability_results/5_peptide_20mer_residue_energies.txt
Unstable residues (high energy outliers): [1]
Secondary structure: LLLLLLLLLLLLLLLLLLLL
Helix: 0.0%, Sheet: 0.0%, Loop: 100.0%
Structure-based stability estimate: Low (0.0% structured)
Ramachandran analysis:
  Favorable: 0.0%
  Allowed: 0.0%
  Outlier: 100.0%
  Ramachandran-based stability estimate: Low
Temperature 0.8: CA_RMSD = 0.00 Å
Temperature 1.0: CA_RMSD = 0.00 Å
Temperature 1.5: CA_RMSD = 0.00 Å
Temperature 2.0: CA_RMSD = 0.00 Å
Temperature 3.0: CA_RMSD = 0.00 Å
Temperature-based stability estimate: High

Overall peptide stability score: 0.3/10 (Very Low)
Wrote comprehensive stability report to stability_results/5_peptide_20mer_stability_report.txt

Simulating flexibility for relaxed peptide: 5_peptide_20mer

=== Simulating Peptide Flexibility ===
Generated ensemble structure 1/5
Generated ensemble structure 2/5
Generated ensemble structure 3/5
Generated ensemble structure 4/5
Generated ensemble structure 5/5
Average pairwise RMSD: 0.93 Å
Maximum pairwise RMSD: 1.62 Å
Peptide flexibility: Low (Rigid)

===== Processing peptide: 5_peptide_25mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/5_peptide_25mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 5_peptide_25mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/5_peptide_25mer_Ab0...
Peptide sequence: PHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLYTYR
Antibody has 232 residues
Peptide has 25 residues
Saving antibody to docking_results/5_peptide_25mer_Ab0_antibody.pdb
Saving peptide to docking_results/5_peptide_25mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab0_CDR-H3_combined.pdb
Initial score: -402.30
  Found better pose: -402.30
  Found better pose: -402.30
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab0_CDR-H2_combined.pdb
Initial score: 241.67
  Found better pose: -317.44
  Found better pose: -364.87
  Found better pose: -399.42
  Found better pose: -403.01
  Found better pose: -403.58
  Found better pose: -403.78
  Found better pose: -404.00
  Found better pose: -404.87
  Found better pose: -405.52
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab0_CDR-H1_combined.pdb
Initial score: 23480.03
  Found better pose: 22432.38
  Found better pose: 20527.99
  Found better pose: 18703.95
  Found better pose: 17911.60
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab0_CDR-L3_combined.pdb
Initial score: 5207.53
  Found better pose: 3671.56
  Found better pose: 2619.31
  Found better pose: 1617.63
  Found better pose: 665.36
  Found better pose: 128.75
  Found better pose: -262.26
  Found better pose: -378.66
  Found better pose: -380.77
  Found better pose: -402.18
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -402.18
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -582.34, improvement = 180.16
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -337.43, improvement = -64.75
After minimization: energy = -509.36, improvement = 107.18

Complex relaxation cycle 2/25
After repacking: energy = -345.41, improvement = -56.76
After minimization: energy = -494.66, improvement = 92.48

Complex relaxation cycle 3/25
After repacking: energy = -419.99, improvement = 17.81
After minimization: energy = -510.98, improvement = 108.81

Complex relaxation cycle 4/25
After repacking: energy = -448.16, improvement = 45.99
After minimization: energy = -509.49, improvement = 107.32

Complex relaxation cycle 5/25
After repacking: energy = -449.20, improvement = 47.03
After minimization: energy = -509.33, improvement = 107.15

Complex relaxation cycle 6/25
After repacking: energy = -449.61, improvement = 47.43
After minimization: energy = -508.90, improvement = 106.73
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -408.63, improvement = 6.45
After minimization: energy = -469.45, improvement = 67.27

Complex relaxation cycle 8/25
After repacking: energy = -445.60, improvement = 43.42
After minimization: energy = -508.59, improvement = 106.41

Complex relaxation cycle 9/25
After repacking: energy = -446.14, improvement = 43.97
After minimization: energy = -510.13, improvement = 107.96
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -445.63, improvement = 43.46
After minimization: energy = -510.40, improvement = 108.23

Complex relaxation cycle 11/25
After repacking: energy = -443.60, improvement = 41.42
After minimization: energy = -510.93, improvement = 108.75

Complex relaxation cycle 12/25
After repacking: energy = -446.25, improvement = 44.07
After minimization: energy = -511.03, improvement = 108.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -444.86, improvement = 42.69
After minimization: energy = -510.34, improvement = 108.17

Complex relaxation cycle 14/25
After repacking: energy = -445.82, improvement = 43.65
After minimization: energy = -511.07, improvement = 108.89

Complex relaxation cycle 15/25
After repacking: energy = -445.30, improvement = 43.13
After minimization: energy = -511.02, improvement = 108.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -444.37, improvement = 42.19
After minimization: energy = -511.09, improvement = 108.91

Complex relaxation cycle 17/25
After repacking: energy = -444.63, improvement = 42.45
After minimization: energy = -511.05, improvement = 108.87

Complex relaxation cycle 18/25
After repacking: energy = -444.17, improvement = 41.99
After minimization: energy = -511.09, improvement = 108.91
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -443.47, improvement = 41.30
After minimization: energy = -510.07, improvement = 107.90

Complex relaxation cycle 20/25
After repacking: energy = -443.26, improvement = 41.09
After minimization: energy = -510.96, improvement = 108.78

Complex relaxation cycle 21/25
After repacking: energy = -445.51, improvement = 43.33
After minimization: energy = -511.04, improvement = 108.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -445.04, improvement = 42.87
After minimization: energy = -511.55, improvement = 109.38

Complex relaxation cycle 23/25
After repacking: energy = -442.23, improvement = 40.06
After minimization: energy = -510.04, improvement = 107.87

Complex relaxation cycle 24/25
After repacking: energy = -404.37, improvement = 2.20
After minimization: energy = -471.11, improvement = 68.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -444.11, improvement = 41.93
After minimization: energy = -511.60, improvement = 109.43

=== Complex Relaxation Summary ===
Initial energy: -402.18
Final energy: -582.34
Total energy improvement: 180.16 (44.8%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.31 Å
Interface energy: -51.18
Saved relaxed complex structure to docking_results/5_peptide_25mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -582.34
Checking contacts between peptide and CDR-L3...
Found 38 contacts with CDR-L3 (345.5% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -51.18

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab0_CDR-L1_combined.pdb
Initial score: -403.16
  Found better pose: -404.55
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -404.55
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -582.92, improvement = 178.38
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -341.82, improvement = -62.73
After minimization: energy = -513.95, improvement = 109.40

Complex relaxation cycle 2/25
After repacking: energy = -366.67, improvement = -37.88
After minimization: energy = -498.43, improvement = 93.88

Complex relaxation cycle 3/25
After repacking: energy = -438.00, improvement = 33.45
After minimization: energy = -500.03, improvement = 95.48

Complex relaxation cycle 4/25
After repacking: energy = -411.29, improvement = 6.74
After minimization: energy = -465.72, improvement = 61.17

Complex relaxation cycle 5/25
After repacking: energy = -419.67, improvement = 15.12
After minimization: energy = -505.92, improvement = 101.37

Complex relaxation cycle 6/25
After repacking: energy = -448.46, improvement = 43.91
After minimization: energy = -510.04, improvement = 105.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -431.46, improvement = 26.91
After minimization: energy = -508.26, improvement = 103.71

Complex relaxation cycle 8/25
After repacking: energy = -448.05, improvement = 43.50
After minimization: energy = -509.66, improvement = 105.11

Complex relaxation cycle 9/25
After repacking: energy = -447.88, improvement = 43.33
After minimization: energy = -510.34, improvement = 105.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -447.19, improvement = 42.64
After minimization: energy = -509.26, improvement = 104.72

Complex relaxation cycle 11/25
After repacking: energy = -446.42, improvement = 41.87
After minimization: energy = -509.88, improvement = 105.33

Complex relaxation cycle 12/25
After repacking: energy = -448.21, improvement = 43.67
After minimization: energy = -509.82, improvement = 105.27
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -449.15, improvement = 44.60
After minimization: energy = -509.73, improvement = 105.18

Complex relaxation cycle 14/25
After repacking: energy = -449.08, improvement = 44.53
After minimization: energy = -508.75, improvement = 104.20

Complex relaxation cycle 15/25
After repacking: energy = -450.43, improvement = 45.88
After minimization: energy = -509.76, improvement = 105.21
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -450.06, improvement = 45.51
After minimization: energy = -509.87, improvement = 105.32

Complex relaxation cycle 17/25
After repacking: energy = -449.66, improvement = 45.11
After minimization: energy = -509.03, improvement = 104.48

Complex relaxation cycle 18/25
After repacking: energy = -449.43, improvement = 44.88
After minimization: energy = -509.21, improvement = 104.66
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -448.39, improvement = 43.84
After minimization: energy = -504.36, improvement = 99.81

Complex relaxation cycle 20/25
After repacking: energy = -466.61, improvement = 62.07
After minimization: energy = -509.67, improvement = 105.12

Complex relaxation cycle 21/25
After repacking: energy = -451.25, improvement = 46.70
After minimization: energy = -509.81, improvement = 105.26
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -450.66, improvement = 46.11
After minimization: energy = -509.20, improvement = 104.65

Complex relaxation cycle 23/25
After repacking: energy = -450.75, improvement = 46.20
After minimization: energy = -509.93, improvement = 105.38

Complex relaxation cycle 24/25
After repacking: energy = -449.54, improvement = 44.99
After minimization: energy = -509.97, improvement = 105.42
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -450.13, improvement = 45.58
After minimization: energy = -509.93, improvement = 105.38

=== Complex Relaxation Summary ===
Initial energy: -404.55
Final energy: -582.92
Total energy improvement: 178.38 (44.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.25 Å
Interface energy: -56.78
Saved relaxed complex structure to docking_results/5_peptide_25mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -582.92
Checking contacts between peptide and CDR-L1...
Found 59 contacts with CDR-L1 (368.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -56.78

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab0_CDR-L2_combined.pdb
Initial score: 2417.88
  Found better pose: 1987.16
  Found better pose: 1441.05
  Found better pose: 1226.62
  Found better pose: 1116.80
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 1116.80
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 219.63, improvement = 897.18
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 964.51, improvement = 152.29
After minimization: energy = 315.87, improvement = 800.94

Complex relaxation cycle 2/25
After repacking: energy = 430.96, improvement = 685.84
After minimization: energy = 314.54, improvement = 802.27

Complex relaxation cycle 3/25
After repacking: energy = 470.91, improvement = 645.89
After minimization: energy = 298.30, improvement = 818.50

Complex relaxation cycle 4/25
After repacking: energy = 404.66, improvement = 712.15
After minimization: energy = 291.25, improvement = 825.55

Complex relaxation cycle 5/25
After repacking: energy = 402.96, improvement = 713.84
After minimization: energy = 287.66, improvement = 829.14

Complex relaxation cycle 6/25
After repacking: energy = 400.54, improvement = 716.27
After minimization: energy = 287.64, improvement = 829.16
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 402.33, improvement = 714.47
After minimization: energy = 290.27, improvement = 826.53

Complex relaxation cycle 8/25
After repacking: energy = 402.42, improvement = 714.38
After minimization: energy = 289.49, improvement = 827.31

Complex relaxation cycle 9/25
After repacking: energy = 442.41, improvement = 674.40
After minimization: energy = 327.68, improvement = 789.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 404.32, improvement = 712.49
After minimization: energy = 290.27, improvement = 826.53

Complex relaxation cycle 11/25
After repacking: energy = 402.84, improvement = 713.97
After minimization: energy = 289.36, improvement = 827.44

Complex relaxation cycle 12/25
After repacking: energy = 403.17, improvement = 713.63
After minimization: energy = 287.94, improvement = 828.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 403.45, improvement = 713.36
After minimization: energy = 290.15, improvement = 826.66

Complex relaxation cycle 14/25
After repacking: energy = 402.52, improvement = 714.29
After minimization: energy = 288.46, improvement = 828.35

Complex relaxation cycle 15/25
After repacking: energy = 441.48, improvement = 675.33
After minimization: energy = 327.48, improvement = 789.33
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 404.05, improvement = 712.75
After minimization: energy = 290.09, improvement = 826.71

Complex relaxation cycle 17/25
After repacking: energy = 403.14, improvement = 713.66
After minimization: energy = 289.37, improvement = 827.43

Complex relaxation cycle 18/25
After repacking: energy = 402.88, improvement = 713.92
After minimization: energy = 288.77, improvement = 828.03
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 404.15, improvement = 712.65
After minimization: energy = 290.25, improvement = 826.55

Complex relaxation cycle 20/25
After repacking: energy = 403.94, improvement = 712.87
After minimization: energy = 289.26, improvement = 827.54

Complex relaxation cycle 21/25
After repacking: energy = 402.47, improvement = 714.34
After minimization: energy = 287.42, improvement = 829.39
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 403.64, improvement = 713.17
After minimization: energy = 290.07, improvement = 826.73

Complex relaxation cycle 23/25
After repacking: energy = 403.21, improvement = 713.60
After minimization: energy = 290.00, improvement = 826.81

Complex relaxation cycle 24/25
After repacking: energy = 403.04, improvement = 713.76
After minimization: energy = 287.30, improvement = 829.50
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 401.05, improvement = 715.75
After minimization: energy = 288.34, improvement = 828.46

=== Complex Relaxation Summary ===
Initial energy: 1116.80
Final energy: 219.63
Total energy improvement: 897.18 (80.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.40 Å
Interface energy: 716.56
Saved relaxed complex structure to docking_results/5_peptide_25mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 219.63
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 716.56

Best binding found with CDR-L1, score: -582.92
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -404.5487328754207, 'relaxed_score': -582.9249110435475, 'interface_energy': -56.78350207701067, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 10, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/5_peptide_25mer_Ab0_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/5_peptide_25mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.008737169692975558), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

----- Processing antibody Ab1 with peptide 5_peptide_25mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/5_peptide_25mer_Ab1...
Peptide sequence: PHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLYTYR
Antibody has 240 residues
Peptide has 25 residues
Saving antibody to docking_results/5_peptide_25mer_Ab1_antibody.pdb
Saving peptide to docking_results/5_peptide_25mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab1_CDR-H3_combined.pdb
Initial score: 2479.18
  Found better pose: 810.80
  Found better pose: 655.31
  Found better pose: 164.85
  Found better pose: -202.42
  Found better pose: -224.87
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab1_CDR-H2_combined.pdb
Initial score: 2279.77
  Found better pose: 1248.27
  Found better pose: 577.73
  Found better pose: 177.86
  Found better pose: -122.10
  Found better pose: -187.81
  Found better pose: -225.12
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab1_CDR-H1_combined.pdb
Initial score: 30208.10
  Found better pose: 26873.77
  Found better pose: 25729.34
  Found better pose: 24645.23
  Found better pose: 23267.77
  Found better pose: 23098.94
  Found better pose: 23036.19
  Found better pose: 21975.90
  Found better pose: 20855.88
  Found better pose: 20426.90
  Found better pose: 19355.63
  Found better pose: 18530.78
  Found better pose: 16534.73
  Found better pose: 15511.92
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab1_CDR-L3_combined.pdb
Initial score: 5821.24
  Found better pose: 4142.24
  Found better pose: 3286.38
  Found better pose: 1049.60
  Found better pose: 984.83
  Found better pose: 590.53
  Found better pose: 182.31
  Found better pose: -166.87
  Found better pose: -215.68
  Found better pose: -217.08
  Found better pose: -226.58
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -226.58
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -384.57, improvement = 157.99
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 369.70, improvement = -596.28
After minimization: energy = -167.97, improvement = -58.61

Complex relaxation cycle 2/25
After repacking: energy = -201.70, improvement = -24.88
After minimization: energy = -267.64, improvement = 41.06

Complex relaxation cycle 3/25
After repacking: energy = -220.01, improvement = -6.57
After minimization: energy = -265.98, improvement = 39.40

Complex relaxation cycle 4/25
After repacking: energy = -219.63, improvement = -6.95
After minimization: energy = -271.61, improvement = 45.04

Complex relaxation cycle 5/25
After repacking: energy = -209.76, improvement = -16.82
After minimization: energy = -257.19, improvement = 30.61

Complex relaxation cycle 6/25
After repacking: energy = -208.59, improvement = -17.98
After minimization: energy = -248.63, improvement = 22.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -227.88, improvement = 1.31
After minimization: energy = -269.14, improvement = 42.56

Complex relaxation cycle 8/25
After repacking: energy = -208.94, improvement = -17.64
After minimization: energy = -257.14, improvement = 30.56

Complex relaxation cycle 9/25
After repacking: energy = -220.81, improvement = -5.77
After minimization: energy = -269.16, improvement = 42.58
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -220.96, improvement = -5.62
After minimization: energy = -269.15, improvement = 42.57

Complex relaxation cycle 11/25
After repacking: energy = -208.94, improvement = -17.64
After minimization: energy = -257.16, improvement = 30.58

Complex relaxation cycle 12/25
After repacking: energy = -221.17, improvement = -5.41
After minimization: energy = -269.17, improvement = 42.59
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -221.01, improvement = -5.57
After minimization: energy = -267.02, improvement = 40.44

Complex relaxation cycle 14/25
After repacking: energy = -211.22, improvement = -15.36
After minimization: energy = -255.20, improvement = 28.62

Complex relaxation cycle 15/25
After repacking: energy = -221.87, improvement = -4.71
After minimization: energy = -267.22, improvement = 40.64
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -210.86, improvement = -15.72
After minimization: energy = -255.21, improvement = 28.64

Complex relaxation cycle 17/25
After repacking: energy = -210.81, improvement = -15.77
After minimization: energy = -263.46, improvement = 36.88

Complex relaxation cycle 18/25
After repacking: energy = -220.10, improvement = -6.47
After minimization: energy = -276.19, improvement = 49.61
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -217.51, improvement = -9.06
After minimization: energy = -265.23, improvement = 38.66

Complex relaxation cycle 20/25
After repacking: energy = -214.32, improvement = -12.26
After minimization: energy = -265.90, improvement = 39.32

Complex relaxation cycle 21/25
After repacking: energy = -198.91, improvement = -27.66
After minimization: energy = -251.34, improvement = 24.76
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -214.35, improvement = -12.23
After minimization: energy = -265.22, improvement = 38.65

Complex relaxation cycle 23/25
After repacking: energy = -225.08, improvement = -1.50
After minimization: energy = -277.52, improvement = 50.95

Complex relaxation cycle 24/25
After repacking: energy = -226.18, improvement = -0.40
After minimization: energy = -277.32, improvement = 50.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -214.33, improvement = -12.25
After minimization: energy = -266.10, improvement = 39.52

=== Complex Relaxation Summary ===
Initial energy: -226.58
Final energy: -384.57
Total energy improvement: 157.99 (69.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.43 Å
Interface energy: -53.78
Saved relaxed complex structure to docking_results/5_peptide_25mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -384.57
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -53.78

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab1_CDR-L1_combined.pdb
Initial score: -224.51
  Found better pose: -224.52
  Found better pose: -224.57
  Found better pose: -224.62
  Found better pose: -224.80
  Found better pose: -224.84
  Found better pose: -224.94
  Found better pose: -225.66
  Found better pose: -226.60
  Found better pose: -226.86
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -226.86
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -388.72, improvement = 161.86
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 352.50, improvement = -579.36
After minimization: energy = -179.11, improvement = -47.75

Complex relaxation cycle 2/25
After repacking: energy = -182.35, improvement = -44.51
After minimization: energy = -246.31, improvement = 19.45

Complex relaxation cycle 3/25
After repacking: energy = -206.50, improvement = -20.36
After minimization: energy = -252.22, improvement = 25.36

Complex relaxation cycle 4/25
After repacking: energy = -195.57, improvement = -31.29
After minimization: energy = -237.83, improvement = 10.97

Complex relaxation cycle 5/25
After repacking: energy = -209.79, improvement = -17.07
After minimization: energy = -252.53, improvement = 25.67

Complex relaxation cycle 6/25
After repacking: energy = -203.13, improvement = -23.73
After minimization: energy = -250.32, improvement = 23.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -219.80, improvement = -7.06
After minimization: energy = -262.44, improvement = 35.58

Complex relaxation cycle 8/25
After repacking: energy = -206.60, improvement = -20.26
After minimization: energy = -251.63, improvement = 24.77

Complex relaxation cycle 9/25
After repacking: energy = -214.09, improvement = -12.77
After minimization: energy = -257.60, improvement = 30.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -207.98, improvement = -18.88
After minimization: energy = -251.55, improvement = 24.69

Complex relaxation cycle 11/25
After repacking: energy = -180.24, improvement = -46.62
After minimization: energy = -224.25, improvement = -2.61

Complex relaxation cycle 12/25
After repacking: energy = -220.11, improvement = -6.75
After minimization: energy = -263.69, improvement = 36.83
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -207.91, improvement = -18.95
After minimization: energy = -251.60, improvement = 24.74

Complex relaxation cycle 14/25
After repacking: energy = -219.52, improvement = -7.33
After minimization: energy = -260.67, improvement = 33.82

Complex relaxation cycle 15/25
After repacking: energy = -209.79, improvement = -17.07
After minimization: energy = -249.51, improvement = 22.65
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -224.01, improvement = -2.85
After minimization: energy = -264.42, improvement = 37.56

Complex relaxation cycle 17/25
After repacking: energy = -221.69, improvement = -5.17
After minimization: energy = -264.45, improvement = 37.59

Complex relaxation cycle 18/25
After repacking: energy = -209.41, improvement = -17.45
After minimization: energy = -252.40, improvement = 25.54
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -221.73, improvement = -5.13
After minimization: energy = -264.39, improvement = 37.53

Complex relaxation cycle 20/25
After repacking: energy = -221.24, improvement = -5.62
After minimization: energy = -264.46, improvement = 37.60

Complex relaxation cycle 21/25
After repacking: energy = -203.27, improvement = -23.59
After minimization: energy = -247.68, improvement = 20.82
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -208.59, improvement = -18.27
After minimization: energy = -248.70, improvement = 21.84

Complex relaxation cycle 23/25
After repacking: energy = -221.35, improvement = -5.51
After minimization: energy = -263.63, improvement = 36.78

Complex relaxation cycle 24/25
After repacking: energy = -181.39, improvement = -45.47
After minimization: energy = -224.99, improvement = -1.87
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -214.21, improvement = -12.65
After minimization: energy = -248.85, improvement = 21.99

=== Complex Relaxation Summary ===
Initial energy: -226.86
Final energy: -388.72
Total energy improvement: 161.86 (71.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.45 Å
Interface energy: -51.91
Saved relaxed complex structure to docking_results/5_peptide_25mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -388.72
Checking contacts between peptide and CDR-L1...
Found 62 contacts with CDR-L1 (387.5% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -51.91

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-45.77, 54.82, 31.22)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/5_peptide_25mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/5_peptide_25mer_Ab1_CDR-L2_combined.pdb
Initial score: 4641.55
  Found better pose: 1733.05
  Found better pose: 895.94
  Found better pose: -71.89
  Found better pose: -186.03
  Found better pose: -218.22
  Found better pose: -221.27
  Found better pose: -223.55
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -223.55
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -374.13, improvement = 150.59
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 377.35, improvement = -600.90
After minimization: energy = -160.08, improvement = -63.47

Complex relaxation cycle 2/25
After repacking: energy = -196.73, improvement = -26.82
After minimization: energy = -257.17, improvement = 33.62

Complex relaxation cycle 3/25
After repacking: energy = -205.02, improvement = -18.53
After minimization: energy = -251.66, improvement = 28.11

Complex relaxation cycle 4/25
After repacking: energy = -204.81, improvement = -18.74
After minimization: energy = -251.52, improvement = 27.98

Complex relaxation cycle 5/25
After repacking: energy = -179.57, improvement = -43.97
After minimization: energy = -226.57, improvement = 3.02

Complex relaxation cycle 6/25
After repacking: energy = -216.34, improvement = -7.21
After minimization: energy = -265.57, improvement = 42.03
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -203.51, improvement = -20.04
After minimization: energy = -260.87, improvement = 37.32

Complex relaxation cycle 8/25
After repacking: energy = -211.38, improvement = -12.16
After minimization: energy = -271.87, improvement = 48.32

Complex relaxation cycle 9/25
After repacking: energy = -222.88, improvement = -0.66
After minimization: energy = -271.14, improvement = 47.59
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -197.18, improvement = -26.37
After minimization: energy = -245.37, improvement = 21.82

Complex relaxation cycle 11/25
After repacking: energy = -196.65, improvement = -26.90
After minimization: energy = -245.20, improvement = 21.65

Complex relaxation cycle 12/25
After repacking: energy = -196.45, improvement = -27.10
After minimization: energy = -245.46, improvement = 21.91
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -211.25, improvement = -12.30
After minimization: energy = -260.15, improvement = 36.60

Complex relaxation cycle 14/25
After repacking: energy = -223.43, improvement = -0.12
After minimization: energy = -272.14, improvement = 48.59

Complex relaxation cycle 15/25
After repacking: energy = -223.26, improvement = -0.29
After minimization: energy = -272.16, improvement = 48.61
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -210.83, improvement = -12.72
After minimization: energy = -259.93, improvement = 36.38

Complex relaxation cycle 17/25
After repacking: energy = -222.47, improvement = -1.08
After minimization: energy = -271.45, improvement = 47.90

Complex relaxation cycle 18/25
After repacking: energy = -223.41, improvement = -0.14
After minimization: energy = -272.15, improvement = 48.60
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -223.26, improvement = -0.28
After minimization: energy = -272.13, improvement = 48.59

Complex relaxation cycle 20/25
After repacking: energy = -217.41, improvement = -6.14
After minimization: energy = -266.15, improvement = 42.60

Complex relaxation cycle 21/25
After repacking: energy = -223.27, improvement = -0.27
After minimization: energy = -272.01, improvement = 48.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -223.12, improvement = -0.43
After minimization: energy = -272.14, improvement = 48.59

Complex relaxation cycle 23/25
After repacking: energy = -210.84, improvement = -12.70
After minimization: energy = -259.93, improvement = 36.38

Complex relaxation cycle 24/25
After repacking: energy = -223.34, improvement = -0.21
After minimization: energy = -272.13, improvement = 48.59
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -195.87, improvement = -27.67
After minimization: energy = -245.24, improvement = 21.69

=== Complex Relaxation Summary ===
Initial energy: -223.55
Final energy: -374.13
Total energy improvement: 150.59 (67.4%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.52 Å
Interface energy: -51.42
Saved relaxed complex structure to docking_results/5_peptide_25mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -374.13
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -51.42

Best binding found with CDR-L1, score: -388.72
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -226.85843717058665, 'relaxed_score': -388.72098084286534, 'interface_energy': -51.91169547929957, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/5_peptide_25mer_Ab1_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/5_peptide_25mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.008737169692975558), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

===== Processing peptide: 2_peptide_15mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/2_peptide_15mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 2_peptide_15mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/2_peptide_15mer_Ab0...
Peptide sequence: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLYSER
Antibody has 232 residues
Peptide has 15 residues
Saving antibody to docking_results/2_peptide_15mer_Ab0_antibody.pdb
Saving peptide to docking_results/2_peptide_15mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab0_CDR-H3_combined.pdb
Initial score: -224.56
  Found better pose: -388.54
  Found better pose: -402.03
  Found better pose: -404.03
  Found better pose: -404.25
  Found better pose: -404.42
  Found better pose: -404.53
  Found better pose: -404.55
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab0_CDR-H2_combined.pdb
Initial score: 10075.30
  Found better pose: 9362.48
  Found better pose: 8598.37
  Found better pose: 8507.89
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab0_CDR-H1_combined.pdb
Initial score: 34844.52
  Found better pose: 33061.50
  Found better pose: 32254.72
  Found better pose: 29447.47
  Found better pose: 28310.14
  Found better pose: 26226.45
  Found better pose: 25819.15
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab0_CDR-L3_combined.pdb
Initial score: -319.03
  Found better pose: -405.99
  Found better pose: -408.73
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -408.73
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -589.96, improvement = 181.24
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -349.08, improvement = -59.65
After minimization: energy = -517.66, improvement = 108.93

Complex relaxation cycle 2/25
After repacking: energy = -364.71, improvement = -44.01
After minimization: energy = -498.37, improvement = 89.64

Complex relaxation cycle 3/25
After repacking: energy = -442.47, improvement = 33.75
After minimization: energy = -504.48, improvement = 95.75

Complex relaxation cycle 4/25
After repacking: energy = -448.08, improvement = 39.35
After minimization: energy = -510.16, improvement = 101.43

Complex relaxation cycle 5/25
After repacking: energy = -448.18, improvement = 39.45
After minimization: energy = -510.18, improvement = 101.45

Complex relaxation cycle 6/25
After repacking: energy = -447.55, improvement = 38.82
After minimization: energy = -510.31, improvement = 101.59
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -447.79, improvement = 39.06
After minimization: energy = -509.50, improvement = 100.78

Complex relaxation cycle 8/25
After repacking: energy = -451.86, improvement = 43.14
After minimization: energy = -509.92, improvement = 101.20

Complex relaxation cycle 9/25
After repacking: energy = -447.00, improvement = 38.27
After minimization: energy = -509.80, improvement = 101.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -447.30, improvement = 38.57
After minimization: energy = -509.75, improvement = 101.02

Complex relaxation cycle 11/25
After repacking: energy = -447.73, improvement = 39.01
After minimization: energy = -509.79, improvement = 101.06

Complex relaxation cycle 12/25
After repacking: energy = -447.41, improvement = 38.68
After minimization: energy = -509.90, improvement = 101.18
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -447.57, improvement = 38.85
After minimization: energy = -509.86, improvement = 101.13

Complex relaxation cycle 14/25
After repacking: energy = -448.02, improvement = 39.30
After minimization: energy = -509.93, improvement = 101.20

Complex relaxation cycle 15/25
After repacking: energy = -407.44, improvement = -1.29
After minimization: energy = -470.24, improvement = 61.52
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -446.58, improvement = 37.86
After minimization: energy = -509.56, improvement = 100.83

Complex relaxation cycle 17/25
After repacking: energy = -447.08, improvement = 38.36
After minimization: energy = -510.01, improvement = 101.29

Complex relaxation cycle 18/25
After repacking: energy = -445.65, improvement = 36.93
After minimization: energy = -509.81, improvement = 101.09
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -446.18, improvement = 37.45
After minimization: energy = -509.87, improvement = 101.15

Complex relaxation cycle 20/25
After repacking: energy = -447.60, improvement = 38.87
After minimization: energy = -509.89, improvement = 101.16

Complex relaxation cycle 21/25
After repacking: energy = -447.45, improvement = 38.72
After minimization: energy = -509.84, improvement = 101.12
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -445.91, improvement = 37.18
After minimization: energy = -510.04, improvement = 101.31

Complex relaxation cycle 23/25
After repacking: energy = -405.72, improvement = -3.01
After minimization: energy = -470.23, improvement = 61.50

Complex relaxation cycle 24/25
After repacking: energy = -405.91, improvement = -2.82
After minimization: energy = -470.08, improvement = 61.35
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -444.27, improvement = 35.55
After minimization: energy = -509.97, improvement = 101.24

=== Complex Relaxation Summary ===
Initial energy: -408.73
Final energy: -589.96
Total energy improvement: 181.24 (44.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.26 Å
Interface energy: -59.83
Saved relaxed complex structure to docking_results/2_peptide_15mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -589.96
Checking contacts between peptide and CDR-L3...
Found 41 contacts with CDR-L3 (372.7% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -59.83

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab0_CDR-L1_combined.pdb
Initial score: 12536.92
  Found better pose: 12177.45
  Found better pose: 11511.85
  Found better pose: 9386.82
  Found better pose: 8832.56
  Found better pose: 7535.52
  Found better pose: 6689.69
  Found better pose: 5799.73
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 5799.73
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -427.55, improvement = 6227.28
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 4707.42, improvement = 1092.31
After minimization: energy = 1358.23, improvement = 4441.50

Complex relaxation cycle 2/25
After repacking: energy = 229.21, improvement = 5570.52
After minimization: energy = -380.30, improvement = 6180.03

Complex relaxation cycle 3/25
After repacking: energy = -139.25, improvement = 5938.98
After minimization: energy = -380.73, improvement = 6180.45

Complex relaxation cycle 4/25
After repacking: energy = -259.04, improvement = 6058.77
After minimization: energy = -384.02, improvement = 6183.75

Complex relaxation cycle 5/25
After repacking: energy = -228.46, improvement = 6028.18
After minimization: energy = -344.39, improvement = 6144.12

Complex relaxation cycle 6/25
After repacking: energy = -272.87, improvement = 6072.60
After minimization: energy = -384.02, improvement = 6183.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -274.13, improvement = 6073.86
After minimization: energy = -385.66, improvement = 6185.39

Complex relaxation cycle 8/25
After repacking: energy = -239.31, improvement = 6039.04
After minimization: energy = -384.29, improvement = 6184.02

Complex relaxation cycle 9/25
After repacking: energy = -267.80, improvement = 6067.53
After minimization: energy = -385.42, improvement = 6185.15
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -232.85, improvement = 6032.58
After minimization: energy = -386.75, improvement = 6186.48

Complex relaxation cycle 11/25
After repacking: energy = -258.69, improvement = 6058.42
After minimization: energy = -388.00, improvement = 6187.73

Complex relaxation cycle 12/25
After repacking: energy = -254.71, improvement = 6054.44
After minimization: energy = -385.30, improvement = 6185.03
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -233.70, improvement = 6033.42
After minimization: energy = -385.31, improvement = 6185.04

Complex relaxation cycle 14/25
After repacking: energy = -232.84, improvement = 6032.57
After minimization: energy = -385.37, improvement = 6185.10

Complex relaxation cycle 15/25
After repacking: energy = -232.53, improvement = 6032.26
After minimization: energy = -385.35, improvement = 6185.08
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -233.80, improvement = 6033.53
After minimization: energy = -389.43, improvement = 6189.16

Complex relaxation cycle 17/25
After repacking: energy = -239.49, improvement = 6039.22
After minimization: energy = -388.65, improvement = 6188.38

Complex relaxation cycle 18/25
After repacking: energy = -236.03, improvement = 6035.76
After minimization: energy = -388.78, improvement = 6188.51
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -238.52, improvement = 6038.25
After minimization: energy = -388.74, improvement = 6188.47

Complex relaxation cycle 20/25
After repacking: energy = -240.06, improvement = 6039.79
After minimization: energy = -388.22, improvement = 6187.95

Complex relaxation cycle 21/25
After repacking: energy = -238.86, improvement = 6038.59
After minimization: energy = -393.40, improvement = 6193.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -251.46, improvement = 6051.19
After minimization: energy = -395.45, improvement = 6195.18

Complex relaxation cycle 23/25
After repacking: energy = -270.92, improvement = 6070.65
After minimization: energy = -391.74, improvement = 6191.47

Complex relaxation cycle 24/25
After repacking: energy = -271.19, improvement = 6070.92
After minimization: energy = -393.29, improvement = 6193.02
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -278.78, improvement = 6078.50
After minimization: energy = -395.63, improvement = 6195.36

=== Complex Relaxation Summary ===
Initial energy: 5799.73
Final energy: -427.55
Total energy improvement: 6227.28 (107.4%)
Best structure was from cycle 1
Structure change: CA RMSD = 1.35 Å
Interface energy: -38.23
Saved relaxed complex structure to docking_results/2_peptide_15mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -427.55
Checking contacts between peptide and CDR-L1...
Found 55 contacts with CDR-L1 (343.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -38.23

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab0_CDR-L2_combined.pdb
Initial score: 647.05
  Found better pose: -7.50
  Found better pose: -355.77
  Found better pose: -373.39
  Found better pose: -389.37
  Found better pose: -402.29
  Found better pose: -402.64
  Found better pose: -403.39
  Found better pose: -403.67
  Found better pose: -403.86
  Found better pose: -403.90
  Found better pose: -403.96
  Found better pose: -403.97
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -403.97
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -581.18, improvement = 177.21
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -342.56, improvement = -61.41
After minimization: energy = -513.91, improvement = 109.94

Complex relaxation cycle 2/25
After repacking: energy = -342.78, improvement = -61.19
After minimization: energy = -499.42, improvement = 95.45

Complex relaxation cycle 3/25
After repacking: energy = -431.69, improvement = 27.72
After minimization: energy = -513.38, improvement = 109.40

Complex relaxation cycle 4/25
After repacking: energy = -459.77, improvement = 55.80
After minimization: energy = -512.89, improvement = 108.92

Complex relaxation cycle 5/25
After repacking: energy = -462.25, improvement = 58.28
After minimization: energy = -512.52, improvement = 108.55

Complex relaxation cycle 6/25
After repacking: energy = -461.80, improvement = 57.83
After minimization: energy = -512.42, improvement = 108.45
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -421.59, improvement = 17.62
After minimization: energy = -472.80, improvement = 68.83

Complex relaxation cycle 8/25
After repacking: energy = -421.03, improvement = 17.06
After minimization: energy = -472.59, improvement = 68.62

Complex relaxation cycle 9/25
After repacking: energy = -459.40, improvement = 55.43
After minimization: energy = -511.79, improvement = 107.82
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -458.97, improvement = 55.00
After minimization: energy = -511.96, improvement = 107.99

Complex relaxation cycle 11/25
After repacking: energy = -458.82, improvement = 54.85
After minimization: energy = -511.90, improvement = 107.93

Complex relaxation cycle 12/25
After repacking: energy = -458.83, improvement = 54.86
After minimization: energy = -511.69, improvement = 107.72
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -459.50, improvement = 55.53
After minimization: energy = -511.82, improvement = 107.85

Complex relaxation cycle 14/25
After repacking: energy = -458.85, improvement = 54.87
After minimization: energy = -511.84, improvement = 107.87

Complex relaxation cycle 15/25
After repacking: energy = -458.50, improvement = 54.52
After minimization: energy = -511.81, improvement = 107.84
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -458.93, improvement = 54.96
After minimization: energy = -511.92, improvement = 107.95

Complex relaxation cycle 17/25
After repacking: energy = -459.06, improvement = 55.09
After minimization: energy = -511.83, improvement = 107.85

Complex relaxation cycle 18/25
After repacking: energy = -459.50, improvement = 55.53
After minimization: energy = -511.83, improvement = 107.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -458.75, improvement = 54.78
After minimization: energy = -511.95, improvement = 107.98

Complex relaxation cycle 20/25
After repacking: energy = -458.66, improvement = 54.69
After minimization: energy = -511.75, improvement = 107.77

Complex relaxation cycle 21/25
After repacking: energy = -459.55, improvement = 55.58
After minimization: energy = -511.93, improvement = 107.96
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -459.23, improvement = 55.26
After minimization: energy = -511.96, improvement = 107.99

Complex relaxation cycle 23/25
After repacking: energy = -458.93, improvement = 54.95
After minimization: energy = -511.83, improvement = 107.86

Complex relaxation cycle 24/25
After repacking: energy = -458.90, improvement = 54.93
After minimization: energy = -511.86, improvement = 107.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -418.93, improvement = 14.96
After minimization: energy = -472.18, improvement = 68.21

=== Complex Relaxation Summary ===
Initial energy: -403.97
Final energy: -581.18
Total energy improvement: 177.21 (43.9%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.25 Å
Interface energy: -52.39
Saved relaxed complex structure to docking_results/2_peptide_15mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -581.18
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -52.39

Best binding found with CDR-L3, score: -589.96
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -408.72631550912246, 'relaxed_score': -589.964155451514, 'interface_energy': -59.82530233175771, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 7, 'salt_bridges': 0, 'hydrophobic': 8, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/2_peptide_15mer_Ab0_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/2_peptide_15mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.2768052300881312), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 2_peptide_15mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/2_peptide_15mer_Ab1...
Peptide sequence: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLYSER
Antibody has 240 residues
Peptide has 15 residues
Saving antibody to docking_results/2_peptide_15mer_Ab1_antibody.pdb
Saving peptide to docking_results/2_peptide_15mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab1_CDR-H3_combined.pdb
Initial score: 10644.39
  Found better pose: 10176.67
  Found better pose: 9114.70
  Found better pose: 6447.89
  Found better pose: 5844.43
  Found better pose: 4865.75
  Found better pose: 4538.09
  Found better pose: 3206.83
  Found better pose: 3187.48
  Found better pose: 2380.63
  Found better pose: 1135.03
  Found better pose: 670.54
  Found better pose: 340.10
  Found better pose: -66.98
  Found better pose: -153.93
  Found better pose: -216.75
  Found better pose: -217.05
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab1_CDR-H2_combined.pdb
Initial score: 14990.00
  Found better pose: 13315.50
  Found better pose: 12320.17
  Found better pose: 11910.23
  Found better pose: 11592.73
  Found better pose: 9444.54
  Found better pose: 8556.59
  Found better pose: 6974.75
  Found better pose: 5707.82
  Found better pose: 5006.55
  Found better pose: 3993.36
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab1_CDR-H1_combined.pdb
Initial score: 39200.99
  Found better pose: 38958.20
  Found better pose: 36580.27
  Found better pose: 32823.63
  Found better pose: 31775.26
  Found better pose: 31073.51
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab1_CDR-L3_combined.pdb
Initial score: -210.77
  Found better pose: -227.08
  Found better pose: -227.16
  Found better pose: -227.42
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -227.42
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -384.86, improvement = 157.44
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 330.37, improvement = -557.79
After minimization: energy = -175.14, improvement = -52.28

Complex relaxation cycle 2/25
After repacking: energy = -155.79, improvement = -71.63
After minimization: energy = -254.14, improvement = 26.71

Complex relaxation cycle 3/25
After repacking: energy = -197.52, improvement = -29.90
After minimization: energy = -257.39, improvement = 29.97

Complex relaxation cycle 4/25
After repacking: energy = -178.06, improvement = -49.36
After minimization: energy = -257.78, improvement = 30.35

Complex relaxation cycle 5/25
After repacking: energy = -202.35, improvement = -25.08
After minimization: energy = -254.97, improvement = 27.55

Complex relaxation cycle 6/25
After repacking: energy = -215.57, improvement = -11.85
After minimization: energy = -266.90, improvement = 39.48
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -204.38, improvement = -23.04
After minimization: energy = -257.71, improvement = 30.28

Complex relaxation cycle 8/25
After repacking: energy = -215.26, improvement = -12.16
After minimization: energy = -269.27, improvement = 41.85

Complex relaxation cycle 9/25
After repacking: energy = -204.44, improvement = -22.98
After minimization: energy = -257.78, improvement = 30.36
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -203.51, improvement = -23.92
After minimization: energy = -257.82, improvement = 30.40

Complex relaxation cycle 11/25
After repacking: energy = -203.03, improvement = -24.39
After minimization: energy = -257.25, improvement = 29.83

Complex relaxation cycle 12/25
After repacking: energy = -204.09, improvement = -23.34
After minimization: energy = -248.35, improvement = 20.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -216.60, improvement = -10.82
After minimization: energy = -256.72, improvement = 29.30

Complex relaxation cycle 14/25
After repacking: energy = -204.61, improvement = -22.81
After minimization: energy = -257.30, improvement = 29.88

Complex relaxation cycle 15/25
After repacking: energy = -189.70, improvement = -37.72
After minimization: energy = -240.10, improvement = 12.67
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -203.88, improvement = -23.54
After minimization: energy = -257.77, improvement = 30.35

Complex relaxation cycle 17/25
After repacking: energy = -203.24, improvement = -24.18
After minimization: energy = -257.80, improvement = 30.38

Complex relaxation cycle 18/25
After repacking: energy = -203.90, improvement = -23.52
After minimization: energy = -257.83, improvement = 30.41
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -203.77, improvement = -23.65
After minimization: energy = -257.81, improvement = 30.39

Complex relaxation cycle 20/25
After repacking: energy = -208.65, improvement = -18.77
After minimization: energy = -270.47, improvement = 43.05

Complex relaxation cycle 21/25
After repacking: energy = -202.57, improvement = -24.86
After minimization: energy = -261.27, improvement = 33.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -223.57, improvement = -3.85
After minimization: energy = -278.51, improvement = 51.09

Complex relaxation cycle 23/25
After repacking: energy = -213.26, improvement = -14.16
After minimization: energy = -266.50, improvement = 39.08

Complex relaxation cycle 24/25
After repacking: energy = -218.65, improvement = -8.77
After minimization: energy = -269.94, improvement = 42.52
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -207.84, improvement = -19.58
After minimization: energy = -262.76, improvement = 35.34

=== Complex Relaxation Summary ===
Initial energy: -227.42
Final energy: -384.86
Total energy improvement: 157.44 (69.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.50 Å
Interface energy: -57.15
Saved relaxed complex structure to docking_results/2_peptide_15mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -384.86
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -57.15

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab1_CDR-L1_combined.pdb
Initial score: 11265.80
  Found better pose: 10381.72
  Found better pose: 9907.11
  Found better pose: 9408.05
  Found better pose: 7995.06
  Found better pose: 7540.42
  Found better pose: 6363.03
  Found better pose: 5979.19
  Found better pose: 5770.14
  Found better pose: 4615.41
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 4615.41
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -310.61, improvement = 4926.02
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 3885.36, improvement = 730.05
After minimization: energy = 7005.06, improvement = -2389.66

Complex relaxation cycle 2/25
After repacking: energy = 7169.47, improvement = -2554.07
After minimization: energy = 79.65, improvement = 4535.76

Complex relaxation cycle 3/25
After repacking: energy = -73.85, improvement = 4689.26
After minimization: energy = -148.77, improvement = 4764.17

Complex relaxation cycle 4/25
After repacking: energy = -120.41, improvement = 4735.82
After minimization: energy = -164.62, improvement = 4780.02

Complex relaxation cycle 5/25
After repacking: energy = -123.47, improvement = 4738.88
After minimization: energy = -163.94, improvement = 4779.35

Complex relaxation cycle 6/25
After repacking: energy = 1492.77, improvement = 3122.64
After minimization: energy = -79.03, improvement = 4694.44
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -47.71, improvement = 4663.12
After minimization: energy = -91.26, improvement = 4706.67

Complex relaxation cycle 8/25
After repacking: energy = -75.85, improvement = 4691.26
After minimization: energy = -113.99, improvement = 4729.39

Complex relaxation cycle 9/25
After repacking: energy = -92.78, improvement = 4708.19
After minimization: energy = -127.33, improvement = 4742.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -86.03, improvement = 4701.44
After minimization: energy = -117.36, improvement = 4732.77

Complex relaxation cycle 11/25
After repacking: energy = -85.75, improvement = 4701.16
After minimization: energy = -118.71, improvement = 4734.12

Complex relaxation cycle 12/25
After repacking: energy = -91.21, improvement = 4706.62
After minimization: energy = -117.47, improvement = 4732.88
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -78.79, improvement = 4694.20
After minimization: energy = -102.89, improvement = 4718.30

Complex relaxation cycle 14/25
After repacking: energy = -93.64, improvement = 4709.05
After minimization: energy = -120.16, improvement = 4735.57

Complex relaxation cycle 15/25
After repacking: energy = -93.74, improvement = 4709.15
After minimization: energy = -120.10, improvement = 4735.51
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -93.77, improvement = 4709.18
After minimization: energy = -117.90, improvement = 4733.31

Complex relaxation cycle 17/25
After repacking: energy = -80.57, improvement = 4695.97
After minimization: energy = -105.43, improvement = 4720.84

Complex relaxation cycle 18/25
After repacking: energy = -93.63, improvement = 4709.03
After minimization: energy = -119.08, improvement = 4734.48
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -79.19, improvement = 4694.60
After minimization: energy = -103.10, improvement = 4718.50

Complex relaxation cycle 20/25
After repacking: energy = -107.08, improvement = 4722.49
After minimization: energy = -132.10, improvement = 4747.50

Complex relaxation cycle 21/25
After repacking: energy = -93.81, improvement = 4709.22
After minimization: energy = -120.19, improvement = 4735.60
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -102.85, improvement = 4718.26
After minimization: energy = -130.04, improvement = 4745.45

Complex relaxation cycle 23/25
After repacking: energy = -106.71, improvement = 4722.12
After minimization: energy = -132.48, improvement = 4747.89

Complex relaxation cycle 24/25
After repacking: energy = -93.86, improvement = 4709.26
After minimization: energy = -123.67, improvement = 4739.08
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -87.92, improvement = 4703.32
After minimization: energy = -126.97, improvement = 4742.38

=== Complex Relaxation Summary ===
Initial energy: 4615.41
Final energy: -310.61
Total energy improvement: 4926.02 (106.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.88 Å
Interface energy: -43.38
Saved relaxed complex structure to docking_results/2_peptide_15mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -310.61
Checking contacts between peptide and CDR-L1...
Found 60 contacts with CDR-L1 (375.0% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -43.38

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-30.08, 50.87, 9.03)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/2_peptide_15mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/2_peptide_15mer_Ab1_CDR-L2_combined.pdb
Initial score: 12819.38
  Found better pose: 9690.39
  Found better pose: 9064.05
  Found better pose: 7726.79
  Found better pose: 7261.65
  Found better pose: 6200.25
  Found better pose: 5290.80
  Found better pose: 4248.82
  Found better pose: 2909.23
  Found better pose: 2528.17
  Found better pose: 1560.12
  Found better pose: 824.33
  Found better pose: 346.14
  Found better pose: 214.78
  Found better pose: 43.51
  Found better pose: -167.84
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -167.84
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -367.30, improvement = 199.46
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 354.93, improvement = -522.77
After minimization: energy = -171.53, improvement = 3.69

Complex relaxation cycle 2/25
After repacking: energy = -139.38, improvement = -28.46
After minimization: energy = -207.13, improvement = 39.29

Complex relaxation cycle 3/25
After repacking: energy = -88.51, improvement = -79.33
After minimization: energy = -244.55, improvement = 76.71

Complex relaxation cycle 4/25
After repacking: energy = -193.12, improvement = 25.28
After minimization: energy = -247.34, improvement = 79.50

Complex relaxation cycle 5/25
After repacking: energy = -192.58, improvement = 24.73
After minimization: energy = -248.72, improvement = 80.88

Complex relaxation cycle 6/25
After repacking: energy = -167.28, improvement = -0.56
After minimization: energy = -222.49, improvement = 54.65
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -204.56, improvement = 36.72
After minimization: energy = -261.13, improvement = 93.29

Complex relaxation cycle 8/25
After repacking: energy = -191.09, improvement = 23.25
After minimization: energy = -249.20, improvement = 81.36

Complex relaxation cycle 9/25
After repacking: energy = -204.36, improvement = 36.52
After minimization: energy = -261.20, improvement = 93.36
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -204.42, improvement = 36.58
After minimization: energy = -261.21, improvement = 93.36

Complex relaxation cycle 11/25
After repacking: energy = -192.21, improvement = 24.37
After minimization: energy = -249.21, improvement = 81.37

Complex relaxation cycle 12/25
After repacking: energy = -198.06, improvement = 30.22
After minimization: energy = -254.95, improvement = 87.11
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -198.35, improvement = 30.51
After minimization: energy = -248.32, improvement = 80.48

Complex relaxation cycle 14/25
After repacking: energy = -192.16, improvement = 24.31
After minimization: energy = -231.39, improvement = 63.55

Complex relaxation cycle 15/25
After repacking: energy = -194.55, improvement = 26.71
After minimization: energy = -247.12, improvement = 79.28
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -178.33, improvement = 10.49
After minimization: energy = -240.75, improvement = 72.91

Complex relaxation cycle 17/25
After repacking: energy = -203.85, improvement = 36.01
After minimization: energy = -270.65, improvement = 102.81

Complex relaxation cycle 18/25
After repacking: energy = -207.07, improvement = 39.23
After minimization: energy = -271.46, improvement = 103.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -192.44, improvement = 24.59
After minimization: energy = -259.96, improvement = 92.12

Complex relaxation cycle 20/25
After repacking: energy = -203.28, improvement = 35.44
After minimization: energy = -270.25, improvement = 102.41

Complex relaxation cycle 21/25
After repacking: energy = -204.37, improvement = 36.53
After minimization: energy = -272.04, improvement = 104.20
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -192.96, improvement = 25.12
After minimization: energy = -260.03, improvement = 92.19

Complex relaxation cycle 23/25
After repacking: energy = -192.22, improvement = 24.38
After minimization: energy = -260.01, improvement = 92.17

Complex relaxation cycle 24/25
After repacking: energy = -191.90, improvement = 24.06
After minimization: energy = -259.98, improvement = 92.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -203.80, improvement = 35.96
After minimization: energy = -271.99, improvement = 104.15

=== Complex Relaxation Summary ===
Initial energy: -167.84
Final energy: -367.30
Total energy improvement: 199.46 (118.8%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.45 Å
Interface energy: -65.16
Saved relaxed complex structure to docking_results/2_peptide_15mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -367.30
Checking contacts between peptide and CDR-L2...
Found 30 contacts with CDR-L2 (375.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -65.16

Best binding found with CDR-L3, score: -384.86
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -227.4224916636386, 'relaxed_score': -384.8620197874708, 'interface_energy': -57.15359596496421, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 8, 'salt_bridges': 0, 'hydrophobic': 5, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/2_peptide_15mer_Ab1_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/2_peptide_15mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.2768052300881312), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 4_peptide_25mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/4_peptide_25mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 4_peptide_25mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/4_peptide_25mer_Ab0...
Peptide sequence: TYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLY
Antibody has 232 residues
Peptide has 25 residues
Saving antibody to docking_results/4_peptide_25mer_Ab0_antibody.pdb
Saving peptide to docking_results/4_peptide_25mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab0_CDR-H3_combined.pdb
Initial score: 2755.24
  Found better pose: 1425.59
  Found better pose: 161.63
  Found better pose: -159.56
  Found better pose: -289.14
  Found better pose: -397.16
  Found better pose: -404.89
  Found better pose: -405.12
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab0_CDR-H2_combined.pdb
Initial score: -405.18
  Found better pose: -406.41
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab0_CDR-H1_combined.pdb
Initial score: 28886.58
  Found better pose: 28739.82
  Found better pose: 24458.67
  Found better pose: 23746.40
  Found better pose: 22368.18
  Found better pose: 20361.20
  Found better pose: 19345.68
  Found better pose: 18618.67
  Found better pose: 16579.89
  Found better pose: 16265.81
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab0_CDR-L3_combined.pdb
Initial score: 20811.13
  Found better pose: 20060.63
  Found better pose: 18065.50
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 18065.50
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -346.62, improvement = 18412.13
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 15489.28, improvement = 2576.22
After minimization: energy = 5270.53, improvement = 12794.97

Complex relaxation cycle 2/25
After repacking: energy = 6240.83, improvement = 11824.68
After minimization: energy = -266.32, improvement = 18331.82

Complex relaxation cycle 3/25
After repacking: energy = -233.69, improvement = 18299.19
After minimization: energy = -295.73, improvement = 18361.23

Complex relaxation cycle 4/25
After repacking: energy = -246.11, improvement = 18311.62
After minimization: energy = -300.65, improvement = 18366.15

Complex relaxation cycle 5/25
After repacking: energy = -251.46, improvement = 18316.96
After minimization: energy = -313.47, improvement = 18378.98

Complex relaxation cycle 6/25
After repacking: energy = -110.98, improvement = 18176.48
After minimization: energy = -314.94, improvement = 18380.44
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -270.14, improvement = 18335.65
After minimization: energy = -314.54, improvement = 18380.04

Complex relaxation cycle 8/25
After repacking: energy = -233.99, improvement = 18299.49
After minimization: energy = -281.06, improvement = 18346.57

Complex relaxation cycle 9/25
After repacking: energy = -279.70, improvement = 18345.20
After minimization: energy = -320.96, improvement = 18386.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -280.17, improvement = 18345.67
After minimization: energy = -320.55, improvement = 18386.06

Complex relaxation cycle 11/25
After repacking: energy = -279.44, improvement = 18344.95
After minimization: energy = -320.77, improvement = 18386.27

Complex relaxation cycle 12/25
After repacking: energy = -279.76, improvement = 18345.26
After minimization: energy = -320.69, improvement = 18386.20
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -278.98, improvement = 18344.48
After minimization: energy = -321.64, improvement = 18387.15

Complex relaxation cycle 14/25
After repacking: energy = -279.49, improvement = 18344.99
After minimization: energy = -321.81, improvement = 18387.32

Complex relaxation cycle 15/25
After repacking: energy = -278.49, improvement = 18343.99
After minimization: energy = -321.31, improvement = 18386.81
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -279.12, improvement = 18344.63
After minimization: energy = -321.35, improvement = 18386.86

Complex relaxation cycle 17/25
After repacking: energy = -278.87, improvement = 18344.38
After minimization: energy = -324.15, improvement = 18389.66

Complex relaxation cycle 18/25
After repacking: energy = -284.29, improvement = 18349.80
After minimization: energy = -324.83, improvement = 18390.34
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -283.68, improvement = 18349.18
After minimization: energy = -324.95, improvement = 18390.46

Complex relaxation cycle 20/25
After repacking: energy = -283.54, improvement = 18349.04
After minimization: energy = -324.96, improvement = 18390.47

Complex relaxation cycle 21/25
After repacking: energy = -283.52, improvement = 18349.03
After minimization: energy = -324.97, improvement = 18390.47
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -283.33, improvement = 18348.84
After minimization: energy = -324.88, improvement = 18390.38

Complex relaxation cycle 23/25
After repacking: energy = -283.72, improvement = 18349.22
After minimization: energy = -324.99, improvement = 18390.49

Complex relaxation cycle 24/25
After repacking: energy = -283.36, improvement = 18348.86
After minimization: energy = -324.88, improvement = 18390.39
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -283.25, improvement = 18348.76
After minimization: energy = -324.99, improvement = 18390.50

=== Complex Relaxation Summary ===
Initial energy: 18065.50
Final energy: -346.62
Total energy improvement: 18412.13 (101.9%)
Best structure was from cycle 1
Structure change: CA RMSD = 1.38 Å
Interface energy: -29.61
Saved relaxed complex structure to docking_results/4_peptide_25mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -346.62
Checking contacts between peptide and CDR-L3...
Found 37 contacts with CDR-L3 (336.4% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -29.61

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab0_CDR-L1_combined.pdb
Initial score: 1407.36
  Found better pose: 933.31
  Found better pose: 235.42
  Found better pose: -74.12
  Found better pose: -297.91
  Found better pose: -390.72
  Found better pose: -403.23
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -403.23
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -588.15, improvement = 184.92
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -340.75, improvement = -62.48
After minimization: energy = -513.41, improvement = 110.18

Complex relaxation cycle 2/25
After repacking: energy = -363.62, improvement = -39.61
After minimization: energy = -498.62, improvement = 95.39

Complex relaxation cycle 3/25
After repacking: energy = -439.24, improvement = 36.01
After minimization: energy = -506.62, improvement = 103.39

Complex relaxation cycle 4/25
After repacking: energy = -407.52, improvement = 4.29
After minimization: energy = -471.35, improvement = 68.11

Complex relaxation cycle 5/25
After repacking: energy = -443.09, improvement = 39.86
After minimization: energy = -511.31, improvement = 108.08

Complex relaxation cycle 6/25
After repacking: energy = -440.41, improvement = 37.18
After minimization: energy = -508.54, improvement = 105.31
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -440.09, improvement = 36.85
After minimization: energy = -508.66, improvement = 105.43

Complex relaxation cycle 8/25
After repacking: energy = -439.99, improvement = 36.76
After minimization: energy = -509.39, improvement = 106.16

Complex relaxation cycle 9/25
After repacking: energy = -400.49, improvement = -2.74
After minimization: energy = -468.37, improvement = 65.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -438.62, improvement = 35.39
After minimization: energy = -509.35, improvement = 106.12

Complex relaxation cycle 11/25
After repacking: energy = -440.94, improvement = 37.70
After minimization: energy = -508.65, improvement = 105.42

Complex relaxation cycle 12/25
After repacking: energy = -440.32, improvement = 37.08
After minimization: energy = -509.26, improvement = 106.03
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -439.59, improvement = 36.36
After minimization: energy = -508.31, improvement = 105.08

Complex relaxation cycle 14/25
After repacking: energy = -439.35, improvement = 36.11
After minimization: energy = -507.97, improvement = 104.74

Complex relaxation cycle 15/25
After repacking: energy = -439.28, improvement = 36.05
After minimization: energy = -508.55, improvement = 105.32
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -439.77, improvement = 36.54
After minimization: energy = -507.97, improvement = 104.74

Complex relaxation cycle 17/25
After repacking: energy = -438.49, improvement = 35.26
After minimization: energy = -509.37, improvement = 106.13

Complex relaxation cycle 18/25
After repacking: energy = -440.99, improvement = 37.76
After minimization: energy = -509.38, improvement = 106.15
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -440.90, improvement = 37.66
After minimization: energy = -509.30, improvement = 106.06

Complex relaxation cycle 20/25
After repacking: energy = -440.66, improvement = 37.43
After minimization: energy = -509.16, improvement = 105.93

Complex relaxation cycle 21/25
After repacking: energy = -440.16, improvement = 36.93
After minimization: energy = -508.75, improvement = 105.52
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -439.55, improvement = 36.32
After minimization: energy = -509.34, improvement = 106.10

Complex relaxation cycle 23/25
After repacking: energy = -440.04, improvement = 36.80
After minimization: energy = -508.54, improvement = 105.31

Complex relaxation cycle 24/25
After repacking: energy = -440.03, improvement = 36.80
After minimization: energy = -507.88, improvement = 104.65
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -438.67, improvement = 35.43
After minimization: energy = -508.27, improvement = 105.04

=== Complex Relaxation Summary ===
Initial energy: -403.23
Final energy: -588.15
Total energy improvement: 184.92 (45.9%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.30 Å
Interface energy: -52.91
Saved relaxed complex structure to docking_results/4_peptide_25mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -588.15
Checking contacts between peptide and CDR-L1...
Found 59 contacts with CDR-L1 (368.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -52.91

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab0_CDR-L2_combined.pdb
Initial score: 34417.30
  Found better pose: 34168.41
  Found better pose: 33583.53
  Found better pose: 32874.05
  Found better pose: 32067.75
  Found better pose: 29535.74
  Found better pose: 27818.48
  Found better pose: 27619.80
  Found better pose: 26149.39
  Found better pose: 24636.06
  Found better pose: 23631.56
  Found better pose: 21386.53
  Found better pose: 21371.57
  Found better pose: 21152.00
  Found better pose: 20206.07
  Found better pose: 19585.75
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 19585.75
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 11030.24, improvement = 8555.51
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 15288.43, improvement = 4297.32
After minimization: energy = 12821.82, improvement = 6763.93

Complex relaxation cycle 2/25
After repacking: energy = 12674.52, improvement = 6911.23
After minimization: energy = 12512.11, improvement = 7073.64

Complex relaxation cycle 3/25
After repacking: energy = 12550.39, improvement = 7035.36
After minimization: energy = 12491.30, improvement = 7094.45

Complex relaxation cycle 4/25
After repacking: energy = 12603.23, improvement = 6982.52
After minimization: energy = 12498.24, improvement = 7087.50

Complex relaxation cycle 5/25
After repacking: energy = 12542.21, improvement = 7043.53
After minimization: energy = 12501.28, improvement = 7084.46

Complex relaxation cycle 6/25
After repacking: energy = 12528.45, improvement = 7057.30
After minimization: energy = 12500.33, improvement = 7085.42
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 12524.45, improvement = 7061.30
After minimization: energy = 12499.80, improvement = 7085.95

Complex relaxation cycle 8/25
After repacking: energy = 12526.00, improvement = 7059.75
After minimization: energy = 12501.39, improvement = 7084.35

Complex relaxation cycle 9/25
After repacking: energy = 12521.97, improvement = 7063.78
After minimization: energy = 12497.80, improvement = 7087.94
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 12540.91, improvement = 7044.83
After minimization: energy = 12520.93, improvement = 7064.82

Complex relaxation cycle 11/25
After repacking: energy = 12516.41, improvement = 7069.34
After minimization: energy = 12505.49, improvement = 7080.26

Complex relaxation cycle 12/25
After repacking: energy = 12521.76, improvement = 7063.99
After minimization: energy = 12496.07, improvement = 7089.67
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 12527.47, improvement = 7058.28
After minimization: energy = 12492.66, improvement = 7093.09

Complex relaxation cycle 14/25
After repacking: energy = 12525.46, improvement = 7060.29
After minimization: energy = 12496.61, improvement = 7089.14

Complex relaxation cycle 15/25
After repacking: energy = 12511.54, improvement = 7074.21
After minimization: energy = 12496.41, improvement = 7089.33
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 12512.27, improvement = 7073.48
After minimization: energy = 12492.84, improvement = 7092.91

Complex relaxation cycle 17/25
After repacking: energy = 12513.03, improvement = 7072.72
After minimization: energy = 12491.25, improvement = 7094.50

Complex relaxation cycle 18/25
After repacking: energy = 12515.58, improvement = 7070.17
After minimization: energy = 12496.82, improvement = 7088.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 12535.42, improvement = 7050.33
After minimization: energy = 12516.34, improvement = 7069.41

Complex relaxation cycle 20/25
After repacking: energy = 12513.68, improvement = 7072.07
After minimization: energy = 12488.83, improvement = 7096.92

Complex relaxation cycle 21/25
After repacking: energy = 12517.82, improvement = 7067.93
After minimization: energy = 12492.30, improvement = 7093.44
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 12515.28, improvement = 7070.46
After minimization: energy = 12495.80, improvement = 7089.94

Complex relaxation cycle 23/25
After repacking: energy = 12522.32, improvement = 7063.43
After minimization: energy = 12504.51, improvement = 7081.23

Complex relaxation cycle 24/25
After repacking: energy = 12536.75, improvement = 7049.00
After minimization: energy = 12514.15, improvement = 7071.60
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 12516.00, improvement = 7069.75
After minimization: energy = 12492.81, improvement = 7092.94

=== Complex Relaxation Summary ===
Initial energy: 19585.75
Final energy: 11030.24
Total energy improvement: 8555.51 (43.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 1.25 Å
Interface energy: 11434.25
Saved relaxed complex structure to docking_results/4_peptide_25mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 11030.24
Checking contacts between peptide and CDR-L2...
Found 27 contacts with CDR-L2 (337.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 11434.25

Best binding found with CDR-L1, score: -588.15
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -403.23338951037704, 'relaxed_score': -588.1495859458064, 'interface_energy': -52.91280392510873, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 10, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/4_peptide_25mer_Ab0_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/4_peptide_25mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.19500303433348082), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

----- Processing antibody Ab1 with peptide 4_peptide_25mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/4_peptide_25mer_Ab1...
Peptide sequence: TYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLY
Antibody has 240 residues
Peptide has 25 residues
Saving antibody to docking_results/4_peptide_25mer_Ab1_antibody.pdb
Saving peptide to docking_results/4_peptide_25mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab1_CDR-H3_combined.pdb
Initial score: 29310.97
  Found better pose: 25315.46
  Found better pose: 22721.60
  Found better pose: 20729.61
  Found better pose: 19296.46
  Found better pose: 17452.28
  Found better pose: 16932.10
  Found better pose: 14913.48
  Found better pose: 12883.89
  Found better pose: 10593.24
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab1_CDR-H2_combined.pdb
Initial score: 57.35
  Found better pose: -219.89
  Found better pose: -226.34
  Found better pose: -226.64
  Found better pose: -227.10
  Found better pose: -227.56
  Found better pose: -228.28
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab1_CDR-H1_combined.pdb
Initial score: 27997.74
  Found better pose: 25793.95
  Found better pose: 23415.06
  Found better pose: 22728.95
  Found better pose: 22030.53
  Found better pose: 21082.44
  Found better pose: 20794.05
  Found better pose: 20526.88
  Found better pose: 19786.20
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab1_CDR-L3_combined.pdb
Initial score: 20885.54
  Found better pose: 20230.17
  Found better pose: 18744.38
  Found better pose: 18534.68
  Found better pose: 18299.73
  Found better pose: 18251.52
  Found better pose: 18174.45
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 18174.45
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -218.69, improvement = 18393.14
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 16515.33, improvement = 1659.12
After minimization: energy = 38230.87, improvement = -20056.42

Complex relaxation cycle 2/25
After repacking: energy = 32626.79, improvement = -14452.34
After minimization: energy = 21183.20, improvement = -3008.75

Complex relaxation cycle 3/25
After repacking: energy = 16980.36, improvement = 1194.09
After minimization: energy = 27935.22, improvement = -9760.77

Complex relaxation cycle 4/25
After repacking: energy = 21205.79, improvement = -3031.34
After minimization: energy = 79256.28, improvement = -61081.83

Complex relaxation cycle 5/25
After repacking: energy = 58298.27, improvement = -40123.82
After minimization: energy = 18985.34, improvement = -810.89

Complex relaxation cycle 6/25
After repacking: energy = 9781.88, improvement = 8392.57
After minimization: energy = 41189.18, improvement = -23014.73
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 27152.31, improvement = -8977.86
After minimization: energy = 34146.10, improvement = -15971.65

Complex relaxation cycle 8/25
After repacking: energy = 23491.39, improvement = -5316.94
After minimization: energy = 11299.77, improvement = 6874.68

Complex relaxation cycle 9/25
After repacking: energy = 6414.10, improvement = 11760.35
After minimization: energy = -14.93, improvement = 18189.38
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -14.14, improvement = 18188.59
After minimization: energy = -37.13, improvement = 18211.58

Complex relaxation cycle 11/25
After repacking: energy = -25.16, improvement = 18199.61
After minimization: energy = -50.14, improvement = 18224.59

Complex relaxation cycle 12/25
After repacking: energy = -26.26, improvement = 18200.71
After minimization: energy = -45.94, improvement = 18220.39
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -17.83, improvement = 18192.28
After minimization: energy = -42.44, improvement = 18216.89

Complex relaxation cycle 14/25
After repacking: energy = -17.76, improvement = 18192.21
After minimization: energy = -47.78, improvement = 18222.23

Complex relaxation cycle 15/25
After repacking: energy = -16.78, improvement = 18191.23
After minimization: energy = -48.82, improvement = 18223.27
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -23.49, improvement = 18197.94
After minimization: energy = -49.11, improvement = 18223.56

Complex relaxation cycle 17/25
After repacking: energy = 3.16, improvement = 18171.29
After minimization: energy = -22.23, improvement = 18196.68

Complex relaxation cycle 18/25
After repacking: energy = -22.85, improvement = 18197.30
After minimization: energy = -49.28, improvement = 18223.73
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -35.53, improvement = 18209.98
After minimization: energy = -61.12, improvement = 18235.57

Complex relaxation cycle 20/25
After repacking: energy = -35.03, improvement = 18209.48
After minimization: energy = -61.30, improvement = 18235.75

Complex relaxation cycle 21/25
After repacking: energy = -23.41, improvement = 18197.86
After minimization: energy = -49.30, improvement = 18223.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -18.62, improvement = 18193.07
After minimization: energy = -48.45, improvement = 18222.90

Complex relaxation cycle 23/25
After repacking: energy = -25.09, improvement = 18199.54
After minimization: energy = -50.70, improvement = 18225.15

Complex relaxation cycle 24/25
After repacking: energy = -37.12, improvement = 18211.57
After minimization: energy = -62.64, improvement = 18237.09
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -25.33, improvement = 18199.78
After minimization: energy = -50.67, improvement = 18225.12

=== Complex Relaxation Summary ===
Initial energy: 18174.45
Final energy: -218.69
Total energy improvement: 18393.14 (101.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 1.85 Å
Interface energy: -26.41
Saved relaxed complex structure to docking_results/4_peptide_25mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -218.69
Checking contacts between peptide and CDR-L3...
Found 37 contacts with CDR-L3 (336.4% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -26.41

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab1_CDR-L1_combined.pdb
Initial score: 3821.30
  Found better pose: 3173.74
  Found better pose: 1990.39
  Found better pose: 1093.22
  Found better pose: 932.04
  Found better pose: 350.24
  Found better pose: -7.75
  Found better pose: -28.58
  Found better pose: -205.31
  Found better pose: -228.89
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -228.89
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -383.90, improvement = 155.01
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 356.77, improvement = -585.66
After minimization: energy = -179.68, improvement = -49.21

Complex relaxation cycle 2/25
After repacking: energy = -189.15, improvement = -39.74
After minimization: energy = -261.16, improvement = 32.27

Complex relaxation cycle 3/25
After repacking: energy = -212.60, improvement = -16.28
After minimization: energy = -271.06, improvement = 42.17

Complex relaxation cycle 4/25
After repacking: energy = -201.83, improvement = -27.06
After minimization: energy = -253.73, improvement = 24.84

Complex relaxation cycle 5/25
After repacking: energy = -175.95, improvement = -52.93
After minimization: energy = -226.97, improvement = -1.92

Complex relaxation cycle 6/25
After repacking: energy = -214.08, improvement = -14.81
After minimization: energy = -266.52, improvement = 37.63
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -200.63, improvement = -28.26
After minimization: energy = -252.95, improvement = 24.06

Complex relaxation cycle 8/25
After repacking: energy = -211.28, improvement = -17.60
After minimization: energy = -264.98, improvement = 36.09

Complex relaxation cycle 9/25
After repacking: energy = -211.45, improvement = -17.44
After minimization: energy = -264.98, improvement = 36.09
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -211.15, improvement = -17.74
After minimization: energy = -264.95, improvement = 36.06

Complex relaxation cycle 11/25
After repacking: energy = -184.60, improvement = -44.28
After minimization: energy = -238.36, improvement = 9.47

Complex relaxation cycle 12/25
After repacking: energy = -199.08, improvement = -29.81
After minimization: energy = -253.06, improvement = 24.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -194.16, improvement = -34.73
After minimization: energy = -253.94, improvement = 25.05

Complex relaxation cycle 14/25
After repacking: energy = -212.70, improvement = -16.19
After minimization: energy = -265.61, improvement = 36.73

Complex relaxation cycle 15/25
After repacking: energy = -209.42, improvement = -19.47
After minimization: energy = -260.02, improvement = 31.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -211.59, improvement = -17.30
After minimization: energy = -260.35, improvement = 31.46

Complex relaxation cycle 17/25
After repacking: energy = -207.00, improvement = -21.88
After minimization: energy = -261.80, improvement = 32.91

Complex relaxation cycle 18/25
After repacking: energy = -225.26, improvement = -3.63
After minimization: energy = -272.74, improvement = 43.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -208.11, improvement = -20.77
After minimization: energy = -262.37, improvement = 33.48

Complex relaxation cycle 20/25
After repacking: energy = -224.85, improvement = -4.04
After minimization: energy = -274.67, improvement = 45.78

Complex relaxation cycle 21/25
After repacking: energy = -185.51, improvement = -43.37
After minimization: energy = -238.09, improvement = 9.20
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -208.46, improvement = -20.43
After minimization: energy = -258.59, improvement = 29.70

Complex relaxation cycle 23/25
After repacking: energy = -225.36, improvement = -3.53
After minimization: energy = -265.14, improvement = 36.25

Complex relaxation cycle 24/25
After repacking: energy = -227.78, improvement = -1.11
After minimization: energy = -262.05, improvement = 33.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -209.27, improvement = -19.62
After minimization: energy = -262.78, improvement = 33.89

=== Complex Relaxation Summary ===
Initial energy: -228.89
Final energy: -383.90
Total energy improvement: 155.01 (67.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.50 Å
Interface energy: -55.05
Saved relaxed complex structure to docking_results/4_peptide_25mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -383.90
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -55.05

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (3.54, 26.07, 0.26)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/4_peptide_25mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/4_peptide_25mer_Ab1_CDR-L2_combined.pdb
Initial score: 28451.45
  Found better pose: 27097.36
  Found better pose: 26789.87
  Found better pose: 23159.40
  Found better pose: 23144.30
  Found better pose: 22147.94
  Found better pose: 20742.77
  Found better pose: 19645.05
  Found better pose: 19611.25
  Found better pose: 19554.55
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 19554.55
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 308.07, improvement = 19246.49
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 18473.87, improvement = 1080.68
After minimization: energy = 15295.48, improvement = 4259.07

Complex relaxation cycle 2/25
After repacking: energy = 9127.65, improvement = 10426.90
After minimization: energy = 150382.33, improvement = -130827.78

Complex relaxation cycle 3/25
After repacking: energy = 120723.36, improvement = -101168.81
After minimization: energy = 58652.38, improvement = -39097.83

Complex relaxation cycle 4/25
After repacking: energy = 38413.23, improvement = -18858.68
After minimization: energy = 45622.72, improvement = -26068.17

Complex relaxation cycle 5/25
After repacking: energy = 33512.70, improvement = -13958.14
After minimization: energy = 40117.95, improvement = -20563.40

Complex relaxation cycle 6/25
After repacking: energy = 33344.08, improvement = -13789.53
After minimization: energy = 26997.31, improvement = -7442.76
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 21468.05, improvement = -1913.49
After minimization: energy = 10571.33, improvement = 8983.22

Complex relaxation cycle 8/25
After repacking: energy = 3974.52, improvement = 15580.03
After minimization: energy = 749.65, improvement = 18804.91

Complex relaxation cycle 9/25
After repacking: energy = 754.22, improvement = 18800.34
After minimization: energy = 724.42, improvement = 18830.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 721.68, improvement = 18832.87
After minimization: energy = 700.96, improvement = 18853.60

Complex relaxation cycle 11/25
After repacking: energy = 727.98, improvement = 18826.58
After minimization: energy = 712.39, improvement = 18842.16

Complex relaxation cycle 12/25
After repacking: energy = 726.01, improvement = 18828.54
After minimization: energy = 709.58, improvement = 18844.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 712.12, improvement = 18842.43
After minimization: energy = 692.02, improvement = 18862.53

Complex relaxation cycle 14/25
After repacking: energy = 707.39, improvement = 18847.17
After minimization: energy = 691.76, improvement = 18862.80

Complex relaxation cycle 15/25
After repacking: energy = 718.84, improvement = 18835.71
After minimization: energy = 708.09, improvement = 18846.47
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 715.97, improvement = 18838.58
After minimization: energy = 704.22, improvement = 18850.33

Complex relaxation cycle 17/25
After repacking: energy = 915.20, improvement = 18639.35
After minimization: energy = 693.44, improvement = 18861.11

Complex relaxation cycle 18/25
After repacking: energy = 707.97, improvement = 18846.58
After minimization: energy = 693.26, improvement = 18861.30
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 761.55, improvement = 18793.00
After minimization: energy = 702.28, improvement = 18852.27

Complex relaxation cycle 20/25
After repacking: energy = 705.42, improvement = 18849.14
After minimization: energy = 690.46, improvement = 18864.09

Complex relaxation cycle 21/25
After repacking: energy = 743.05, improvement = 18811.51
After minimization: energy = 729.53, improvement = 18825.03
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 703.92, improvement = 18850.63
After minimization: energy = 690.47, improvement = 18864.09

Complex relaxation cycle 23/25
After repacking: energy = 709.82, improvement = 18844.73
After minimization: energy = 696.44, improvement = 18858.11

Complex relaxation cycle 24/25
After repacking: energy = 704.84, improvement = 18849.71
After minimization: energy = 694.60, improvement = 18859.96
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 701.78, improvement = 18852.77
After minimization: energy = 688.98, improvement = 18865.57

=== Complex Relaxation Summary ===
Initial energy: 19554.55
Final energy: 308.07
Total energy improvement: 19246.49 (98.4%)
Best structure was from cycle 1
Structure change: CA RMSD = 2.93 Å
Interface energy: 540.78
Saved relaxed complex structure to docking_results/4_peptide_25mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 308.07
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 540.78

Best binding found with CDR-L1, score: -383.90
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -228.88742407779307, 'relaxed_score': -383.9020203490869, 'interface_energy': -55.054225008039566, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/4_peptide_25mer_Ab1_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/4_peptide_25mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.19500303433348082), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

===== Processing peptide: 3_peptide_15mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/3_peptide_15mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 3_peptide_15mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/3_peptide_15mer_Ab0...
Peptide sequence: ASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASN
Antibody has 232 residues
Peptide has 15 residues
Saving antibody to docking_results/3_peptide_15mer_Ab0_antibody.pdb
Saving peptide to docking_results/3_peptide_15mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab0_CDR-H3_combined.pdb
Initial score: -399.86
  Found better pose: -399.87
  Found better pose: -399.88
  Found better pose: -399.99
  Found better pose: -400.06
  Found better pose: -400.26
  Found better pose: -400.49
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab0_CDR-H2_combined.pdb
Initial score: -399.88
  Found better pose: -399.96
  Found better pose: -400.13
  Found better pose: -400.45
  Found better pose: -400.71
  Found better pose: -401.28
  Found better pose: -401.31
  Found better pose: -402.50
  Found better pose: -403.77
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab0_CDR-H1_combined.pdb
Initial score: 24311.71
  Found better pose: 22624.04
  Found better pose: 21693.16
  Found better pose: 21667.27
  Found better pose: 21529.64
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab0_CDR-L3_combined.pdb
Initial score: 15394.16
  Found better pose: 13248.69
  Found better pose: 12388.47
  Found better pose: 11727.51
  Found better pose: 11680.80
  Found better pose: 8872.76
  Found better pose: 7218.57
  Found better pose: 6042.05
  Found better pose: 5504.10
  Found better pose: 2751.25
  Found better pose: 2046.15
  Found better pose: 1740.93
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 1740.93
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -248.72, improvement = 1989.65
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 608.13, improvement = 1132.80
After minimization: energy = 68.38, improvement = 1672.55

Complex relaxation cycle 2/25
After repacking: energy = 151.48, improvement = 1589.45
After minimization: energy = 28.90, improvement = 1712.02

Complex relaxation cycle 3/25
After repacking: energy = 116.79, improvement = 1624.13
After minimization: energy = 37.92, improvement = 1703.01

Complex relaxation cycle 4/25
After repacking: energy = 98.48, improvement = 1642.45
After minimization: energy = 35.81, improvement = 1705.12

Complex relaxation cycle 5/25
After repacking: energy = 93.55, improvement = 1647.38
After minimization: energy = 34.35, improvement = 1706.58

Complex relaxation cycle 6/25
After repacking: energy = 116.81, improvement = 1624.12
After minimization: energy = 33.10, improvement = 1707.83
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 97.63, improvement = 1643.29
After minimization: energy = 32.90, improvement = 1708.02

Complex relaxation cycle 8/25
After repacking: energy = 98.99, improvement = 1641.94
After minimization: energy = 33.95, improvement = 1706.98

Complex relaxation cycle 9/25
After repacking: energy = 98.69, improvement = 1642.24
After minimization: energy = 32.99, improvement = 1707.94
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 105.00, improvement = 1635.93
After minimization: energy = 39.46, improvement = 1701.47

Complex relaxation cycle 11/25
After repacking: energy = 104.73, improvement = 1636.20
After minimization: energy = 39.41, improvement = 1701.52

Complex relaxation cycle 12/25
After repacking: energy = 98.27, improvement = 1642.66
After minimization: energy = 32.87, improvement = 1708.06
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 104.65, improvement = 1636.27
After minimization: energy = 39.51, improvement = 1701.41

Complex relaxation cycle 14/25
After repacking: energy = 98.89, improvement = 1642.04
After minimization: energy = 34.42, improvement = 1706.51

Complex relaxation cycle 15/25
After repacking: energy = 92.53, improvement = 1648.40
After minimization: energy = 30.29, improvement = 1710.64
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 155.65, improvement = 1585.28
After minimization: energy = 72.79, improvement = 1668.14

Complex relaxation cycle 17/25
After repacking: energy = 99.02, improvement = 1641.91
After minimization: energy = 32.94, improvement = 1707.99

Complex relaxation cycle 18/25
After repacking: energy = 100.40, improvement = 1640.53
After minimization: energy = 35.22, improvement = 1705.71
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 138.19, improvement = 1602.74
After minimization: energy = 72.76, improvement = 1668.17

Complex relaxation cycle 20/25
After repacking: energy = 98.16, improvement = 1642.77
After minimization: energy = 34.08, improvement = 1706.85

Complex relaxation cycle 21/25
After repacking: energy = 93.27, improvement = 1647.66
After minimization: energy = 30.21, improvement = 1710.72
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 114.33, improvement = 1626.59
After minimization: energy = 32.97, improvement = 1707.96

Complex relaxation cycle 23/25
After repacking: energy = 97.84, improvement = 1643.09
After minimization: energy = 33.47, improvement = 1707.46

Complex relaxation cycle 24/25
After repacking: energy = 97.27, improvement = 1643.66
After minimization: energy = 33.02, improvement = 1707.91
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 97.44, improvement = 1643.48
After minimization: energy = 33.14, improvement = 1707.79

=== Complex Relaxation Summary ===
Initial energy: 1740.93
Final energy: -248.72
Total energy improvement: 1989.65 (114.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.49 Å
Interface energy: 266.42
Saved relaxed complex structure to docking_results/3_peptide_15mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -248.72
Checking contacts between peptide and CDR-L3...
Found 39 contacts with CDR-L3 (354.5% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: 266.42

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab0_CDR-L1_combined.pdb
Initial score: -399.74
  Found better pose: -399.89
  Found better pose: -400.17
  Found better pose: -400.49
  Found better pose: -401.55
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -401.55
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -587.24, improvement = 185.68
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -342.18, improvement = -59.38
After minimization: energy = -513.19, improvement = 111.63

Complex relaxation cycle 2/25
After repacking: energy = -357.09, improvement = -44.46
After minimization: energy = -498.62, improvement = 97.06

Complex relaxation cycle 3/25
After repacking: energy = -422.79, improvement = 21.24
After minimization: energy = -508.30, improvement = 106.74

Complex relaxation cycle 4/25
After repacking: energy = -458.47, improvement = 56.92
After minimization: energy = -512.96, improvement = 111.40

Complex relaxation cycle 5/25
After repacking: energy = -450.62, improvement = 49.07
After minimization: energy = -512.64, improvement = 111.08

Complex relaxation cycle 6/25
After repacking: energy = -442.63, improvement = 41.08
After minimization: energy = -513.01, improvement = 111.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -440.77, improvement = 39.22
After minimization: energy = -513.69, improvement = 112.13

Complex relaxation cycle 8/25
After repacking: energy = -437.34, improvement = 35.78
After minimization: energy = -513.58, improvement = 112.03

Complex relaxation cycle 9/25
After repacking: energy = -436.92, improvement = 35.37
After minimization: energy = -513.10, improvement = 111.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -425.51, improvement = 23.95
After minimization: energy = -513.23, improvement = 111.67

Complex relaxation cycle 11/25
After repacking: energy = -425.02, improvement = 23.46
After minimization: energy = -513.24, improvement = 111.68

Complex relaxation cycle 12/25
After repacking: energy = -426.23, improvement = 24.68
After minimization: energy = -513.23, improvement = 111.68
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -423.97, improvement = 22.41
After minimization: energy = -513.08, improvement = 111.53

Complex relaxation cycle 14/25
After repacking: energy = -424.66, improvement = 23.10
After minimization: energy = -513.18, improvement = 111.63

Complex relaxation cycle 15/25
After repacking: energy = -425.36, improvement = 23.80
After minimization: energy = -513.20, improvement = 111.65
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -425.62, improvement = 24.06
After minimization: energy = -513.21, improvement = 111.65

Complex relaxation cycle 17/25
After repacking: energy = -425.34, improvement = 23.78
After minimization: energy = -513.13, improvement = 111.57

Complex relaxation cycle 18/25
After repacking: energy = -424.31, improvement = 22.75
After minimization: energy = -513.09, improvement = 111.54
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -423.73, improvement = 22.18
After minimization: energy = -513.04, improvement = 111.49

Complex relaxation cycle 20/25
After repacking: energy = -419.96, improvement = 18.41
After minimization: energy = -513.20, improvement = 111.64

Complex relaxation cycle 21/25
After repacking: energy = -417.24, improvement = 15.68
After minimization: energy = -512.15, improvement = 110.60
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -423.04, improvement = 21.49
After minimization: energy = -513.23, improvement = 111.67

Complex relaxation cycle 23/25
After repacking: energy = -385.06, improvement = -16.50
After minimization: energy = -473.41, improvement = 71.86

Complex relaxation cycle 24/25
After repacking: energy = -426.35, improvement = 24.79
After minimization: energy = -513.23, improvement = 111.67
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -424.89, improvement = 23.33
After minimization: energy = -513.20, improvement = 111.64

=== Complex Relaxation Summary ===
Initial energy: -401.55
Final energy: -587.24
Total energy improvement: 185.68 (46.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.26 Å
Interface energy: -53.66
Saved relaxed complex structure to docking_results/3_peptide_15mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -587.24
Checking contacts between peptide and CDR-L1...
Found 59 contacts with CDR-L1 (368.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -53.66

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab0_CDR-L2_combined.pdb
Initial score: 8963.06
  Found better pose: 8048.35
  Found better pose: 7305.36
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 7305.36
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 5882.86, improvement = 1422.50
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 6380.29, improvement = 925.07
After minimization: energy = 6214.50, improvement = 1090.86

Complex relaxation cycle 2/25
After repacking: energy = 6355.30, improvement = 950.06
After minimization: energy = 6223.05, improvement = 1082.31

Complex relaxation cycle 3/25
After repacking: energy = 6299.65, improvement = 1005.70
After minimization: energy = 6215.39, improvement = 1089.97

Complex relaxation cycle 4/25
After repacking: energy = 6316.73, improvement = 988.63
After minimization: energy = 6255.93, improvement = 1049.43

Complex relaxation cycle 5/25
After repacking: energy = 6283.64, improvement = 1021.72
After minimization: energy = 6223.71, improvement = 1081.65

Complex relaxation cycle 6/25
After repacking: energy = 6277.83, improvement = 1027.53
After minimization: energy = 6227.09, improvement = 1078.27
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 6260.56, improvement = 1044.79
After minimization: energy = 6224.21, improvement = 1081.15

Complex relaxation cycle 8/25
After repacking: energy = 6267.76, improvement = 1037.60
After minimization: energy = 6224.12, improvement = 1081.24

Complex relaxation cycle 9/25
After repacking: energy = 6266.29, improvement = 1039.07
After minimization: energy = 6224.61, improvement = 1080.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 6263.29, improvement = 1042.07
After minimization: energy = 6226.14, improvement = 1079.22

Complex relaxation cycle 11/25
After repacking: energy = 6260.32, improvement = 1045.04
After minimization: energy = 6227.39, improvement = 1077.97

Complex relaxation cycle 12/25
After repacking: energy = 6257.03, improvement = 1048.33
After minimization: energy = 6225.84, improvement = 1079.52
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 6259.72, improvement = 1045.64
After minimization: energy = 6224.49, improvement = 1080.87

Complex relaxation cycle 14/25
After repacking: energy = 6265.54, improvement = 1039.82
After minimization: energy = 6225.00, improvement = 1080.35

Complex relaxation cycle 15/25
After repacking: energy = 6263.51, improvement = 1041.85
After minimization: energy = 6226.59, improvement = 1078.77
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 6257.24, improvement = 1048.12
After minimization: energy = 6222.20, improvement = 1083.16

Complex relaxation cycle 17/25
After repacking: energy = 6268.54, improvement = 1036.82
After minimization: energy = 6230.95, improvement = 1074.41

Complex relaxation cycle 18/25
After repacking: energy = 6254.71, improvement = 1050.65
After minimization: energy = 6227.84, improvement = 1077.52
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 6261.20, improvement = 1044.16
After minimization: energy = 6235.77, improvement = 1069.59

Complex relaxation cycle 20/25
After repacking: energy = 6251.45, improvement = 1053.91
After minimization: energy = 6238.38, improvement = 1066.98

Complex relaxation cycle 21/25
After repacking: energy = 6251.19, improvement = 1054.17
After minimization: energy = 6225.61, improvement = 1079.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 6274.52, improvement = 1030.84
After minimization: energy = 6227.56, improvement = 1077.80

Complex relaxation cycle 23/25
After repacking: energy = 6276.78, improvement = 1028.58
After minimization: energy = 6227.62, improvement = 1077.73

Complex relaxation cycle 24/25
After repacking: energy = 6270.38, improvement = 1034.97
After minimization: energy = 6224.43, improvement = 1080.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 6276.77, improvement = 1028.59
After minimization: energy = 6226.46, improvement = 1078.90

=== Complex Relaxation Summary ===
Initial energy: 7305.36
Final energy: 5882.86
Total energy improvement: 1422.50 (19.5%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.28 Å
Interface energy: 6392.95
Saved relaxed complex structure to docking_results/3_peptide_15mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 5882.86
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 6392.95

Best binding found with CDR-L1, score: -587.24
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -401.5546161344081, 'relaxed_score': -587.236757930227, 'interface_energy': -53.659665664374984, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 10, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/3_peptide_15mer_Ab0_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/3_peptide_15mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 3_peptide_15mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/3_peptide_15mer_Ab1...
Peptide sequence: ASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASN
Antibody has 240 residues
Peptide has 15 residues
Saving antibody to docking_results/3_peptide_15mer_Ab1_antibody.pdb
Saving peptide to docking_results/3_peptide_15mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab1_CDR-H3_combined.pdb
Initial score: 4293.85
  Found better pose: 3428.09
  Found better pose: 3125.27
  Found better pose: 1987.54
  Found better pose: 1524.04
  Found better pose: 1226.00
  Found better pose: 429.35
  Found better pose: 48.08
  Found better pose: -33.81
  Found better pose: -161.86
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab1_CDR-H2_combined.pdb
Initial score: -217.72
  Found better pose: -221.34
  Found better pose: -221.79
  Found better pose: -222.30
  Found better pose: -222.39
  Found better pose: -222.52
  Found better pose: -222.62
  Found better pose: -222.86
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab1_CDR-H1_combined.pdb
Initial score: 23168.54
  Found better pose: 22317.77
  Found better pose: 19850.06
  Found better pose: 19514.63
  Found better pose: 18791.62
  Found better pose: 18358.21
  Found better pose: 17786.95
  Found better pose: 17044.25
  Found better pose: 16994.23
  Found better pose: 16292.02
  Found better pose: 15792.13
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab1_CDR-L3_combined.pdb
Initial score: 9303.17
  Found better pose: 8905.52
  Found better pose: 7997.31
  Found better pose: 7580.75
  Found better pose: 7341.58
  Found better pose: 6881.81
  Found better pose: 6583.61
  Found better pose: 4833.49
  Found better pose: 4181.26
  Found better pose: 3703.50
  Found better pose: 3356.76
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 3356.76
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 174.18, improvement = 3182.59
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 3500.72, improvement = -143.96
After minimization: energy = 615.07, improvement = 2741.70

Complex relaxation cycle 2/25
After repacking: energy = 631.87, improvement = 2724.90
After minimization: energy = 535.90, improvement = 2820.86

Complex relaxation cycle 3/25
After repacking: energy = 606.35, improvement = 2750.41
After minimization: energy = 540.58, improvement = 2816.18

Complex relaxation cycle 4/25
After repacking: energy = 613.11, improvement = 2743.66
After minimization: energy = 548.59, improvement = 2808.18

Complex relaxation cycle 5/25
After repacking: energy = 609.91, improvement = 2746.85
After minimization: energy = 554.21, improvement = 2802.55

Complex relaxation cycle 6/25
After repacking: energy = 582.13, improvement = 2774.64
After minimization: energy = 529.43, improvement = 2827.33
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 606.90, improvement = 2749.87
After minimization: energy = 536.29, improvement = 2820.47

Complex relaxation cycle 8/25
After repacking: energy = 600.74, improvement = 2756.02
After minimization: energy = 539.26, improvement = 2817.51

Complex relaxation cycle 9/25
After repacking: energy = 602.12, improvement = 2754.64
After minimization: energy = 533.67, improvement = 2823.09
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 582.29, improvement = 2774.47
After minimization: energy = 514.84, improvement = 2841.93

Complex relaxation cycle 11/25
After repacking: energy = 586.12, improvement = 2770.65
After minimization: energy = 540.94, improvement = 2815.83

Complex relaxation cycle 12/25
After repacking: energy = 558.13, improvement = 2798.63
After minimization: energy = 528.07, improvement = 2828.70
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 568.60, improvement = 2788.17
After minimization: energy = 532.49, improvement = 2824.28

Complex relaxation cycle 14/25
After repacking: energy = 576.08, improvement = 2780.68
After minimization: energy = 524.42, improvement = 2832.35

Complex relaxation cycle 15/25
After repacking: energy = 588.91, improvement = 2767.86
After minimization: energy = 533.29, improvement = 2823.47
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 573.07, improvement = 2783.70
After minimization: energy = 519.20, improvement = 2837.57

Complex relaxation cycle 17/25
After repacking: energy = 584.72, improvement = 2772.04
After minimization: energy = 529.40, improvement = 2827.36

Complex relaxation cycle 18/25
After repacking: energy = 570.64, improvement = 2786.12
After minimization: energy = 516.20, improvement = 2840.57
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 571.65, improvement = 2785.11
After minimization: energy = 516.42, improvement = 2840.35

Complex relaxation cycle 20/25
After repacking: energy = 583.70, improvement = 2773.06
After minimization: energy = 526.86, improvement = 2829.90

Complex relaxation cycle 21/25
After repacking: energy = 579.36, improvement = 2777.40
After minimization: energy = 514.95, improvement = 2841.81
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 576.98, improvement = 2779.79
After minimization: energy = 514.50, improvement = 2842.27

Complex relaxation cycle 23/25
After repacking: energy = 589.27, improvement = 2767.49
After minimization: energy = 525.81, improvement = 2830.95

Complex relaxation cycle 24/25
After repacking: energy = 575.03, improvement = 2781.73
After minimization: energy = 518.06, improvement = 2838.70
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 585.00, improvement = 2771.77
After minimization: energy = 529.86, improvement = 2826.90

=== Complex Relaxation Summary ===
Initial energy: 3356.76
Final energy: 174.18
Total energy improvement: 3182.59 (94.8%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.99 Å
Interface energy: 469.08
Saved relaxed complex structure to docking_results/3_peptide_15mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: 174.18
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: 469.08

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab1_CDR-L1_combined.pdb
Initial score: -222.15
  Found better pose: -222.21
  Found better pose: -222.27
  Found better pose: -222.51
  Found better pose: -223.14
  Found better pose: -224.48
  Found better pose: -224.56
  Found better pose: -226.21
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -226.21
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -390.56, improvement = 164.34
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 330.49, improvement = -556.70
After minimization: energy = -176.30, improvement = -49.92

Complex relaxation cycle 2/25
After repacking: energy = -172.17, improvement = -54.04
After minimization: energy = -250.50, improvement = 24.29

Complex relaxation cycle 3/25
After repacking: energy = -201.03, improvement = -25.18
After minimization: energy = -266.20, improvement = 39.99

Complex relaxation cycle 4/25
After repacking: energy = -196.31, improvement = -29.90
After minimization: energy = -258.76, improvement = 32.55

Complex relaxation cycle 5/25
After repacking: energy = -204.40, improvement = -21.81
After minimization: energy = -259.63, improvement = 33.42

Complex relaxation cycle 6/25
After repacking: energy = -209.34, improvement = -16.88
After minimization: energy = -259.81, improvement = 33.59
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -215.22, improvement = -10.99
After minimization: energy = -265.86, improvement = 39.64

Complex relaxation cycle 8/25
After repacking: energy = -215.56, improvement = -10.65
After minimization: energy = -265.87, improvement = 39.65

Complex relaxation cycle 9/25
After repacking: energy = -221.27, improvement = -4.95
After minimization: energy = -271.83, improvement = 45.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -221.41, improvement = -4.80
After minimization: energy = -271.85, improvement = 45.64

Complex relaxation cycle 11/25
After repacking: energy = -221.49, improvement = -4.72
After minimization: energy = -271.86, improvement = 45.65

Complex relaxation cycle 12/25
After repacking: energy = -209.65, improvement = -16.57
After minimization: energy = -259.87, improvement = 33.66
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -209.40, improvement = -16.82
After minimization: energy = -259.87, improvement = 33.66

Complex relaxation cycle 14/25
After repacking: energy = -182.70, improvement = -43.52
After minimization: energy = -233.19, improvement = 6.98

Complex relaxation cycle 15/25
After repacking: energy = -209.02, improvement = -17.19
After minimization: energy = -258.25, improvement = 32.04
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -220.80, improvement = -5.41
After minimization: energy = -271.86, improvement = 45.64

Complex relaxation cycle 17/25
After repacking: energy = -214.40, improvement = -11.81
After minimization: energy = -265.28, improvement = 39.06

Complex relaxation cycle 18/25
After repacking: energy = -195.05, improvement = -31.16
After minimization: energy = -245.19, improvement = 18.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -193.86, improvement = -32.36
After minimization: energy = -244.78, improvement = 18.57

Complex relaxation cycle 20/25
After repacking: energy = -209.21, improvement = -17.00
After minimization: energy = -259.52, improvement = 33.30

Complex relaxation cycle 21/25
After repacking: energy = -208.79, improvement = -17.43
After minimization: energy = -259.56, improvement = 33.35
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -221.52, improvement = -4.69
After minimization: energy = -271.86, improvement = 45.65

Complex relaxation cycle 23/25
After repacking: energy = -221.27, improvement = -4.95
After minimization: energy = -271.87, improvement = 45.65

Complex relaxation cycle 24/25
After repacking: energy = -221.50, improvement = -4.72
After minimization: energy = -271.87, improvement = 45.65
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -209.13, improvement = -17.08
After minimization: energy = -259.83, improvement = 33.62

=== Complex Relaxation Summary ===
Initial energy: -226.21
Final energy: -390.56
Total energy improvement: 164.34 (72.6%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.46 Å
Interface energy: -55.86
Saved relaxed complex structure to docking_results/3_peptide_15mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -390.56
Checking contacts between peptide and CDR-L1...
Found 61 contacts with CDR-L1 (381.2% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -55.86

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-22.39, 62.66, 1.66)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/3_peptide_15mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/3_peptide_15mer_Ab1_CDR-L2_combined.pdb
Initial score: 12760.50
  Found better pose: 9510.07
  Found better pose: 8598.09
  Found better pose: 7565.19
  Found better pose: 4834.62
  Found better pose: 3107.83
  Found better pose: 3014.83
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 3014.83
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 964.79, improvement = 2050.04
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 2176.73, improvement = 838.10
After minimization: energy = 1256.96, improvement = 1757.87

Complex relaxation cycle 2/25
After repacking: energy = 1348.03, improvement = 1666.80
After minimization: energy = 1127.51, improvement = 1887.32

Complex relaxation cycle 3/25
After repacking: energy = 1347.73, improvement = 1667.10
After minimization: energy = 1138.48, improvement = 1876.35

Complex relaxation cycle 4/25
After repacking: energy = 1335.66, improvement = 1679.17
After minimization: energy = 1124.08, improvement = 1890.75

Complex relaxation cycle 5/25
After repacking: energy = 1334.60, improvement = 1680.23
After minimization: energy = 1123.68, improvement = 1891.15

Complex relaxation cycle 6/25
After repacking: energy = 1356.89, improvement = 1657.94
After minimization: energy = 1137.60, improvement = 1877.23
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 1332.32, improvement = 1682.51
After minimization: energy = 1125.80, improvement = 1889.03

Complex relaxation cycle 8/25
After repacking: energy = 1334.26, improvement = 1680.57
After minimization: energy = 1125.55, improvement = 1889.28

Complex relaxation cycle 9/25
After repacking: energy = 1333.86, improvement = 1680.98
After minimization: energy = 1125.23, improvement = 1889.60
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 1347.32, improvement = 1667.51
After minimization: energy = 1137.27, improvement = 1877.56

Complex relaxation cycle 11/25
After repacking: energy = 1334.22, improvement = 1680.61
After minimization: energy = 1125.38, improvement = 1889.46

Complex relaxation cycle 12/25
After repacking: energy = 1360.85, improvement = 1653.99
After minimization: energy = 1151.88, improvement = 1862.95
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 1334.76, improvement = 1680.08
After minimization: energy = 1124.67, improvement = 1890.16

Complex relaxation cycle 14/25
After repacking: energy = 1335.91, improvement = 1678.92
After minimization: energy = 1125.25, improvement = 1889.58

Complex relaxation cycle 15/25
After repacking: energy = 1336.37, improvement = 1678.46
After minimization: energy = 1124.98, improvement = 1889.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 1374.17, improvement = 1640.66
After minimization: energy = 1169.29, improvement = 1845.54

Complex relaxation cycle 17/25
After repacking: energy = 1314.27, improvement = 1700.56
After minimization: energy = 1122.74, improvement = 1892.09

Complex relaxation cycle 18/25
After repacking: energy = 1334.23, improvement = 1680.60
After minimization: energy = 1124.76, improvement = 1890.08
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 1346.40, improvement = 1668.43
After minimization: energy = 1136.68, improvement = 1878.15

Complex relaxation cycle 20/25
After repacking: energy = 1347.03, improvement = 1667.80
After minimization: energy = 1137.24, improvement = 1877.59

Complex relaxation cycle 21/25
After repacking: energy = 1347.06, improvement = 1667.77
After minimization: energy = 1136.84, improvement = 1877.99
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 1336.94, improvement = 1677.89
After minimization: energy = 1125.52, improvement = 1889.31

Complex relaxation cycle 23/25
After repacking: energy = 1334.90, improvement = 1679.93
After minimization: energy = 1124.88, improvement = 1889.95

Complex relaxation cycle 24/25
After repacking: energy = 1334.54, improvement = 1680.29
After minimization: energy = 1125.27, improvement = 1889.57
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 1348.20, improvement = 1666.63
After minimization: energy = 1137.37, improvement = 1877.46

=== Complex Relaxation Summary ===
Initial energy: 3014.83
Final energy: 964.79
Total energy improvement: 2050.04 (68.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.56 Å
Interface energy: 1255.51
Saved relaxed complex structure to docking_results/3_peptide_15mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 964.79
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 1255.51

Best binding found with CDR-L1, score: -390.56
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -226.21312815166357, 'relaxed_score': -390.5558012083387, 'interface_energy': -55.86496482224965, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/3_peptide_15mer_Ab1_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/3_peptide_15mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 1_peptide_25mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/1_peptide_25mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 1_peptide_25mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/1_peptide_25mer_Ab0...
Peptide sequence: LEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLY
Antibody has 232 residues
Peptide has 25 residues
Saving antibody to docking_results/1_peptide_25mer_Ab0_antibody.pdb
Saving peptide to docking_results/1_peptide_25mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab0_CDR-H3_combined.pdb
Initial score: 31111.97
  Found better pose: 30475.27
  Found better pose: 29314.62
  Found better pose: 27546.48
  Found better pose: 26187.56
  Found better pose: 25481.46
  Found better pose: 22683.75
  Found better pose: 21803.47
  Found better pose: 21726.04
  Found better pose: 18986.48
  Found better pose: 17527.94
  Found better pose: 17210.46
  Found better pose: 15158.56
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab0_CDR-H2_combined.pdb
Initial score: 39173.27
  Found better pose: 36691.43
  Found better pose: 36568.22
  Found better pose: 34892.54
  Found better pose: 33493.86
  Found better pose: 31421.33
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab0_CDR-H1_combined.pdb
Initial score: 42635.92
  Found better pose: 41001.83
  Found better pose: 38571.33
  Found better pose: 35773.05
  Found better pose: 33167.49
  Found better pose: 32118.18
  Found better pose: 29311.66
  Found better pose: 28623.55
  Found better pose: 25893.04
  Found better pose: 25254.53
  Found better pose: 25130.81
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab0_CDR-L3_combined.pdb
Initial score: 16914.88
  Found better pose: 16346.90
  Found better pose: 16193.45
  Found better pose: 15967.08
  Found better pose: 14802.89
  Found better pose: 14720.36
  Found better pose: 13649.19
  Found better pose: 12562.26
  Found better pose: 11264.05
  Found better pose: 10238.35
  Found better pose: 10236.51
  Found better pose: 8949.32
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 8949.32
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -556.34, improvement = 9505.66
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 6312.04, improvement = 2637.28
After minimization: energy = -450.82, improvement = 9400.14

Complex relaxation cycle 2/25
After repacking: energy = -181.57, improvement = 9130.89
After minimization: energy = -449.83, improvement = 9399.15

Complex relaxation cycle 3/25
After repacking: energy = -355.04, improvement = 9304.36
After minimization: energy = -456.33, improvement = 9405.65

Complex relaxation cycle 4/25
After repacking: energy = -391.84, improvement = 9341.16
After minimization: energy = -461.22, improvement = 9410.54

Complex relaxation cycle 5/25
After repacking: energy = -390.68, improvement = 9340.00
After minimization: energy = -461.45, improvement = 9410.77

Complex relaxation cycle 6/25
After repacking: energy = -395.63, improvement = 9344.95
After minimization: energy = -457.40, improvement = 9406.72
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -400.32, improvement = 9349.64
After minimization: energy = -460.98, improvement = 9410.30

Complex relaxation cycle 8/25
After repacking: energy = -404.10, improvement = 9353.42
After minimization: energy = -473.10, improvement = 9422.42

Complex relaxation cycle 9/25
After repacking: energy = -352.89, improvement = 9302.21
After minimization: energy = -462.43, improvement = 9411.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -401.55, improvement = 9350.87
After minimization: energy = -461.81, improvement = 9411.13

Complex relaxation cycle 11/25
After repacking: energy = -396.61, improvement = 9345.93
After minimization: energy = -460.25, improvement = 9409.57

Complex relaxation cycle 12/25
After repacking: energy = -394.77, improvement = 9344.09
After minimization: energy = -461.93, improvement = 9411.25
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -410.47, improvement = 9359.79
After minimization: energy = -475.17, improvement = 9424.49

Complex relaxation cycle 14/25
After repacking: energy = -332.93, improvement = 9282.25
After minimization: energy = -468.22, improvement = 9417.54

Complex relaxation cycle 15/25
After repacking: energy = -394.68, improvement = 9344.00
After minimization: energy = -470.81, improvement = 9420.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -407.19, improvement = 9356.51
After minimization: energy = -471.18, improvement = 9420.50

Complex relaxation cycle 17/25
After repacking: energy = -411.07, improvement = 9360.39
After minimization: energy = -470.64, improvement = 9419.96

Complex relaxation cycle 18/25
After repacking: energy = -412.36, improvement = 9361.68
After minimization: energy = -471.17, improvement = 9420.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -411.49, improvement = 9360.81
After minimization: energy = -471.62, improvement = 9420.94

Complex relaxation cycle 20/25
After repacking: energy = -412.10, improvement = 9361.42
After minimization: energy = -471.60, improvement = 9420.92

Complex relaxation cycle 21/25
After repacking: energy = -411.99, improvement = 9361.31
After minimization: energy = -471.42, improvement = 9420.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -370.50, improvement = 9319.82
After minimization: energy = -432.08, improvement = 9381.40

Complex relaxation cycle 23/25
After repacking: energy = -368.72, improvement = 9318.04
After minimization: energy = -431.74, improvement = 9381.06

Complex relaxation cycle 24/25
After repacking: energy = -409.38, improvement = 9358.69
After minimization: energy = -471.30, improvement = 9420.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -409.08, improvement = 9358.39
After minimization: energy = -471.04, improvement = 9420.36

=== Complex Relaxation Summary ===
Initial energy: 8949.32
Final energy: -556.34
Total energy improvement: 9505.66 (106.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.82 Å
Interface energy: -59.44
Saved relaxed complex structure to docking_results/1_peptide_25mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -556.34
Checking contacts between peptide and CDR-L3...
Found 41 contacts with CDR-L3 (372.7% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -59.44

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab0_CDR-L1_combined.pdb
Initial score: 18133.28
  Found better pose: 18125.84
  Found better pose: 17442.08
  Found better pose: 14987.52
  Found better pose: 13848.19
  Found better pose: 13251.52
  Found better pose: 11986.37
  Found better pose: 9764.38
  Found better pose: 9277.19
  Found better pose: 7434.93
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 7434.93
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -521.91, improvement = 7956.84
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 6442.10, improvement = 992.83
After minimization: energy = -366.12, improvement = 7801.05

Complex relaxation cycle 2/25
After repacking: energy = -318.41, improvement = 7753.34
After minimization: energy = -405.36, improvement = 7840.29

Complex relaxation cycle 3/25
After repacking: energy = -346.47, improvement = 7781.40
After minimization: energy = -407.67, improvement = 7842.60

Complex relaxation cycle 4/25
After repacking: energy = -313.40, improvement = 7748.33
After minimization: energy = -371.72, improvement = 7806.65

Complex relaxation cycle 5/25
After repacking: energy = -319.33, improvement = 7754.26
After minimization: energy = -372.10, improvement = 7807.03

Complex relaxation cycle 6/25
After repacking: energy = -360.06, improvement = 7794.99
After minimization: energy = -411.31, improvement = 7846.24
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -360.94, improvement = 7795.87
After minimization: energy = -412.34, improvement = 7847.27

Complex relaxation cycle 8/25
After repacking: energy = -322.10, improvement = 7757.03
After minimization: energy = -373.41, improvement = 7808.34

Complex relaxation cycle 9/25
After repacking: energy = -364.46, improvement = 7799.39
After minimization: energy = -416.42, improvement = 7851.35
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -364.81, improvement = 7799.74
After minimization: energy = -413.71, improvement = 7848.64

Complex relaxation cycle 11/25
After repacking: energy = -365.06, improvement = 7799.99
After minimization: energy = -413.65, improvement = 7848.58

Complex relaxation cycle 12/25
After repacking: energy = -366.24, improvement = 7801.18
After minimization: energy = -414.62, improvement = 7849.56
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -367.47, improvement = 7802.40
After minimization: energy = -414.64, improvement = 7849.57

Complex relaxation cycle 14/25
After repacking: energy = -366.91, improvement = 7801.84
After minimization: energy = -414.77, improvement = 7849.70

Complex relaxation cycle 15/25
After repacking: energy = -327.68, improvement = 7762.61
After minimization: energy = -375.00, improvement = 7809.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -367.56, improvement = 7802.49
After minimization: energy = -415.63, improvement = 7850.56

Complex relaxation cycle 17/25
After repacking: energy = -368.43, improvement = 7803.37
After minimization: energy = -422.84, improvement = 7857.77

Complex relaxation cycle 18/25
After repacking: energy = -373.39, improvement = 7808.32
After minimization: energy = -422.78, improvement = 7857.71
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -373.19, improvement = 7808.12
After minimization: energy = -422.89, improvement = 7857.82

Complex relaxation cycle 20/25
After repacking: energy = -372.51, improvement = 7807.44
After minimization: energy = -422.97, improvement = 7857.90

Complex relaxation cycle 21/25
After repacking: energy = -372.33, improvement = 7807.26
After minimization: energy = -422.96, improvement = 7857.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -372.64, improvement = 7807.57
After minimization: energy = -421.50, improvement = 7856.43

Complex relaxation cycle 23/25
After repacking: energy = -373.90, improvement = 7808.83
After minimization: energy = -422.92, improvement = 7857.85

Complex relaxation cycle 24/25
After repacking: energy = -373.27, improvement = 7808.20
After minimization: energy = -422.86, improvement = 7857.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -372.90, improvement = 7807.83
After minimization: energy = -422.88, improvement = 7857.81

=== Complex Relaxation Summary ===
Initial energy: 7434.93
Final energy: -521.91
Total energy improvement: 7956.84 (107.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 1.47 Å
Interface energy: -48.99
Saved relaxed complex structure to docking_results/1_peptide_25mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -521.91
Checking contacts between peptide and CDR-L1...
Found 62 contacts with CDR-L1 (387.5% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -48.99

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab0_CDR-L2_combined.pdb
Initial score: 27077.26
  Found better pose: 24556.36
  Found better pose: 21604.33
  Found better pose: 20964.88
  Found better pose: 19449.99
  Found better pose: 18976.89
  Found better pose: 18272.40
  Found better pose: 17982.51
  Found better pose: 15623.72
  Found better pose: 15063.66
  Found better pose: 15051.17
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 15051.17
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 578.82, improvement = 14472.35
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 8524.02, improvement = 6527.15
After minimization: energy = 777.45, improvement = 14273.72

Complex relaxation cycle 2/25
After repacking: energy = 980.26, improvement = 14070.91
After minimization: energy = 712.65, improvement = 14338.51

Complex relaxation cycle 3/25
After repacking: energy = 808.29, improvement = 14242.87
After minimization: energy = 704.51, improvement = 14346.66

Complex relaxation cycle 4/25
After repacking: energy = 739.26, improvement = 14311.91
After minimization: energy = 702.97, improvement = 14348.19

Complex relaxation cycle 5/25
After repacking: energy = 738.00, improvement = 14313.17
After minimization: energy = 702.67, improvement = 14348.49

Complex relaxation cycle 6/25
After repacking: energy = 737.52, improvement = 14313.64
After minimization: energy = 697.46, improvement = 14353.71
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 741.93, improvement = 14309.24
After minimization: energy = 699.66, improvement = 14351.50

Complex relaxation cycle 8/25
After repacking: energy = 739.40, improvement = 14311.76
After minimization: energy = 699.50, improvement = 14351.67

Complex relaxation cycle 9/25
After repacking: energy = 738.02, improvement = 14313.14
After minimization: energy = 692.43, improvement = 14358.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 734.91, improvement = 14316.26
After minimization: energy = 682.28, improvement = 14368.89

Complex relaxation cycle 11/25
After repacking: energy = 767.56, improvement = 14283.61
After minimization: energy = 715.08, improvement = 14336.09

Complex relaxation cycle 12/25
After repacking: energy = 722.60, improvement = 14328.57
After minimization: energy = 676.75, improvement = 14374.41
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 719.15, improvement = 14332.02
After minimization: energy = 672.46, improvement = 14378.71

Complex relaxation cycle 14/25
After repacking: energy = 757.57, improvement = 14293.59
After minimization: energy = 715.20, improvement = 14335.97

Complex relaxation cycle 15/25
After repacking: energy = 713.21, improvement = 14337.96
After minimization: energy = 675.35, improvement = 14375.81
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 713.63, improvement = 14337.54
After minimization: energy = 675.15, improvement = 14376.01

Complex relaxation cycle 17/25
After repacking: energy = 714.12, improvement = 14337.05
After minimization: energy = 675.40, improvement = 14375.77

Complex relaxation cycle 18/25
After repacking: energy = 714.02, improvement = 14337.15
After minimization: energy = 674.96, improvement = 14376.21
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 713.85, improvement = 14337.32
After minimization: energy = 675.08, improvement = 14376.08

Complex relaxation cycle 20/25
After repacking: energy = 713.66, improvement = 14337.51
After minimization: energy = 675.10, improvement = 14376.07

Complex relaxation cycle 21/25
After repacking: energy = 713.86, improvement = 14337.31
After minimization: energy = 675.16, improvement = 14376.01
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 711.84, improvement = 14339.32
After minimization: energy = 674.41, improvement = 14376.76

Complex relaxation cycle 23/25
After repacking: energy = 711.45, improvement = 14339.72
After minimization: energy = 674.40, improvement = 14376.77

Complex relaxation cycle 24/25
After repacking: energy = 711.76, improvement = 14339.41
After minimization: energy = 674.42, improvement = 14376.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 711.35, improvement = 14339.82
After minimization: energy = 674.40, improvement = 14376.77

=== Complex Relaxation Summary ===
Initial energy: 15051.17
Final energy: 578.82
Total energy improvement: 14472.35 (96.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.95 Å
Interface energy: 1027.54
Saved relaxed complex structure to docking_results/1_peptide_25mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 578.82
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 1027.54

Best binding found with CDR-L3, score: -556.34
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': 8949.319527051946, 'relaxed_score': -556.3408947988797, 'interface_energy': -59.43804626608335, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 7, 'salt_bridges': 0, 'hydrophobic': 8, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/1_peptide_25mer_Ab0_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/1_peptide_25mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

----- Processing antibody Ab1 with peptide 1_peptide_25mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/1_peptide_25mer_Ab1...
Peptide sequence: LEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLY
Antibody has 240 residues
Peptide has 25 residues
Saving antibody to docking_results/1_peptide_25mer_Ab1_antibody.pdb
Saving peptide to docking_results/1_peptide_25mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab1_CDR-H3_combined.pdb
Initial score: 45999.29
  Found better pose: 45694.84
  Found better pose: 45060.62
  Found better pose: 44970.55
  Found better pose: 42604.68
  Found better pose: 39674.73
  Found better pose: 38511.80
  Found better pose: 37977.92
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab1_CDR-H2_combined.pdb
Initial score: 36856.75
  Found better pose: 33550.63
  Found better pose: 31276.29
  Found better pose: 26647.10
  Found better pose: 26414.10
  Found better pose: 24095.46
  Found better pose: 20145.23
  Found better pose: 19553.46
  Found better pose: 17499.35
  Found better pose: 15638.03
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab1_CDR-H1_combined.pdb
Initial score: 45529.21
  Found better pose: 45352.20
  Found better pose: 44539.99
  Found better pose: 41785.27
  Found better pose: 41216.39
  Found better pose: 39903.72
  Found better pose: 38353.95
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab1_CDR-L3_combined.pdb
Initial score: 15144.23
  Found better pose: 14855.01
  Found better pose: 14214.74
  Found better pose: 13697.81
  Found better pose: 12667.62
  Found better pose: 11450.42
  Found better pose: 10482.49
  Found better pose: 9256.60
  Found better pose: 9012.06
  Found better pose: 4652.54
  Found better pose: 2298.28
  Found better pose: 2287.52
  Found better pose: 1551.83
  Found better pose: 212.36
  Found better pose: 115.73
  Found better pose: -102.70
  Found better pose: -216.57
  Found better pose: -225.40
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -225.40
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -380.94, improvement = 155.54
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 333.87, improvement = -559.28
After minimization: energy = -166.88, improvement = -58.53

Complex relaxation cycle 2/25
After repacking: energy = -183.92, improvement = -41.48
After minimization: energy = -257.92, improvement = 32.52

Complex relaxation cycle 3/25
After repacking: energy = -203.42, improvement = -21.98
After minimization: energy = -252.92, improvement = 27.52

Complex relaxation cycle 4/25
After repacking: energy = -211.54, improvement = -13.86
After minimization: energy = -252.99, improvement = 27.58

Complex relaxation cycle 5/25
After repacking: energy = -216.92, improvement = -8.48
After minimization: energy = -258.98, improvement = 33.57

Complex relaxation cycle 6/25
After repacking: energy = -223.15, improvement = -2.25
After minimization: energy = -265.27, improvement = 39.87
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -211.44, improvement = -13.96
After minimization: energy = -253.28, improvement = 27.88

Complex relaxation cycle 8/25
After repacking: energy = -211.02, improvement = -14.39
After minimization: energy = -249.98, improvement = 24.57

Complex relaxation cycle 9/25
After repacking: energy = -210.79, improvement = -14.62
After minimization: energy = -253.30, improvement = 27.90
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -211.91, improvement = -13.49
After minimization: energy = -253.33, improvement = 27.93

Complex relaxation cycle 11/25
After repacking: energy = -211.73, improvement = -13.68
After minimization: energy = -253.33, improvement = 27.92

Complex relaxation cycle 12/25
After repacking: energy = -223.77, improvement = -1.64
After minimization: energy = -265.34, improvement = 39.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -211.26, improvement = -14.14
After minimization: energy = -252.86, improvement = 27.46

Complex relaxation cycle 14/25
After repacking: energy = -211.62, improvement = -13.78
After minimization: energy = -252.85, improvement = 27.45

Complex relaxation cycle 15/25
After repacking: energy = -211.94, improvement = -13.46
After minimization: energy = -253.34, improvement = 27.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -224.09, improvement = -1.32
After minimization: energy = -265.35, improvement = 39.94

Complex relaxation cycle 17/25
After repacking: energy = -211.32, improvement = -14.08
After minimization: energy = -253.09, improvement = 27.69

Complex relaxation cycle 18/25
After repacking: energy = -211.93, improvement = -13.47
After minimization: energy = -253.31, improvement = 27.91
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -223.57, improvement = -1.83
After minimization: energy = -265.31, improvement = 39.91

Complex relaxation cycle 20/25
After repacking: energy = -207.03, improvement = -18.37
After minimization: energy = -248.86, improvement = 23.46

Complex relaxation cycle 21/25
After repacking: energy = -216.73, improvement = -8.68
After minimization: energy = -265.52, improvement = 40.11
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -211.59, improvement = -13.82
After minimization: energy = -255.92, improvement = 30.52

Complex relaxation cycle 23/25
After repacking: energy = -226.29, improvement = 0.88
After minimization: energy = -270.54, improvement = 45.14

Complex relaxation cycle 24/25
After repacking: energy = -221.28, improvement = -4.13
After minimization: energy = -262.21, improvement = 36.81
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -219.93, improvement = -5.48
After minimization: energy = -262.04, improvement = 36.64

=== Complex Relaxation Summary ===
Initial energy: -225.40
Final energy: -380.94
Total energy improvement: 155.54 (69.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.44 Å
Interface energy: -53.90
Saved relaxed complex structure to docking_results/1_peptide_25mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -380.94
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -53.90

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab1_CDR-L1_combined.pdb
Initial score: 14186.18
  Found better pose: 11548.90
  Found better pose: 10237.30
  Found better pose: 6892.48
  Found better pose: 4363.98
  Found better pose: 3396.96
  Found better pose: 1924.15
  Found better pose: 861.47
  Found better pose: 725.00
  Found better pose: 159.03
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 159.03
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -356.41, improvement = 515.44
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 527.82, improvement = -368.79
After minimization: energy = -63.09, improvement = 222.12

Complex relaxation cycle 2/25
After repacking: energy = -179.10, improvement = 338.13
After minimization: energy = -245.88, improvement = 404.91

Complex relaxation cycle 3/25
After repacking: energy = -197.81, improvement = 356.84
After minimization: energy = -247.16, improvement = 406.19

Complex relaxation cycle 4/25
After repacking: energy = -198.38, improvement = 357.41
After minimization: energy = -248.73, improvement = 407.76

Complex relaxation cycle 5/25
After repacking: energy = -199.72, improvement = 358.75
After minimization: energy = -250.11, improvement = 409.14

Complex relaxation cycle 6/25
After repacking: energy = -209.61, improvement = 368.64
After minimization: energy = -263.23, improvement = 422.26
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -201.01, improvement = 360.04
After minimization: energy = -253.86, improvement = 412.89

Complex relaxation cycle 8/25
After repacking: energy = -209.84, improvement = 368.88
After minimization: energy = -265.30, improvement = 424.33

Complex relaxation cycle 9/25
After repacking: energy = -208.59, improvement = 367.62
After minimization: energy = -257.51, improvement = 416.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -223.82, improvement = 382.85
After minimization: energy = -271.72, improvement = 430.75

Complex relaxation cycle 11/25
After repacking: energy = -211.06, improvement = 370.10
After minimization: energy = -257.47, improvement = 416.51

Complex relaxation cycle 12/25
After repacking: energy = -223.71, improvement = 382.74
After minimization: energy = -271.73, improvement = 430.76
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -210.99, improvement = 370.02
After minimization: energy = -259.47, improvement = 418.50

Complex relaxation cycle 14/25
After repacking: energy = -210.83, improvement = 369.86
After minimization: energy = -259.46, improvement = 418.50

Complex relaxation cycle 15/25
After repacking: energy = -211.13, improvement = 370.16
After minimization: energy = -259.73, improvement = 418.76
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -217.13, improvement = 376.16
After minimization: energy = -263.52, improvement = 422.55

Complex relaxation cycle 17/25
After repacking: energy = -206.17, improvement = 365.20
After minimization: energy = -254.02, improvement = 413.05

Complex relaxation cycle 18/25
After repacking: energy = -206.38, improvement = 365.41
After minimization: energy = -255.09, improvement = 414.12
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -208.56, improvement = 367.59
After minimization: energy = -255.48, improvement = 414.52

Complex relaxation cycle 20/25
After repacking: energy = -194.23, improvement = 353.26
After minimization: energy = -243.09, improvement = 402.12

Complex relaxation cycle 21/25
After repacking: energy = -204.88, improvement = 363.91
After minimization: energy = -255.11, improvement = 414.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -216.64, improvement = 375.67
After minimization: energy = -269.68, improvement = 428.71

Complex relaxation cycle 23/25
After repacking: energy = -204.26, improvement = 363.30
After minimization: energy = -257.66, improvement = 416.69

Complex relaxation cycle 24/25
After repacking: energy = -216.50, improvement = 375.53
After minimization: energy = -267.43, improvement = 426.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -217.07, improvement = 376.10
After minimization: energy = -269.93, improvement = 428.96

=== Complex Relaxation Summary ===
Initial energy: 159.03
Final energy: -356.41
Total energy improvement: 515.44 (324.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.49 Å
Interface energy: -54.25
Saved relaxed complex structure to docking_results/1_peptide_25mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -356.41
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -54.25

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (9.81, 32.81, -1.11)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/1_peptide_25mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/1_peptide_25mer_Ab1_CDR-L2_combined.pdb
Initial score: 31600.66
  Found better pose: 31564.38
  Found better pose: 30046.01
  Found better pose: 29510.71
  Found better pose: 28521.33
  Found better pose: 27528.16
  Found better pose: 27453.16
  Found better pose: 25130.89
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 25130.89
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 3637.36, improvement = 21493.53
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 22823.17, improvement = 2307.72
After minimization: energy = 23957.32, improvement = 1173.57

Complex relaxation cycle 2/25
After repacking: energy = 20590.49, improvement = 4540.40
After minimization: energy = 15994.34, improvement = 9136.55

Complex relaxation cycle 3/25
After repacking: energy = 13804.16, improvement = 11326.73
After minimization: energy = 32974.83, improvement = -7843.94

Complex relaxation cycle 4/25
After repacking: energy = 26650.47, improvement = -1519.58
After minimization: energy = 43587.69, improvement = -18456.80

Complex relaxation cycle 5/25
After repacking: energy = 36703.27, improvement = -11572.38
After minimization: energy = 16715.00, improvement = 8415.89

Complex relaxation cycle 6/25
After repacking: energy = 8863.25, improvement = 16267.64
After minimization: energy = 4434.49, improvement = 20696.40
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 4323.43, improvement = 20807.46
After minimization: energy = 4255.31, improvement = 20875.58

Complex relaxation cycle 8/25
After repacking: energy = 4275.88, improvement = 20855.01
After minimization: energy = 4245.66, improvement = 20885.23

Complex relaxation cycle 9/25
After repacking: energy = 4279.10, improvement = 20851.79
After minimization: energy = 4254.09, improvement = 20876.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 4251.53, improvement = 20879.36
After minimization: energy = 4233.04, improvement = 20897.85

Complex relaxation cycle 11/25
After repacking: energy = 4258.33, improvement = 20872.56
After minimization: energy = 4245.93, improvement = 20884.96

Complex relaxation cycle 12/25
After repacking: energy = 4282.47, improvement = 20848.42
After minimization: energy = 4282.42, improvement = 20848.47
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 4255.70, improvement = 20875.19
After minimization: energy = 4255.63, improvement = 20875.26

Complex relaxation cycle 14/25
After repacking: energy = 4249.63, improvement = 20881.26
After minimization: energy = 4249.60, improvement = 20881.29

Complex relaxation cycle 15/25
After repacking: energy = 4243.63, improvement = 20887.26
After minimization: energy = 4243.62, improvement = 20887.27
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 4243.62, improvement = 20887.27
After minimization: energy = 4243.51, improvement = 20887.38

Complex relaxation cycle 17/25
After repacking: energy = 4260.83, improvement = 20870.06
After minimization: energy = 4260.80, improvement = 20870.09

Complex relaxation cycle 18/25
After repacking: energy = 4243.54, improvement = 20887.35
After minimization: energy = 4243.50, improvement = 20887.39
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 4249.51, improvement = 20881.38
After minimization: energy = 4249.47, improvement = 20881.42

Complex relaxation cycle 20/25
After repacking: energy = 4255.51, improvement = 20875.38
After minimization: energy = 4255.47, improvement = 20875.42

Complex relaxation cycle 21/25
After repacking: energy = 4255.49, improvement = 20875.40
After minimization: energy = 4255.46, improvement = 20875.43
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 4255.47, improvement = 20875.42
After minimization: energy = 4255.46, improvement = 20875.43

Complex relaxation cycle 23/25
After repacking: energy = 4255.46, improvement = 20875.43
After minimization: energy = 4255.46, improvement = 20875.43

Complex relaxation cycle 24/25
After repacking: energy = 4243.45, improvement = 20887.44
After minimization: energy = 4243.44, improvement = 20887.45
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 4255.45, improvement = 20875.44
After minimization: energy = 4255.42, improvement = 20875.47

=== Complex Relaxation Summary ===
Initial energy: 25130.89
Final energy: 3637.36
Total energy improvement: 21493.53 (85.5%)
Best structure was from cycle 1
Structure change: CA RMSD = 2.72 Å
Interface energy: 3849.15
Saved relaxed complex structure to docking_results/1_peptide_25mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 3637.36
Checking contacts between peptide and CDR-L2...
Found 27 contacts with CDR-L2 (337.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 14
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 3849.15

Best binding found with CDR-L3, score: -380.94
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -225.40387241130028, 'relaxed_score': -380.9410278273894, 'interface_energy': -53.90000396087993, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 8, 'salt_bridges': 0, 'hydrophobic': 5, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/1_peptide_25mer_Ab1_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/1_peptide_25mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

===== Processing peptide: 2_peptide_25mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/2_peptide_25mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 2_peptide_25mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/2_peptide_25mer_Ab0...
Peptide sequence: TYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVAL
Antibody has 232 residues
Peptide has 25 residues
Saving antibody to docking_results/2_peptide_25mer_Ab0_antibody.pdb
Saving peptide to docking_results/2_peptide_25mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab0_CDR-H3_combined.pdb
Initial score: 7374.50
  Found better pose: 6776.90
  Found better pose: 5741.98
  Found better pose: 4870.56
  Found better pose: 4834.81
  Found better pose: 4169.34
  Found better pose: 4069.65
  Found better pose: 3402.08
  Found better pose: 2954.62
  Found better pose: 2921.83
  Found better pose: 2919.13
  Found better pose: 2578.35
  Found better pose: 2458.54
  Found better pose: 2095.91
  Found better pose: 1219.83
  Found better pose: 896.62
  Found better pose: 154.05
  Found better pose: -175.59
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab0_CDR-H2_combined.pdb
Initial score: 19243.98
  Found better pose: 17855.48
  Found better pose: 17083.83
  Found better pose: 15430.83
  Found better pose: 14339.75
  Found better pose: 12705.97
  Found better pose: 12333.09
  Found better pose: 11930.97
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab0_CDR-H1_combined.pdb
Initial score: 23493.40
  Found better pose: 23161.27
  Found better pose: 22562.88
  Found better pose: 22242.82
  Found better pose: 21785.15
  Found better pose: 20731.42
  Found better pose: 16261.01
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab0_CDR-L3_combined.pdb
Initial score: 2769.96
  Found better pose: 963.67
  Found better pose: 823.84
  Found better pose: 784.24
  Found better pose: -0.47
  Found better pose: -154.44
  Found better pose: -269.27
  Found better pose: -398.88
  Found better pose: -402.70
  Found better pose: -404.20
  Found better pose: -404.51
  Found better pose: -404.69
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -404.69
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -584.83, improvement = 180.14
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -341.42, improvement = -63.27
After minimization: energy = -514.30, improvement = 109.61

Complex relaxation cycle 2/25
After repacking: energy = -353.15, improvement = -51.53
After minimization: energy = -497.42, improvement = 92.73

Complex relaxation cycle 3/25
After repacking: energy = -423.69, improvement = 19.01
After minimization: energy = -511.95, improvement = 107.26

Complex relaxation cycle 4/25
After repacking: energy = -439.72, improvement = 35.03
After minimization: energy = -514.32, improvement = 109.64

Complex relaxation cycle 5/25
After repacking: energy = -438.19, improvement = 33.50
After minimization: energy = -510.94, improvement = 106.25

Complex relaxation cycle 6/25
After repacking: energy = -441.29, improvement = 36.61
After minimization: energy = -512.28, improvement = 107.60
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -445.19, improvement = 40.50
After minimization: energy = -511.84, improvement = 107.15

Complex relaxation cycle 8/25
After repacking: energy = -445.52, improvement = 40.83
After minimization: energy = -511.80, improvement = 107.12

Complex relaxation cycle 9/25
After repacking: energy = -444.07, improvement = 39.39
After minimization: energy = -511.88, improvement = 107.19
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -405.01, improvement = 0.32
After minimization: energy = -471.45, improvement = 66.76

Complex relaxation cycle 11/25
After repacking: energy = -402.58, improvement = -2.11
After minimization: energy = -471.96, improvement = 67.28

Complex relaxation cycle 12/25
After repacking: energy = -402.62, improvement = -2.07
After minimization: energy = -472.18, improvement = 67.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -442.79, improvement = 38.10
After minimization: energy = -512.06, improvement = 107.37

Complex relaxation cycle 14/25
After repacking: energy = -442.05, improvement = 37.37
After minimization: energy = -512.71, improvement = 108.03

Complex relaxation cycle 15/25
After repacking: energy = -441.15, improvement = 36.46
After minimization: energy = -512.32, improvement = 107.63
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -443.01, improvement = 38.32
After minimization: energy = -512.35, improvement = 107.66

Complex relaxation cycle 17/25
After repacking: energy = -443.54, improvement = 38.85
After minimization: energy = -509.09, improvement = 104.41

Complex relaxation cycle 18/25
After repacking: energy = -456.00, improvement = 51.32
After minimization: energy = -512.40, improvement = 107.72
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -441.85, improvement = 37.17
After minimization: energy = -512.39, improvement = 107.70

Complex relaxation cycle 20/25
After repacking: energy = -443.18, improvement = 38.49
After minimization: energy = -512.31, improvement = 107.63

Complex relaxation cycle 21/25
After repacking: energy = -442.48, improvement = 37.79
After minimization: energy = -512.24, improvement = 107.56
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -442.67, improvement = 37.98
After minimization: energy = -512.32, improvement = 107.63

Complex relaxation cycle 23/25
After repacking: energy = -442.72, improvement = 38.03
After minimization: energy = -512.36, improvement = 107.67

Complex relaxation cycle 24/25
After repacking: energy = -442.02, improvement = 37.34
After minimization: energy = -512.66, improvement = 107.97
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -443.26, improvement = 38.57
After minimization: energy = -512.09, improvement = 107.40

=== Complex Relaxation Summary ===
Initial energy: -404.69
Final energy: -584.83
Total energy improvement: 180.14 (44.5%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.29 Å
Interface energy: -55.16
Saved relaxed complex structure to docking_results/2_peptide_25mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -584.83
Checking contacts between peptide and CDR-L3...
Found 41 contacts with CDR-L3 (372.7% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -55.16

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab0_CDR-L1_combined.pdb
Initial score: 16801.69
  Found better pose: 14992.16
  Found better pose: 12987.71
  Found better pose: 12225.33
  Found better pose: 11376.96
  Found better pose: 11197.90
  Found better pose: 10694.86
  Found better pose: 7245.27
  Found better pose: 6563.43
  Found better pose: 6345.50
  Found better pose: 6102.57
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 6102.57
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 848.91, improvement = 5253.66
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 4451.78, improvement = 1650.80
After minimization: energy = 929.52, improvement = 5173.05

Complex relaxation cycle 2/25
After repacking: energy = 1041.32, improvement = 5061.26
After minimization: energy = 912.23, improvement = 5190.34

Complex relaxation cycle 3/25
After repacking: energy = 1536.67, improvement = 4565.90
After minimization: energy = 953.81, improvement = 5148.76

Complex relaxation cycle 4/25
After repacking: energy = 1057.30, improvement = 5045.28
After minimization: energy = 929.45, improvement = 5173.12

Complex relaxation cycle 5/25
After repacking: energy = 1058.49, improvement = 5044.08
After minimization: energy = 925.18, improvement = 5177.40

Complex relaxation cycle 6/25
After repacking: energy = 1060.94, improvement = 5041.63
After minimization: energy = 923.68, improvement = 5178.90
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 1063.61, improvement = 5038.97
After minimization: energy = 924.72, improvement = 5177.85

Complex relaxation cycle 8/25
After repacking: energy = 1076.94, improvement = 5025.63
After minimization: energy = 924.55, improvement = 5178.02

Complex relaxation cycle 9/25
After repacking: energy = 1076.57, improvement = 5026.00
After minimization: energy = 925.75, improvement = 5176.83
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 1077.12, improvement = 5025.45
After minimization: energy = 924.42, improvement = 5178.15

Complex relaxation cycle 11/25
After repacking: energy = 1080.03, improvement = 5022.54
After minimization: energy = 924.91, improvement = 5177.66

Complex relaxation cycle 12/25
After repacking: energy = 1116.64, improvement = 4985.93
After minimization: energy = 964.16, improvement = 5138.42
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 1080.18, improvement = 5022.39
After minimization: energy = 924.60, improvement = 5177.98

Complex relaxation cycle 14/25
After repacking: energy = 1080.17, improvement = 5022.41
After minimization: energy = 923.75, improvement = 5178.83

Complex relaxation cycle 15/25
After repacking: energy = 1074.95, improvement = 5027.62
After minimization: energy = 923.43, improvement = 5179.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 1081.69, improvement = 5020.89
After minimization: energy = 925.70, improvement = 5176.88

Complex relaxation cycle 17/25
After repacking: energy = 1078.40, improvement = 5024.18
After minimization: energy = 923.63, improvement = 5178.94

Complex relaxation cycle 18/25
After repacking: energy = 1078.42, improvement = 5024.15
After minimization: energy = 923.66, improvement = 5178.91
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 1080.72, improvement = 5021.85
After minimization: energy = 923.57, improvement = 5179.00

Complex relaxation cycle 20/25
After repacking: energy = 1082.03, improvement = 5020.54
After minimization: energy = 923.59, improvement = 5178.99

Complex relaxation cycle 21/25
After repacking: energy = 1079.00, improvement = 5023.57
After minimization: energy = 923.73, improvement = 5178.84
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 1081.91, improvement = 5020.66
After minimization: energy = 924.68, improvement = 5177.89

Complex relaxation cycle 23/25
After repacking: energy = 1080.59, improvement = 5021.98
After minimization: energy = 923.04, improvement = 5179.54

Complex relaxation cycle 24/25
After repacking: energy = 1075.63, improvement = 5026.95
After minimization: energy = 922.07, improvement = 5180.50
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 1075.50, improvement = 5027.07
After minimization: energy = 922.92, improvement = 5179.65

=== Complex Relaxation Summary ===
Initial energy: 6102.57
Final energy: 848.91
Total energy improvement: 5253.66 (86.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 1.75 Å
Interface energy: 1323.02
Saved relaxed complex structure to docking_results/2_peptide_25mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: 848.91
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 1323.02

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab0_CDR-L2_combined.pdb
Initial score: 8666.60
  Found better pose: 8298.15
  Found better pose: 7323.58
  Found better pose: 6820.25
  Found better pose: 6486.35
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 6486.35
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 4122.36, improvement = 2363.98
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 9048.75, improvement = -2562.41
After minimization: energy = 8863.88, improvement = -2377.54

Complex relaxation cycle 2/25
After repacking: energy = 8989.87, improvement = -2503.52
After minimization: energy = 8871.98, improvement = -2385.63

Complex relaxation cycle 3/25
After repacking: energy = 8945.64, improvement = -2459.29
After minimization: energy = 8878.00, improvement = -2391.66

Complex relaxation cycle 4/25
After repacking: energy = 8914.05, improvement = -2427.70
After minimization: energy = 8875.45, improvement = -2389.11

Complex relaxation cycle 5/25
After repacking: energy = 8915.99, improvement = -2429.64
After minimization: energy = 8871.84, improvement = -2385.50

Complex relaxation cycle 6/25
After repacking: energy = 8923.85, improvement = -2437.51
After minimization: energy = 8882.66, improvement = -2396.31
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 8905.56, improvement = -2419.22
After minimization: energy = 8866.40, improvement = -2380.06

Complex relaxation cycle 8/25
After repacking: energy = 8913.36, improvement = -2427.01
After minimization: energy = 8864.99, improvement = -2378.65

Complex relaxation cycle 9/25
After repacking: energy = 8916.56, improvement = -2430.21
After minimization: energy = 8867.42, improvement = -2381.08
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 8912.37, improvement = -2426.03
After minimization: energy = 8863.62, improvement = -2377.28

Complex relaxation cycle 11/25
After repacking: energy = 8911.61, improvement = -2425.27
After minimization: energy = 8863.12, improvement = -2376.77

Complex relaxation cycle 12/25
After repacking: energy = 8913.23, improvement = -2426.89
After minimization: energy = 8867.28, improvement = -2380.94
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 8910.20, improvement = -2423.85
After minimization: energy = 8868.41, improvement = -2382.07

Complex relaxation cycle 14/25
After repacking: energy = 8943.65, improvement = -2457.31
After minimization: energy = 8904.81, improvement = -2418.47

Complex relaxation cycle 15/25
After repacking: energy = 8925.65, improvement = -2439.31
After minimization: energy = 8875.85, improvement = -2389.50
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 8914.89, improvement = -2428.54
After minimization: energy = 8879.57, improvement = -2393.23

Complex relaxation cycle 17/25
After repacking: energy = 8904.25, improvement = -2417.91
After minimization: energy = 8885.77, improvement = -2399.43

Complex relaxation cycle 18/25
After repacking: energy = 8897.61, improvement = -2411.27
After minimization: energy = 8873.30, improvement = -2386.95
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 8921.68, improvement = -2435.33
After minimization: energy = 8873.62, improvement = -2387.27

Complex relaxation cycle 20/25
After repacking: energy = 8919.08, improvement = -2432.73
After minimization: energy = 8874.44, improvement = -2388.09

Complex relaxation cycle 21/25
After repacking: energy = 8918.64, improvement = -2432.29
After minimization: energy = 8880.35, improvement = -2394.00
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 8905.25, improvement = -2418.91
After minimization: energy = 8878.53, improvement = -2392.18

Complex relaxation cycle 23/25
After repacking: energy = 8904.26, improvement = -2417.91
After minimization: energy = 8870.46, improvement = -2384.11

Complex relaxation cycle 24/25
After repacking: energy = 8907.86, improvement = -2421.51
After minimization: energy = 8873.40, improvement = -2387.06
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 8904.26, improvement = -2417.91
After minimization: energy = 8882.73, improvement = -2396.38

=== Complex Relaxation Summary ===
Initial energy: 6486.35
Final energy: 4122.36
Total energy improvement: 2363.98 (36.4%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.25 Å
Interface energy: 4453.23
Saved relaxed complex structure to docking_results/2_peptide_25mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 4122.36
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 4453.23

Best binding found with CDR-L3, score: -584.83
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -404.68665333226966, 'relaxed_score': -584.8276744194377, 'interface_energy': -55.16207176897444, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 7, 'salt_bridges': 0, 'hydrophobic': 8, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/2_peptide_25mer_Ab0_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/2_peptide_25mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.2062718318678403), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

----- Processing antibody Ab1 with peptide 2_peptide_25mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/2_peptide_25mer_Ab1...
Peptide sequence: TYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVAL
Antibody has 240 residues
Peptide has 25 residues
Saving antibody to docking_results/2_peptide_25mer_Ab1_antibody.pdb
Saving peptide to docking_results/2_peptide_25mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab1_CDR-H3_combined.pdb
Initial score: 21057.64
  Found better pose: 19403.63
  Found better pose: 18415.19
  Found better pose: 17482.13
  Found better pose: 16063.76
  Found better pose: 15878.10
  Found better pose: 15794.01
  Found better pose: 15633.61
  Found better pose: 15202.24
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab1_CDR-H2_combined.pdb
Initial score: 19210.83
  Found better pose: 18763.81
  Found better pose: 18486.80
  Found better pose: 17462.83
  Found better pose: 16919.28
  Found better pose: 16822.10
  Found better pose: 16546.08
  Found better pose: 16460.44
  Found better pose: 16279.04
  Found better pose: 15575.02
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab1_CDR-H1_combined.pdb
Initial score: 25552.52
  Found better pose: 25195.61
  Found better pose: 23849.44
  Found better pose: 22248.37
  Found better pose: 22013.42
  Found better pose: 19767.74
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab1_CDR-L3_combined.pdb
Initial score: -127.76
  Found better pose: -230.07
  Found better pose: -230.24
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -230.24
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -378.05, improvement = 147.81
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 318.71, improvement = -548.95
After minimization: energy = -186.69, improvement = -43.55

Complex relaxation cycle 2/25
After repacking: energy = -120.78, improvement = -109.46
After minimization: energy = -232.38, improvement = 2.14

Complex relaxation cycle 3/25
After repacking: energy = -156.03, improvement = -74.21
After minimization: energy = -246.09, improvement = 15.85

Complex relaxation cycle 4/25
After repacking: energy = 1301.10, improvement = -1531.34
After minimization: energy = -204.03, improvement = -26.21

Complex relaxation cycle 5/25
After repacking: energy = -184.18, improvement = -46.06
After minimization: energy = -245.10, improvement = 14.86

Complex relaxation cycle 6/25
After repacking: energy = -204.84, improvement = -25.40
After minimization: energy = -246.20, improvement = 15.96
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -204.89, improvement = -25.35
After minimization: energy = -250.05, improvement = 19.81

Complex relaxation cycle 8/25
After repacking: energy = -219.44, improvement = -10.80
After minimization: energy = -264.09, improvement = 33.85

Complex relaxation cycle 9/25
After repacking: energy = -208.08, improvement = -22.16
After minimization: energy = -249.05, improvement = 18.81
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -172.82, improvement = -57.42
After minimization: energy = -224.64, improvement = -5.60

Complex relaxation cycle 11/25
After repacking: energy = -208.59, improvement = -21.65
After minimization: energy = -251.37, improvement = 21.13

Complex relaxation cycle 12/25
After repacking: energy = -219.90, improvement = -10.34
After minimization: energy = -264.05, improvement = 33.81
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -181.35, improvement = -48.89
After minimization: energy = -225.37, improvement = -4.87

Complex relaxation cycle 14/25
After repacking: energy = -208.18, improvement = -22.06
After minimization: energy = -252.04, improvement = 21.80

Complex relaxation cycle 15/25
After repacking: energy = -174.29, improvement = -55.95
After minimization: energy = -223.39, improvement = -6.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -207.20, improvement = -23.04
After minimization: energy = -249.69, improvement = 19.45

Complex relaxation cycle 17/25
After repacking: energy = -208.01, improvement = -22.23
After minimization: energy = -250.04, improvement = 19.80

Complex relaxation cycle 18/25
After repacking: energy = -204.10, improvement = -26.14
After minimization: energy = -250.79, improvement = 20.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -217.14, improvement = -13.11
After minimization: energy = -262.04, improvement = 31.80

Complex relaxation cycle 20/25
After repacking: energy = -179.72, improvement = -50.52
After minimization: energy = -222.28, improvement = -7.96

Complex relaxation cycle 21/25
After repacking: energy = -217.68, improvement = -12.56
After minimization: energy = -262.69, improvement = 32.45
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -206.35, improvement = -23.89
After minimization: energy = -248.84, improvement = 18.59

Complex relaxation cycle 23/25
After repacking: energy = -217.24, improvement = -13.00
After minimization: energy = -262.66, improvement = 32.41

Complex relaxation cycle 24/25
After repacking: energy = -217.83, improvement = -12.41
After minimization: energy = -264.85, improvement = 34.61
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -208.25, improvement = -21.99
After minimization: energy = -253.21, improvement = 22.97

=== Complex Relaxation Summary ===
Initial energy: -230.24
Final energy: -378.05
Total energy improvement: 147.81 (64.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.32 Å
Interface energy: -62.07
Saved relaxed complex structure to docking_results/2_peptide_25mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -378.05
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -62.07

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab1_CDR-L1_combined.pdb
Initial score: 9035.91
  Found better pose: 5757.10
  Found better pose: 5518.39
  Found better pose: 5430.10
  Found better pose: 4215.82
  Found better pose: 3439.11
  Found better pose: 3177.74
  Found better pose: 2822.71
  Found better pose: 1397.03
  Found better pose: 702.42
  Found better pose: 672.52
  Found better pose: 343.53
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 343.53
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -121.32, improvement = 464.84
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 901.67, improvement = -558.14
After minimization: energy = 111.26, improvement = 232.27

Complex relaxation cycle 2/25
After repacking: energy = 139.37, improvement = 204.15
After minimization: energy = 19.95, improvement = 323.58

Complex relaxation cycle 3/25
After repacking: energy = 114.22, improvement = 229.31
After minimization: energy = 33.75, improvement = 309.78

Complex relaxation cycle 4/25
After repacking: energy = 77.77, improvement = 265.76
After minimization: energy = 29.28, improvement = 314.25

Complex relaxation cycle 5/25
After repacking: energy = 77.53, improvement = 265.99
After minimization: energy = 28.91, improvement = 314.62

Complex relaxation cycle 6/25
After repacking: energy = 1636.94, improvement = -1293.42
After minimization: energy = 33.78, improvement = 309.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 108.04, improvement = 235.49
After minimization: energy = 33.04, improvement = 310.49

Complex relaxation cycle 8/25
After repacking: energy = 77.84, improvement = 265.69
After minimization: energy = 20.86, improvement = 322.66

Complex relaxation cycle 9/25
After repacking: energy = 143.13, improvement = 200.40
After minimization: energy = 60.00, improvement = 283.53
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 90.05, improvement = 253.48
After minimization: energy = 33.28, improvement = 310.25

Complex relaxation cycle 11/25
After repacking: energy = 97.66, improvement = 245.86
After minimization: energy = 20.64, improvement = 322.89

Complex relaxation cycle 12/25
After repacking: energy = 86.25, improvement = 257.28
After minimization: energy = 34.60, improvement = 308.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 103.33, improvement = 240.20
After minimization: energy = 33.78, improvement = 309.75

Complex relaxation cycle 14/25
After repacking: energy = 82.68, improvement = 260.85
After minimization: energy = 34.52, improvement = 309.01

Complex relaxation cycle 15/25
After repacking: energy = 91.36, improvement = 252.17
After minimization: energy = 21.79, improvement = 321.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 70.56, improvement = 272.96
After minimization: energy = 22.51, improvement = 321.01

Complex relaxation cycle 17/25
After repacking: energy = 130.13, improvement = 213.40
After minimization: energy = 60.55, improvement = 282.97

Complex relaxation cycle 18/25
After repacking: energy = 70.12, improvement = 273.41
After minimization: energy = 22.51, improvement = 321.02
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 110.25, improvement = 233.28
After minimization: energy = 33.02, improvement = 310.50

Complex relaxation cycle 20/25
After repacking: energy = 118.20, improvement = 225.33
After minimization: energy = 29.76, improvement = 313.77

Complex relaxation cycle 21/25
After repacking: energy = 122.91, improvement = 220.61
After minimization: energy = 23.55, improvement = 319.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 94.22, improvement = 249.31
After minimization: energy = 12.84, improvement = 330.69

Complex relaxation cycle 23/25
After repacking: energy = 90.39, improvement = 253.14
After minimization: energy = 12.84, improvement = 330.69

Complex relaxation cycle 24/25
After repacking: energy = 129.29, improvement = 214.23
After minimization: energy = 51.02, improvement = 292.51
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 74.19, improvement = 269.34
After minimization: energy = 23.60, improvement = 319.93

=== Complex Relaxation Summary ===
Initial energy: 343.53
Final energy: -121.32
Total energy improvement: 464.84 (135.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.40 Å
Interface energy: 200.57
Saved relaxed complex structure to docking_results/2_peptide_25mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -121.32
Checking contacts between peptide and CDR-L1...
Found 62 contacts with CDR-L1 (387.5% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 200.57

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-34.51, 53.03, 37.13)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/2_peptide_25mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/2_peptide_25mer_Ab1_CDR-L2_combined.pdb
Initial score: 13822.10
  Found better pose: 11429.53
  Found better pose: 10817.15
  Found better pose: 9950.90
  Found better pose: 8880.44
  Found better pose: 7741.07
  Found better pose: 6901.49
  Found better pose: 6420.88
  Found better pose: 6291.07
  Found better pose: 5385.36
  Found better pose: 5081.75
  Found better pose: 3342.20
  Found better pose: 2259.44
  Found better pose: 1795.64
  Found better pose: 1580.57
  Found better pose: 882.78
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 882.78
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -351.66, improvement = 1234.44
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 1148.19, improvement = -265.41
After minimization: energy = -58.40, improvement = 941.18

Complex relaxation cycle 2/25
After repacking: energy = -25.94, improvement = 908.72
After minimization: energy = -100.16, improvement = 982.94

Complex relaxation cycle 3/25
After repacking: energy = -61.05, improvement = 943.83
After minimization: energy = -102.17, improvement = 984.95

Complex relaxation cycle 4/25
After repacking: energy = -75.07, improvement = 957.85
After minimization: energy = -108.42, improvement = 991.20

Complex relaxation cycle 5/25
After repacking: energy = -74.32, improvement = 957.09
After minimization: energy = -112.72, improvement = 995.50

Complex relaxation cycle 6/25
After repacking: energy = -57.89, improvement = 940.67
After minimization: energy = -143.93, improvement = 1026.71
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -102.37, improvement = 985.15
After minimization: energy = -144.31, improvement = 1027.09

Complex relaxation cycle 8/25
After repacking: energy = -103.17, improvement = 985.95
After minimization: energy = -144.21, improvement = 1026.99

Complex relaxation cycle 9/25
After repacking: energy = -97.98, improvement = 980.76
After minimization: energy = -146.16, improvement = 1028.94
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -109.62, improvement = 992.40
After minimization: energy = -157.30, improvement = 1040.08

Complex relaxation cycle 11/25
After repacking: energy = -114.28, improvement = 997.06
After minimization: energy = -159.48, improvement = 1042.26

Complex relaxation cycle 12/25
After repacking: energy = -116.30, improvement = 999.08
After minimization: energy = -160.07, improvement = 1042.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -105.19, improvement = 987.96
After minimization: energy = -148.31, improvement = 1031.09

Complex relaxation cycle 14/25
After repacking: energy = -117.72, improvement = 1000.50
After minimization: energy = -159.22, improvement = 1042.00

Complex relaxation cycle 15/25
After repacking: energy = -117.38, improvement = 1000.16
After minimization: energy = -160.62, improvement = 1043.40
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -106.10, improvement = 988.88
After minimization: energy = -149.14, improvement = 1031.92

Complex relaxation cycle 17/25
After repacking: energy = -105.73, improvement = 988.50
After minimization: energy = -149.39, improvement = 1032.17

Complex relaxation cycle 18/25
After repacking: energy = -118.96, improvement = 1001.74
After minimization: energy = -162.07, improvement = 1044.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -103.35, improvement = 986.13
After minimization: energy = -151.09, improvement = 1033.86

Complex relaxation cycle 20/25
After repacking: energy = -92.04, improvement = 974.82
After minimization: energy = -132.48, improvement = 1015.25

Complex relaxation cycle 21/25
After repacking: energy = -105.40, improvement = 988.18
After minimization: energy = -150.28, improvement = 1033.06
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -119.70, improvement = 1002.48
After minimization: energy = -162.23, improvement = 1045.01

Complex relaxation cycle 23/25
After repacking: energy = -107.07, improvement = 989.85
After minimization: energy = -150.20, improvement = 1032.98

Complex relaxation cycle 24/25
After repacking: energy = -119.03, improvement = 1001.81
After minimization: energy = -162.01, improvement = 1044.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -102.66, improvement = 985.44
After minimization: energy = -145.77, improvement = 1028.55

=== Complex Relaxation Summary ===
Initial energy: 882.78
Final energy: -351.66
Total energy improvement: 1234.44 (139.8%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.86 Å
Interface energy: -26.26
Saved relaxed complex structure to docking_results/2_peptide_25mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -351.66
Checking contacts between peptide and CDR-L2...
Found 28 contacts with CDR-L2 (350.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 14
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -26.26

Best binding found with CDR-L3, score: -378.05
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -230.24081941683255, 'relaxed_score': -378.0477490465627, 'interface_energy': -62.07002019151497, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 8, 'salt_bridges': 0, 'hydrophobic': 5, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/2_peptide_25mer_Ab1_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/2_peptide_25mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.2062718318678403), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

===== Processing peptide: 5_peptide_15mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/5_peptide_15mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 5_peptide_15mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/5_peptide_15mer_Ab0...
Peptide sequence: PHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLN
Antibody has 232 residues
Peptide has 15 residues
Saving antibody to docking_results/5_peptide_15mer_Ab0_antibody.pdb
Saving peptide to docking_results/5_peptide_15mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab0_CDR-H3_combined.pdb
Initial score: -406.15
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab0_CDR-H2_combined.pdb
Initial score: -392.71
  Found better pose: -401.73
  Found better pose: -401.85
  Found better pose: -402.96
  Found better pose: -403.39
  Found better pose: -403.43
  Found better pose: -403.45
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab0_CDR-H1_combined.pdb
Initial score: 20200.03
  Found better pose: 18916.35
  Found better pose: 16097.87
  Found better pose: 13414.01
  Found better pose: 11634.29
  Found better pose: 9906.34
  Found better pose: 8696.87
  Found better pose: 8111.19
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab0_CDR-L3_combined.pdb
Initial score: 8476.97
  Found better pose: 7728.21
  Found better pose: 6265.54
  Found better pose: 5500.61
  Found better pose: 4635.09
  Found better pose: 3921.50
  Found better pose: 2763.79
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 2763.79
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 368.65, improvement = 2395.14
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 1805.63, improvement = 958.16
After minimization: energy = 604.31, improvement = 2159.48

Complex relaxation cycle 2/25
After repacking: energy = 766.06, improvement = 1997.73
After minimization: energy = 603.17, improvement = 2160.62

Complex relaxation cycle 3/25
After repacking: energy = 696.27, improvement = 2067.52
After minimization: energy = 599.39, improvement = 2164.40

Complex relaxation cycle 4/25
After repacking: energy = 671.61, improvement = 2092.18
After minimization: energy = 597.51, improvement = 2166.28

Complex relaxation cycle 5/25
After repacking: energy = 680.76, improvement = 2083.03
After minimization: energy = 597.10, improvement = 2166.69

Complex relaxation cycle 6/25
After repacking: energy = 694.57, improvement = 2069.22
After minimization: energy = 597.24, improvement = 2166.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 690.42, improvement = 2073.37
After minimization: energy = 596.05, improvement = 2167.74

Complex relaxation cycle 8/25
After repacking: energy = 696.18, improvement = 2067.61
After minimization: energy = 596.87, improvement = 2166.92

Complex relaxation cycle 9/25
After repacking: energy = 697.26, improvement = 2066.53
After minimization: energy = 596.90, improvement = 2166.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 697.09, improvement = 2066.70
After minimization: energy = 596.97, improvement = 2166.82

Complex relaxation cycle 11/25
After repacking: energy = 696.00, improvement = 2067.79
After minimization: energy = 596.96, improvement = 2166.83

Complex relaxation cycle 12/25
After repacking: energy = 695.07, improvement = 2068.72
After minimization: energy = 596.99, improvement = 2166.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 695.02, improvement = 2068.76
After minimization: energy = 597.38, improvement = 2166.41

Complex relaxation cycle 14/25
After repacking: energy = 728.99, improvement = 2034.80
After minimization: energy = 636.32, improvement = 2127.47

Complex relaxation cycle 15/25
After repacking: energy = 694.94, improvement = 2068.85
After minimization: energy = 592.14, improvement = 2171.65
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 688.07, improvement = 2075.72
After minimization: energy = 591.84, improvement = 2171.95

Complex relaxation cycle 17/25
After repacking: energy = 691.52, improvement = 2072.27
After minimization: energy = 589.72, improvement = 2174.07

Complex relaxation cycle 18/25
After repacking: energy = 688.43, improvement = 2075.36
After minimization: energy = 592.25, improvement = 2171.54
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 699.20, improvement = 2064.58
After minimization: energy = 589.44, improvement = 2174.35

Complex relaxation cycle 20/25
After repacking: energy = 690.46, improvement = 2073.33
After minimization: energy = 591.98, improvement = 2171.81

Complex relaxation cycle 21/25
After repacking: energy = 734.45, improvement = 2029.34
After minimization: energy = 629.11, improvement = 2134.68
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 687.44, improvement = 2076.35
After minimization: energy = 592.63, improvement = 2171.16

Complex relaxation cycle 23/25
After repacking: energy = 740.12, improvement = 2023.67
After minimization: energy = 632.11, improvement = 2131.68

Complex relaxation cycle 24/25
After repacking: energy = 698.27, improvement = 2065.52
After minimization: energy = 591.31, improvement = 2172.48
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 688.00, improvement = 2075.79
After minimization: energy = 589.24, improvement = 2174.55

=== Complex Relaxation Summary ===
Initial energy: 2763.79
Final energy: 368.65
Total energy improvement: 2395.14 (86.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.52 Å
Interface energy: 877.52
Saved relaxed complex structure to docking_results/5_peptide_15mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: 368.65
Checking contacts between peptide and CDR-L3...
Found 41 contacts with CDR-L3 (372.7% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: 877.52

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab0_CDR-L1_combined.pdb
Initial score: 2458.34
  Found better pose: 821.71
  Found better pose: 68.30
  Found better pose: -112.15
  Found better pose: -245.78
  Found better pose: -375.65
  Found better pose: -388.38
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -388.38
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -579.22, improvement = 190.84
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -334.40, improvement = -53.98
After minimization: energy = -505.19, improvement = 116.81

Complex relaxation cycle 2/25
After repacking: energy = -359.35, improvement = -29.03
After minimization: energy = -494.51, improvement = 106.13

Complex relaxation cycle 3/25
After repacking: energy = -430.28, improvement = 41.89
After minimization: energy = -498.54, improvement = 110.15

Complex relaxation cycle 4/25
After repacking: energy = -436.37, improvement = 47.98
After minimization: energy = -501.83, improvement = 113.44

Complex relaxation cycle 5/25
After repacking: energy = -422.11, improvement = 33.73
After minimization: energy = -500.25, improvement = 111.87

Complex relaxation cycle 6/25
After repacking: energy = -396.64, improvement = 8.26
After minimization: energy = -462.59, improvement = 74.20
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -434.92, improvement = 46.54
After minimization: energy = -502.08, improvement = 113.69

Complex relaxation cycle 8/25
After repacking: energy = -419.86, improvement = 31.48
After minimization: energy = -500.33, improvement = 111.94

Complex relaxation cycle 9/25
After repacking: energy = -436.59, improvement = 48.21
After minimization: energy = -502.15, improvement = 113.77
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -436.50, improvement = 48.12
After minimization: energy = -504.94, improvement = 116.55

Complex relaxation cycle 11/25
After repacking: energy = -436.32, improvement = 47.93
After minimization: energy = -502.17, improvement = 113.78

Complex relaxation cycle 12/25
After repacking: energy = -434.16, improvement = 45.78
After minimization: energy = -501.40, improvement = 113.02
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -435.07, improvement = 46.68
After minimization: energy = -501.59, improvement = 113.20

Complex relaxation cycle 14/25
After repacking: energy = -419.74, improvement = 31.36
After minimization: energy = -500.96, improvement = 112.58

Complex relaxation cycle 15/25
After repacking: energy = -435.52, improvement = 47.13
After minimization: energy = -502.17, improvement = 113.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -435.17, improvement = 46.79
After minimization: energy = -504.28, improvement = 115.90

Complex relaxation cycle 17/25
After repacking: energy = -435.89, improvement = 47.50
After minimization: energy = -502.24, improvement = 113.86

Complex relaxation cycle 18/25
After repacking: energy = -434.54, improvement = 46.16
After minimization: energy = -501.62, improvement = 113.24
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -434.00, improvement = 45.62
After minimization: energy = -502.27, improvement = 113.88

Complex relaxation cycle 20/25
After repacking: energy = -418.97, improvement = 30.59
After minimization: energy = -500.01, improvement = 111.63

Complex relaxation cycle 21/25
After repacking: energy = -435.27, improvement = 46.89
After minimization: energy = -501.47, improvement = 113.08
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -436.60, improvement = 48.21
After minimization: energy = -504.32, improvement = 115.94

Complex relaxation cycle 23/25
After repacking: energy = -434.72, improvement = 46.34
After minimization: energy = -501.53, improvement = 113.14

Complex relaxation cycle 24/25
After repacking: energy = -434.44, improvement = 46.06
After minimization: energy = -502.26, improvement = 113.88
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -435.11, improvement = 46.72
After minimization: energy = -502.13, improvement = 113.75

=== Complex Relaxation Summary ===
Initial energy: -388.38
Final energy: -579.22
Total energy improvement: 190.84 (49.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.32 Å
Interface energy: -54.09
Saved relaxed complex structure to docking_results/5_peptide_15mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -579.22
Checking contacts between peptide and CDR-L1...
Found 59 contacts with CDR-L1 (368.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -54.09

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab0_CDR-L2_combined.pdb
Initial score: 16383.19
  Found better pose: 13823.62
  Found better pose: 13689.77
  Found better pose: 13643.94
  Found better pose: 13470.27
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 13470.27
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 9158.45, improvement = 4311.82
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 11562.44, improvement = 1907.83
After minimization: energy = 11396.34, improvement = 2073.92

Complex relaxation cycle 2/25
After repacking: energy = 11525.26, improvement = 1945.01
After minimization: energy = 11398.07, improvement = 2072.20

Complex relaxation cycle 3/25
After repacking: energy = 11466.79, improvement = 2003.47
After minimization: energy = 11392.64, improvement = 2077.63

Complex relaxation cycle 4/25
After repacking: energy = 11446.09, improvement = 2024.18
After minimization: energy = 11394.99, improvement = 2075.28

Complex relaxation cycle 5/25
After repacking: energy = 11434.05, improvement = 2036.22
After minimization: energy = 11398.23, improvement = 2072.04

Complex relaxation cycle 6/25
After repacking: energy = 11522.10, improvement = 1948.17
After minimization: energy = 11486.20, improvement = 1984.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 11435.75, improvement = 2034.52
After minimization: energy = 11405.31, improvement = 2064.96

Complex relaxation cycle 8/25
After repacking: energy = 11510.71, improvement = 1959.56
After minimization: energy = 11482.24, improvement = 1988.03

Complex relaxation cycle 9/25
After repacking: energy = 11443.27, improvement = 2027.00
After minimization: energy = 11394.81, improvement = 2075.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 11432.93, improvement = 2037.34
After minimization: energy = 11393.92, improvement = 2076.35

Complex relaxation cycle 11/25
After repacking: energy = 11433.48, improvement = 2036.79
After minimization: energy = 11394.86, improvement = 2075.41

Complex relaxation cycle 12/25
After repacking: energy = 11434.10, improvement = 2036.17
After minimization: energy = 11398.31, improvement = 2071.96
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 11424.99, improvement = 2045.28
After minimization: energy = 11398.97, improvement = 2071.30

Complex relaxation cycle 14/25
After repacking: energy = 11423.53, improvement = 2046.74
After minimization: energy = 11389.26, improvement = 2081.00

Complex relaxation cycle 15/25
After repacking: energy = 11435.75, improvement = 2034.52
After minimization: energy = 11390.65, improvement = 2079.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 11433.97, improvement = 2036.29
After minimization: energy = 11395.17, improvement = 2075.10

Complex relaxation cycle 17/25
After repacking: energy = 11420.49, improvement = 2049.78
After minimization: energy = 11393.58, improvement = 2076.68

Complex relaxation cycle 18/25
After repacking: energy = 11424.21, improvement = 2046.05
After minimization: energy = 11394.04, improvement = 2076.23
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 11422.25, improvement = 2048.02
After minimization: energy = 11403.46, improvement = 2066.81

Complex relaxation cycle 20/25
After repacking: energy = 11413.83, improvement = 2056.44
After minimization: energy = 11393.04, improvement = 2077.23

Complex relaxation cycle 21/25
After repacking: energy = 11425.05, improvement = 2045.21
After minimization: energy = 11403.23, improvement = 2067.03
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 11413.27, improvement = 2057.00
After minimization: energy = 11399.43, improvement = 2070.83

Complex relaxation cycle 23/25
After repacking: energy = 11414.82, improvement = 2055.44
After minimization: energy = 11401.27, improvement = 2069.00

Complex relaxation cycle 24/25
After repacking: energy = 11506.20, improvement = 1964.07
After minimization: energy = 11487.41, improvement = 1982.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 11419.76, improvement = 2050.50
After minimization: energy = 11392.11, improvement = 2078.16

=== Complex Relaxation Summary ===
Initial energy: 13470.27
Final energy: 9158.45
Total energy improvement: 4311.82 (32.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.29 Å
Interface energy: 9635.10
Saved relaxed complex structure to docking_results/5_peptide_15mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 9158.45
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 9635.10

Best binding found with CDR-L1, score: -579.22
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -388.3842321409887, 'relaxed_score': -579.2213179230904, 'interface_energy': -54.09011784401093, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 10, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/5_peptide_15mer_Ab0_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/5_peptide_15mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.16562798160628428), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 5_peptide_15mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/5_peptide_15mer_Ab1...
Peptide sequence: PHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLN
Antibody has 240 residues
Peptide has 15 residues
Saving antibody to docking_results/5_peptide_15mer_Ab1_antibody.pdb
Saving peptide to docking_results/5_peptide_15mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab1_CDR-H3_combined.pdb
Initial score: 20669.78
  Found better pose: 19214.39
  Found better pose: 18565.10
  Found better pose: 17448.85
  Found better pose: 15828.32
  Found better pose: 15704.96
  Found better pose: 15330.25
  Found better pose: 12555.57
  Found better pose: 11780.64
  Found better pose: 11779.83
  Found better pose: 11690.04
  Found better pose: 10172.45
  Found better pose: 9485.91
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab1_CDR-H2_combined.pdb
Initial score: 1559.17
  Found better pose: 630.53
  Found better pose: 464.73
  Found better pose: -96.72
  Found better pose: -212.91
  Found better pose: -225.23
  Found better pose: -226.36
  Found better pose: -227.14
  Found better pose: -227.47
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab1_CDR-H1_combined.pdb
Initial score: 13706.61
  Found better pose: 13654.85
  Found better pose: 12979.73
  Found better pose: 12309.53
  Found better pose: 11806.63
  Found better pose: 11775.59
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab1_CDR-L3_combined.pdb
Initial score: 8534.84
  Found better pose: 7328.23
  Found better pose: 5617.93
  Found better pose: 5375.70
  Found better pose: 4715.27
  Found better pose: 4002.19
  Found better pose: 3268.82
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 3268.82
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 1256.26, improvement = 2012.56
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 3283.69, improvement = -14.87
After minimization: energy = 1823.06, improvement = 1445.76

Complex relaxation cycle 2/25
After repacking: energy = 1758.31, improvement = 1510.51
After minimization: energy = 1683.92, improvement = 1584.90

Complex relaxation cycle 3/25
After repacking: energy = 1725.46, improvement = 1543.36
After minimization: energy = 1681.67, improvement = 1587.16

Complex relaxation cycle 4/25
After repacking: energy = 1737.02, improvement = 1531.81
After minimization: energy = 1691.95, improvement = 1576.87

Complex relaxation cycle 5/25
After repacking: energy = 1729.20, improvement = 1539.62
After minimization: energy = 1694.83, improvement = 1573.99

Complex relaxation cycle 6/25
After repacking: energy = 1721.58, improvement = 1547.24
After minimization: energy = 1691.95, improvement = 1576.87
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 1718.18, improvement = 1550.64
After minimization: energy = 1679.42, improvement = 1589.40

Complex relaxation cycle 8/25
After repacking: energy = 1720.00, improvement = 1548.82
After minimization: energy = 1679.33, improvement = 1589.49

Complex relaxation cycle 9/25
After repacking: energy = 1756.68, improvement = 1512.14
After minimization: energy = 1717.93, improvement = 1550.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 1731.40, improvement = 1537.43
After minimization: energy = 1691.16, improvement = 1577.67

Complex relaxation cycle 11/25
After repacking: energy = 1743.72, improvement = 1525.10
After minimization: energy = 1709.43, improvement = 1559.39

Complex relaxation cycle 12/25
After repacking: energy = 1708.52, improvement = 1560.30
After minimization: energy = 1678.41, improvement = 1590.41
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 1732.81, improvement = 1536.01
After minimization: energy = 1691.15, improvement = 1577.68

Complex relaxation cycle 14/25
After repacking: energy = 1717.02, improvement = 1551.80
After minimization: energy = 1678.89, improvement = 1589.93

Complex relaxation cycle 15/25
After repacking: energy = 1732.54, improvement = 1536.28
After minimization: energy = 1694.42, improvement = 1574.40
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 1709.81, improvement = 1559.01
After minimization: energy = 1683.87, improvement = 1584.95

Complex relaxation cycle 17/25
After repacking: energy = 1720.33, improvement = 1548.49
After minimization: energy = 1690.96, improvement = 1577.86

Complex relaxation cycle 18/25
After repacking: energy = 1725.00, improvement = 1543.83
After minimization: energy = 1685.38, improvement = 1583.44
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 1719.34, improvement = 1549.48
After minimization: energy = 1683.87, improvement = 1584.96

Complex relaxation cycle 20/25
After repacking: energy = 1708.29, improvement = 1560.53
After minimization: energy = 1685.24, improvement = 1583.58

Complex relaxation cycle 21/25
After repacking: energy = 1719.21, improvement = 1549.61
After minimization: energy = 1691.05, improvement = 1577.77
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 1719.16, improvement = 1549.66
After minimization: energy = 1679.43, improvement = 1589.39

Complex relaxation cycle 23/25
After repacking: energy = 1719.07, improvement = 1549.75
After minimization: energy = 1679.61, improvement = 1589.21

Complex relaxation cycle 24/25
After repacking: energy = 1726.99, improvement = 1541.84
After minimization: energy = 1690.79, improvement = 1578.03
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 1746.06, improvement = 1522.76
After minimization: energy = 1705.82, improvement = 1563.00

=== Complex Relaxation Summary ===
Initial energy: 3268.82
Final energy: 1256.26
Total energy improvement: 2012.56 (61.6%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.57 Å
Interface energy: 1566.53
Saved relaxed complex structure to docking_results/5_peptide_15mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: 1256.26
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: 1566.53

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab1_CDR-L1_combined.pdb
Initial score: 7789.72
  Found better pose: 5728.14
  Found better pose: 3676.44
  Found better pose: 2603.40
  Found better pose: 1924.63
  Found better pose: 1901.71
  Found better pose: 1734.38
  Found better pose: 1566.77
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 1566.77
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -205.90, improvement = 1772.67
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 1190.53, improvement = 376.24
After minimization: energy = -85.64, improvement = 1652.41

Complex relaxation cycle 2/25
After repacking: energy = -181.06, improvement = 1747.83
After minimization: energy = -253.49, improvement = 1820.26
Cycle 2 produced the best structure so far

Complex relaxation cycle 3/25
After repacking: energy = -204.59, improvement = 1771.36
After minimization: energy = -260.38, improvement = 1827.15
Cycle 3 produced the best structure so far

Complex relaxation cycle 4/25
After repacking: energy = 362.90, improvement = 1203.87
After minimization: energy = -246.15, improvement = 1812.92

Complex relaxation cycle 5/25
After repacking: energy = -204.35, improvement = 1771.12
After minimization: energy = -261.11, improvement = 1827.88
Cycle 5 produced the best structure so far

Complex relaxation cycle 6/25
After repacking: energy = -214.56, improvement = 1781.33
After minimization: energy = -259.95, improvement = 1826.72
Still seeing improvements (best was cycle 6)

Complex relaxation cycle 7/25
After repacking: energy = -187.58, improvement = 1754.35
After minimization: energy = -234.21, improvement = 1800.98

Complex relaxation cycle 8/25
After repacking: energy = -222.63, improvement = 1789.40
After minimization: energy = -273.81, improvement = 1840.58
Cycle 8 produced the best structure so far

Complex relaxation cycle 9/25
After repacking: energy = -211.72, improvement = 1778.49
After minimization: energy = -261.84, improvement = 1828.61
Still seeing improvements (best was cycle 9)

Complex relaxation cycle 10/25
After repacking: energy = -222.95, improvement = 1789.72
After minimization: energy = -273.05, improvement = 1839.82

Complex relaxation cycle 11/25
After repacking: energy = -184.45, improvement = 1751.22
After minimization: energy = -234.10, improvement = 1800.87

Complex relaxation cycle 12/25
After repacking: energy = -224.51, improvement = 1791.28
After minimization: energy = -272.61, improvement = 1839.38
Still seeing improvements (best was cycle 9)

Complex relaxation cycle 13/25
After repacking: energy = -185.39, improvement = 1752.16
After minimization: energy = -234.31, improvement = 1801.09

Complex relaxation cycle 14/25
After repacking: energy = -212.19, improvement = 1778.96
After minimization: energy = -260.75, improvement = 1827.52

Complex relaxation cycle 15/25
After repacking: energy = -213.16, improvement = 1779.93
After minimization: energy = -260.98, improvement = 1827.75
No improvement in last 3 cycles (best was cycle 9)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -223.84, improvement = 1790.61
After minimization: energy = -272.89, improvement = 1839.66

Complex relaxation cycle 17/25
After repacking: energy = -212.09, improvement = 1778.86
After minimization: energy = -260.98, improvement = 1827.75

Complex relaxation cycle 18/25
After repacking: energy = -223.51, improvement = 1790.29
After minimization: energy = -272.74, improvement = 1839.52
No improvement in last 3 cycles (best was cycle 9)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -212.84, improvement = 1779.61
After minimization: energy = -261.00, improvement = 1827.77

Complex relaxation cycle 20/25
After repacking: energy = -212.25, improvement = 1779.02
After minimization: energy = -261.00, improvement = 1827.77

Complex relaxation cycle 21/25
After repacking: energy = -224.25, improvement = 1791.02
After minimization: energy = -272.98, improvement = 1839.75
No improvement in last 3 cycles (best was cycle 9)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -211.94, improvement = 1778.71
After minimization: energy = -260.88, improvement = 1827.66

Complex relaxation cycle 23/25
After repacking: energy = -223.36, improvement = 1790.13
After minimization: energy = -272.62, improvement = 1839.39

Complex relaxation cycle 24/25
After repacking: energy = -212.03, improvement = 1778.80
After minimization: energy = -260.86, improvement = 1827.63
No improvement in last 3 cycles (best was cycle 9)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -211.70, improvement = 1778.47
After minimization: energy = -260.88, improvement = 1827.65

=== Complex Relaxation Summary ===
Initial energy: 1566.77
Final energy: -273.81
Total energy improvement: 1840.58 (117.5%)
Best structure was from cycle 9
Structure change: CA RMSD = 1.05 Å
Interface energy: -41.76
Saved relaxed complex structure to docking_results/5_peptide_15mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -273.81
Checking contacts between peptide and CDR-L1...
Found 64 contacts with CDR-L1 (400.0% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -41.76

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-47.45, 38.18, 8.56)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/5_peptide_15mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/5_peptide_15mer_Ab1_CDR-L2_combined.pdb
Initial score: 16802.04
  Found better pose: 15389.47
  Found better pose: 15162.42
  Found better pose: 14847.14
  Found better pose: 14812.45
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 14812.45
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 11672.09, improvement = 3140.36
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 17560.32, improvement = -2747.88
After minimization: energy = 17127.76, improvement = -2315.31

Complex relaxation cycle 2/25
After repacking: energy = 17003.43, improvement = -2190.98
After minimization: energy = 16933.29, improvement = -2120.85

Complex relaxation cycle 3/25
After repacking: energy = 16974.05, improvement = -2161.60
After minimization: energy = 16936.28, improvement = -2123.84

Complex relaxation cycle 4/25
After repacking: energy = 16973.99, improvement = -2161.54
After minimization: energy = 16936.96, improvement = -2124.51

Complex relaxation cycle 5/25
After repacking: energy = 16959.98, improvement = -2147.53
After minimization: energy = 16934.84, improvement = -2122.40

Complex relaxation cycle 6/25
After repacking: energy = 16959.90, improvement = -2147.46
After minimization: energy = 16935.88, improvement = -2123.44
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 16979.14, improvement = -2166.70
After minimization: energy = 16958.52, improvement = -2146.08

Complex relaxation cycle 8/25
After repacking: energy = 16952.73, improvement = -2140.29
After minimization: energy = 16934.94, improvement = -2122.49

Complex relaxation cycle 9/25
After repacking: energy = 16954.11, improvement = -2141.66
After minimization: energy = 16926.48, improvement = -2114.04
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 16984.22, improvement = -2171.77
After minimization: energy = 16945.28, improvement = -2132.83

Complex relaxation cycle 11/25
After repacking: energy = 16971.24, improvement = -2158.79
After minimization: energy = 16941.01, improvement = -2128.56

Complex relaxation cycle 12/25
After repacking: energy = 16960.34, improvement = -2147.89
After minimization: energy = 16923.71, improvement = -2111.26
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 16978.81, improvement = -2166.36
After minimization: energy = 16943.77, improvement = -2131.33

Complex relaxation cycle 14/25
After repacking: energy = 16952.30, improvement = -2139.85
After minimization: energy = 16926.16, improvement = -2113.71

Complex relaxation cycle 15/25
After repacking: energy = 16960.41, improvement = -2147.96
After minimization: energy = 16926.07, improvement = -2113.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 16955.48, improvement = -2143.03
After minimization: energy = 16929.72, improvement = -2117.28

Complex relaxation cycle 17/25
After repacking: energy = 16947.99, improvement = -2135.54
After minimization: energy = 16928.40, improvement = -2115.95

Complex relaxation cycle 18/25
After repacking: energy = 16948.57, improvement = -2136.13
After minimization: energy = 16931.20, improvement = -2118.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 16959.45, improvement = -2147.01
After minimization: energy = 16948.05, improvement = -2135.60

Complex relaxation cycle 20/25
After repacking: energy = 16947.58, improvement = -2135.13
After minimization: energy = 16928.67, improvement = -2116.22

Complex relaxation cycle 21/25
After repacking: energy = 16948.25, improvement = -2135.80
After minimization: energy = 16927.23, improvement = -2114.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 16948.68, improvement = -2136.23
After minimization: energy = 16923.86, improvement = -2111.42

Complex relaxation cycle 23/25
After repacking: energy = 16961.40, improvement = -2148.95
After minimization: energy = 16925.75, improvement = -2113.30

Complex relaxation cycle 24/25
After repacking: energy = 16951.69, improvement = -2139.25
After minimization: energy = 16926.42, improvement = -2113.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 16951.42, improvement = -2138.98
After minimization: energy = 16926.77, improvement = -2114.32

=== Complex Relaxation Summary ===
Initial energy: 14812.45
Final energy: 11672.09
Total energy improvement: 3140.36 (21.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.48 Å
Interface energy: 11625.47
Saved relaxed complex structure to docking_results/5_peptide_15mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 11672.09
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 11625.47

Best binding found with CDR-L1, score: -273.81
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': 1566.7708144645844, 'relaxed_score': -273.8091482909707, 'interface_energy': -41.76355007842841, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 10, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/5_peptide_15mer_Ab1_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/5_peptide_15mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.16562798160628428), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 1_peptide_15mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/1_peptide_15mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 1_peptide_15mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/1_peptide_15mer_Ab0...
Peptide sequence: ARGARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLY
Antibody has 232 residues
Peptide has 15 residues
Saving antibody to docking_results/1_peptide_15mer_Ab0_antibody.pdb
Saving peptide to docking_results/1_peptide_15mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab0_CDR-H3_combined.pdb
Initial score: -398.79
  Found better pose: -399.13
  Found better pose: -399.13
  Found better pose: -399.21
  Found better pose: -399.46
  Found better pose: -399.57
  Found better pose: -399.96
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab0_CDR-H2_combined.pdb
Initial score: 198.64
  Found better pose: -31.20
  Found better pose: -76.86
  Found better pose: -380.58
  Found better pose: -394.69
  Found better pose: -397.60
  Found better pose: -398.75
  Found better pose: -399.81
  Found better pose: -400.21
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab0_CDR-H1_combined.pdb
Initial score: 34974.26
  Found better pose: 33495.82
  Found better pose: 30377.56
  Found better pose: 29663.92
  Found better pose: 27276.96
  Found better pose: 26937.46
  Found better pose: 25869.27
  Found better pose: 23070.74
  Found better pose: 22324.15
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab0_CDR-L3_combined.pdb
Initial score: -399.17
  Found better pose: -399.23
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -399.23
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -581.53, improvement = 182.30
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -339.34, improvement = -59.88
After minimization: energy = -511.61, improvement = 112.38

Complex relaxation cycle 2/25
After repacking: energy = -317.89, improvement = -81.33
After minimization: energy = -462.02, improvement = 62.80

Complex relaxation cycle 3/25
After repacking: energy = -437.25, improvement = 38.03
After minimization: energy = -506.96, improvement = 107.73

Complex relaxation cycle 4/25
After repacking: energy = -438.17, improvement = 38.94
After minimization: energy = -503.68, improvement = 104.45

Complex relaxation cycle 5/25
After repacking: energy = -397.42, improvement = -1.80
After minimization: energy = -464.55, improvement = 65.33

Complex relaxation cycle 6/25
After repacking: energy = -437.78, improvement = 38.55
After minimization: energy = -508.92, improvement = 109.69
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -399.91, improvement = 0.69
After minimization: energy = -469.02, improvement = 69.79

Complex relaxation cycle 8/25
After repacking: energy = -440.36, improvement = 41.13
After minimization: energy = -508.82, improvement = 109.59

Complex relaxation cycle 9/25
After repacking: energy = -440.13, improvement = 40.91
After minimization: energy = -508.79, improvement = 109.56
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -440.36, improvement = 41.14
After minimization: energy = -508.90, improvement = 109.67

Complex relaxation cycle 11/25
After repacking: energy = -440.26, improvement = 41.03
After minimization: energy = -508.90, improvement = 109.67

Complex relaxation cycle 12/25
After repacking: energy = -440.42, improvement = 41.20
After minimization: energy = -508.81, improvement = 109.59
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -439.21, improvement = 39.99
After minimization: energy = -508.66, improvement = 109.44

Complex relaxation cycle 14/25
After repacking: energy = -439.48, improvement = 40.26
After minimization: energy = -508.76, improvement = 109.53

Complex relaxation cycle 15/25
After repacking: energy = -434.14, improvement = 34.92
After minimization: energy = -506.92, improvement = 107.69
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -410.05, improvement = 10.83
After minimization: energy = -505.82, improvement = 106.59

Complex relaxation cycle 17/25
After repacking: energy = -440.98, improvement = 41.76
After minimization: energy = -515.17, improvement = 115.94

Complex relaxation cycle 18/25
After repacking: energy = -406.35, improvement = 7.12
After minimization: energy = -503.66, improvement = 104.44
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -443.40, improvement = 44.17
After minimization: energy = -508.13, improvement = 108.91

Complex relaxation cycle 20/25
After repacking: energy = -442.54, improvement = 43.32
After minimization: energy = -508.03, improvement = 108.81

Complex relaxation cycle 21/25
After repacking: energy = -402.26, improvement = 3.03
After minimization: energy = -468.36, improvement = 69.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -441.48, improvement = 42.25
After minimization: energy = -508.13, improvement = 108.90

Complex relaxation cycle 23/25
After repacking: energy = -442.43, improvement = 43.21
After minimization: energy = -508.07, improvement = 108.85

Complex relaxation cycle 24/25
After repacking: energy = -441.48, improvement = 42.25
After minimization: energy = -508.10, improvement = 108.87
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -441.69, improvement = 42.46
After minimization: energy = -508.09, improvement = 108.86

=== Complex Relaxation Summary ===
Initial energy: -399.23
Final energy: -581.53
Total energy improvement: 182.30 (45.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.27 Å
Interface energy: -51.86
Saved relaxed complex structure to docking_results/1_peptide_15mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -581.53
Checking contacts between peptide and CDR-L3...
Found 41 contacts with CDR-L3 (372.7% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -51.86

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab0_CDR-L1_combined.pdb
Initial score: -389.27
  Found better pose: -401.43
  Found better pose: -402.05
  Found better pose: -402.59
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -402.59
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -584.48, improvement = 181.89
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -340.82, improvement = -61.78
After minimization: energy = -513.45, improvement = 110.86

Complex relaxation cycle 2/25
After repacking: energy = -356.80, improvement = -45.79
After minimization: energy = -498.79, improvement = 96.20

Complex relaxation cycle 3/25
After repacking: energy = -442.48, improvement = 39.89
After minimization: energy = -509.18, improvement = 106.59

Complex relaxation cycle 4/25
After repacking: energy = -451.71, improvement = 49.12
After minimization: energy = -509.46, improvement = 106.87

Complex relaxation cycle 5/25
After repacking: energy = -452.78, improvement = 50.19
After minimization: energy = -509.79, improvement = 107.20

Complex relaxation cycle 6/25
After repacking: energy = -449.16, improvement = 46.57
After minimization: energy = -508.96, improvement = 106.37
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -448.91, improvement = 46.32
After minimization: energy = -509.08, improvement = 106.48

Complex relaxation cycle 8/25
After repacking: energy = -448.88, improvement = 46.29
After minimization: energy = -509.92, improvement = 107.33

Complex relaxation cycle 9/25
After repacking: energy = -451.23, improvement = 48.64
After minimization: energy = -510.93, improvement = 108.34
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -448.06, improvement = 45.47
After minimization: energy = -510.95, improvement = 108.36

Complex relaxation cycle 11/25
After repacking: energy = -446.60, improvement = 44.01
After minimization: energy = -510.46, improvement = 107.86

Complex relaxation cycle 12/25
After repacking: energy = -448.37, improvement = 45.78
After minimization: energy = -509.73, improvement = 107.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -448.58, improvement = 45.99
After minimization: energy = -510.48, improvement = 107.89

Complex relaxation cycle 14/25
After repacking: energy = -448.29, improvement = 45.70
After minimization: energy = -509.68, improvement = 107.09

Complex relaxation cycle 15/25
After repacking: energy = -449.07, improvement = 46.48
After minimization: energy = -510.45, improvement = 107.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -448.35, improvement = 45.76
After minimization: energy = -510.44, improvement = 107.85

Complex relaxation cycle 17/25
After repacking: energy = -448.94, improvement = 46.35
After minimization: energy = -510.49, improvement = 107.90

Complex relaxation cycle 18/25
After repacking: energy = -448.67, improvement = 46.08
After minimization: energy = -510.38, improvement = 107.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -448.97, improvement = 46.37
After minimization: energy = -510.49, improvement = 107.90

Complex relaxation cycle 20/25
After repacking: energy = -448.72, improvement = 46.13
After minimization: energy = -510.46, improvement = 107.87

Complex relaxation cycle 21/25
After repacking: energy = -449.47, improvement = 46.87
After minimization: energy = -510.46, improvement = 107.87
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -449.71, improvement = 47.12
After minimization: energy = -510.48, improvement = 107.89

Complex relaxation cycle 23/25
After repacking: energy = -448.78, improvement = 46.19
After minimization: energy = -509.77, improvement = 107.18

Complex relaxation cycle 24/25
After repacking: energy = -448.50, improvement = 45.91
After minimization: energy = -504.64, improvement = 102.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -468.41, improvement = 65.81
After minimization: energy = -510.73, improvement = 108.14

=== Complex Relaxation Summary ===
Initial energy: -402.59
Final energy: -584.48
Total energy improvement: 181.89 (45.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.26 Å
Interface energy: -54.89
Saved relaxed complex structure to docking_results/1_peptide_15mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -584.48
Checking contacts between peptide and CDR-L1...
Found 59 contacts with CDR-L1 (368.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -54.89

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab0_CDR-L2_combined.pdb
Initial score: 7713.76
  Found better pose: 5522.55
  Found better pose: 3519.39
  Found better pose: 3350.14
  Found better pose: 1572.28
  Found better pose: 681.01
  Found better pose: 223.41
  Found better pose: -322.93
  Found better pose: -390.04
  Found better pose: -397.28
  Found better pose: -398.30
  Found better pose: -398.69
  Found better pose: -398.86
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -398.86
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -578.82, improvement = 179.96
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -338.00, improvement = -60.86
After minimization: energy = -511.52, improvement = 112.67

Complex relaxation cycle 2/25
After repacking: energy = -343.78, improvement = -55.08
After minimization: energy = -494.90, improvement = 96.05

Complex relaxation cycle 3/25
After repacking: energy = -388.85, improvement = -10.01
After minimization: energy = -471.49, improvement = 72.64

Complex relaxation cycle 4/25
After repacking: energy = -438.44, improvement = 39.58
After minimization: energy = -511.02, improvement = 112.17

Complex relaxation cycle 5/25
After repacking: energy = -437.63, improvement = 38.78
After minimization: energy = -507.73, improvement = 108.88

Complex relaxation cycle 6/25
After repacking: energy = -438.39, improvement = 39.53
After minimization: energy = -507.66, improvement = 108.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -440.28, improvement = 41.43
After minimization: energy = -507.84, improvement = 108.98

Complex relaxation cycle 8/25
After repacking: energy = -440.32, improvement = 41.46
After minimization: energy = -507.87, improvement = 109.01

Complex relaxation cycle 9/25
After repacking: energy = -440.61, improvement = 41.75
After minimization: energy = -508.15, improvement = 109.30
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -441.08, improvement = 42.22
After minimization: energy = -509.58, improvement = 110.72

Complex relaxation cycle 11/25
After repacking: energy = -439.19, improvement = 40.34
After minimization: energy = -508.87, improvement = 110.02

Complex relaxation cycle 12/25
After repacking: energy = -438.25, improvement = 39.40
After minimization: energy = -509.54, improvement = 110.68
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -439.78, improvement = 40.93
After minimization: energy = -509.49, improvement = 110.63

Complex relaxation cycle 14/25
After repacking: energy = -439.38, improvement = 40.52
After minimization: energy = -509.51, improvement = 110.65

Complex relaxation cycle 15/25
After repacking: energy = -438.56, improvement = 39.71
After minimization: energy = -508.84, improvement = 109.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -438.56, improvement = 39.70
After minimization: energy = -509.48, improvement = 110.63

Complex relaxation cycle 17/25
After repacking: energy = -439.50, improvement = 40.64
After minimization: energy = -509.46, improvement = 110.61

Complex relaxation cycle 18/25
After repacking: energy = -439.64, improvement = 40.78
After minimization: energy = -508.84, improvement = 109.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -438.23, improvement = 39.37
After minimization: energy = -509.56, improvement = 110.70

Complex relaxation cycle 20/25
After repacking: energy = -438.93, improvement = 40.07
After minimization: energy = -509.56, improvement = 110.70

Complex relaxation cycle 21/25
After repacking: energy = -397.82, improvement = -1.04
After minimization: energy = -469.78, improvement = 70.92
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -437.82, improvement = 38.96
After minimization: energy = -509.74, improvement = 110.89

Complex relaxation cycle 23/25
After repacking: energy = -438.12, improvement = 39.26
After minimization: energy = -508.92, improvement = 110.06

Complex relaxation cycle 24/25
After repacking: energy = -437.82, improvement = 38.96
After minimization: energy = -508.62, improvement = 109.76
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -438.87, improvement = 40.01
After minimization: energy = -509.72, improvement = 110.86

=== Complex Relaxation Summary ===
Initial energy: -398.86
Final energy: -578.82
Total energy improvement: 179.96 (45.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.29 Å
Interface energy: -51.59
Saved relaxed complex structure to docking_results/1_peptide_15mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -578.82
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -51.59

Best binding found with CDR-L1, score: -584.48
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -402.59215259366925, 'relaxed_score': -584.4824910220563, 'interface_energy': -54.89159904162409, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 10, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/1_peptide_15mer_Ab0_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/1_peptide_15mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 1_peptide_15mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/1_peptide_15mer_Ab1...
Peptide sequence: ARGARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLY
Antibody has 240 residues
Peptide has 15 residues
Saving antibody to docking_results/1_peptide_15mer_Ab1_antibody.pdb
Saving peptide to docking_results/1_peptide_15mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab1_CDR-H3_combined.pdb
Initial score: 14481.11
  Found better pose: 11096.17
  Found better pose: 10449.06
  Found better pose: 8502.11
  Found better pose: 5154.12
  Found better pose: 4726.71
  Found better pose: 2910.92
  Found better pose: 951.83
  Found better pose: 715.39
  Found better pose: 275.58
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab1_CDR-H2_combined.pdb
Initial score: 26.99
  Found better pose: -213.99
  Found better pose: -222.87
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab1_CDR-H1_combined.pdb
Initial score: 34529.20
  Found better pose: 34077.66
  Found better pose: 32356.00
  Found better pose: 32243.59
  Found better pose: 30749.49
  Found better pose: 30081.09
  Found better pose: 28781.05
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab1_CDR-L3_combined.pdb
Initial score: -221.06
  Found better pose: -221.10
  Found better pose: -221.15
  Found better pose: -221.24
  Found better pose: -221.25
  Found better pose: -221.34
  Found better pose: -222.19
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -222.19
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -386.57, improvement = 164.38
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 399.57, improvement = -621.76
After minimization: energy = -72.12, improvement = -150.07

Complex relaxation cycle 2/25
After repacking: energy = -168.07, improvement = -54.12
After minimization: energy = -238.86, improvement = 16.67

Complex relaxation cycle 3/25
After repacking: energy = -207.89, improvement = -14.30
After minimization: energy = -256.02, improvement = 33.83

Complex relaxation cycle 4/25
After repacking: energy = -208.49, improvement = -13.70
After minimization: energy = -256.07, improvement = 33.88

Complex relaxation cycle 5/25
After repacking: energy = -219.40, improvement = -2.79
After minimization: energy = -268.61, improvement = 46.42

Complex relaxation cycle 6/25
After repacking: energy = -193.66, improvement = -28.53
After minimization: energy = -241.85, improvement = 19.66
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -220.48, improvement = -1.71
After minimization: energy = -268.49, improvement = 46.29

Complex relaxation cycle 8/25
After repacking: energy = -207.85, improvement = -14.35
After minimization: energy = -256.23, improvement = 34.04

Complex relaxation cycle 9/25
After repacking: energy = -208.34, improvement = -13.85
After minimization: energy = -256.52, improvement = 34.33
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -208.33, improvement = -13.86
After minimization: energy = -256.52, improvement = 34.32

Complex relaxation cycle 11/25
After repacking: energy = -220.32, improvement = -1.87
After minimization: energy = -268.47, improvement = 46.28

Complex relaxation cycle 12/25
After repacking: energy = -220.40, improvement = -1.79
After minimization: energy = -264.66, improvement = 42.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -220.76, improvement = -1.43
After minimization: energy = -268.45, improvement = 46.26

Complex relaxation cycle 14/25
After repacking: energy = -208.03, improvement = -14.16
After minimization: energy = -256.51, improvement = 34.31

Complex relaxation cycle 15/25
After repacking: energy = -208.20, improvement = -13.99
After minimization: energy = -256.50, improvement = 34.31
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -220.44, improvement = -1.75
After minimization: energy = -264.73, improvement = 42.54

Complex relaxation cycle 17/25
After repacking: energy = -220.77, improvement = -1.43
After minimization: energy = -268.47, improvement = 46.28

Complex relaxation cycle 18/25
After repacking: energy = -220.27, improvement = -1.92
After minimization: energy = -264.78, improvement = 42.59
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -220.82, improvement = -1.37
After minimization: energy = -268.48, improvement = 46.28

Complex relaxation cycle 20/25
After repacking: energy = -207.96, improvement = -14.24
After minimization: energy = -256.29, improvement = 34.10

Complex relaxation cycle 21/25
After repacking: energy = -208.14, improvement = -14.05
After minimization: energy = -256.51, improvement = 34.32
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -207.77, improvement = -14.42
After minimization: energy = -256.27, improvement = 34.08

Complex relaxation cycle 23/25
After repacking: energy = -220.55, improvement = -1.64
After minimization: energy = -268.51, improvement = 46.32

Complex relaxation cycle 24/25
After repacking: energy = -193.71, improvement = -28.48
After minimization: energy = -241.82, improvement = 19.63
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -208.33, improvement = -13.86
After minimization: energy = -256.52, improvement = 34.32

=== Complex Relaxation Summary ===
Initial energy: -222.19
Final energy: -386.57
Total energy improvement: 164.38 (74.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.43 Å
Interface energy: -52.22
Saved relaxed complex structure to docking_results/1_peptide_15mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -386.57
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -52.22

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab1_CDR-L1_combined.pdb
Initial score: 1457.87
  Found better pose: 1273.32
  Found better pose: 1023.90
  Found better pose: 324.66
  Found better pose: 181.81
  Found better pose: 40.55
  Found better pose: -144.38
  Found better pose: -219.86
  Found better pose: -226.16
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -226.16
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -382.46, improvement = 156.30
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 332.38, improvement = -558.54
After minimization: energy = -172.41, improvement = -53.75

Complex relaxation cycle 2/25
After repacking: energy = -187.37, improvement = -38.79
After minimization: energy = -251.95, improvement = 25.79

Complex relaxation cycle 3/25
After repacking: energy = -212.43, improvement = -13.73
After minimization: energy = -269.62, improvement = 43.46

Complex relaxation cycle 4/25
After repacking: energy = -217.29, improvement = -8.87
After minimization: energy = -268.10, improvement = 41.94

Complex relaxation cycle 5/25
After repacking: energy = -181.16, improvement = -45.00
After minimization: energy = -229.45, improvement = 3.29

Complex relaxation cycle 6/25
After repacking: energy = -207.20, improvement = -18.96
After minimization: energy = -256.09, improvement = 29.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -219.46, improvement = -6.70
After minimization: energy = -268.10, improvement = 41.94

Complex relaxation cycle 8/25
After repacking: energy = -219.69, improvement = -6.47
After minimization: energy = -268.63, improvement = 42.47

Complex relaxation cycle 9/25
After repacking: energy = -219.51, improvement = -6.65
After minimization: energy = -260.82, improvement = 34.66
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -226.81, improvement = 0.65
After minimization: energy = -253.31, improvement = 27.14

Complex relaxation cycle 11/25
After repacking: energy = -236.40, improvement = 10.23
After minimization: energy = -268.39, improvement = 42.23

Complex relaxation cycle 12/25
After repacking: energy = -179.71, improvement = -46.45
After minimization: energy = -229.95, improvement = 3.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -206.35, improvement = -19.81
After minimization: energy = -256.29, improvement = 30.13

Complex relaxation cycle 14/25
After repacking: energy = -218.15, improvement = -8.01
After minimization: energy = -268.10, improvement = 41.93

Complex relaxation cycle 15/25
After repacking: energy = -207.05, improvement = -19.11
After minimization: energy = -256.60, improvement = 30.44
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -206.33, improvement = -19.83
After minimization: energy = -256.32, improvement = 30.16

Complex relaxation cycle 17/25
After repacking: energy = -217.89, improvement = -8.27
After minimization: energy = -268.58, improvement = 42.42

Complex relaxation cycle 18/25
After repacking: energy = -205.76, improvement = -20.40
After minimization: energy = -254.87, improvement = 28.71
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -180.23, improvement = -45.93
After minimization: energy = -229.47, improvement = 3.31

Complex relaxation cycle 20/25
After repacking: energy = -206.16, improvement = -20.01
After minimization: energy = -256.64, improvement = 30.48

Complex relaxation cycle 21/25
After repacking: energy = -205.91, improvement = -20.25
After minimization: energy = -255.69, improvement = 29.53
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -220.23, improvement = -5.93
After minimization: energy = -268.58, improvement = 42.42

Complex relaxation cycle 23/25
After repacking: energy = -207.08, improvement = -19.08
After minimization: energy = -256.54, improvement = 30.38

Complex relaxation cycle 24/25
After repacking: energy = -207.05, improvement = -19.11
After minimization: energy = -256.30, improvement = 30.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -188.41, improvement = -37.75
After minimization: energy = -239.90, improvement = 13.73

=== Complex Relaxation Summary ===
Initial energy: -226.16
Final energy: -382.46
Total energy improvement: 156.30 (69.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.46 Å
Interface energy: -57.39
Saved relaxed complex structure to docking_results/1_peptide_15mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -382.46
Checking contacts between peptide and CDR-L1...
Found 64 contacts with CDR-L1 (400.0% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -57.39

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-24.04, 12.02, 17.70)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/1_peptide_15mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/1_peptide_15mer_Ab1_CDR-L2_combined.pdb
Initial score: 26677.44
  Found better pose: 21711.51
  Found better pose: 19547.24
  Found better pose: 17165.15
  Found better pose: 11095.25
  Found better pose: 10230.08
  Found better pose: 9547.92
  Found better pose: 5914.88
  Found better pose: 5832.89
  Found better pose: 5780.41
  Found better pose: 5015.95
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 5015.95
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 2340.62, improvement = 2675.33
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 3119.54, improvement = 1896.41
After minimization: energy = 2609.96, improvement = 2406.00

Complex relaxation cycle 2/25
After repacking: energy = 2635.02, improvement = 2380.94
After minimization: energy = 2540.91, improvement = 2475.05

Complex relaxation cycle 3/25
After repacking: energy = 3135.20, improvement = 1880.75
After minimization: energy = 2540.24, improvement = 2475.71

Complex relaxation cycle 4/25
After repacking: energy = 4139.88, improvement = 876.07
After minimization: energy = 2574.28, improvement = 2441.67

Complex relaxation cycle 5/25
After repacking: energy = 2573.74, improvement = 2442.22
After minimization: energy = 2539.58, improvement = 2476.38

Complex relaxation cycle 6/25
After repacking: energy = 2592.31, improvement = 2423.64
After minimization: energy = 2568.19, improvement = 2447.77
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 2563.44, improvement = 2452.52
After minimization: energy = 2536.92, improvement = 2479.04

Complex relaxation cycle 8/25
After repacking: energy = 2593.05, improvement = 2422.91
After minimization: energy = 2563.31, improvement = 2452.65

Complex relaxation cycle 9/25
After repacking: energy = 2579.12, improvement = 2436.84
After minimization: energy = 2554.78, improvement = 2461.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 2574.20, improvement = 2441.75
After minimization: energy = 2549.18, improvement = 2466.78

Complex relaxation cycle 11/25
After repacking: energy = 2572.89, improvement = 2443.06
After minimization: energy = 2542.75, improvement = 2473.20

Complex relaxation cycle 12/25
After repacking: energy = 2566.17, improvement = 2449.79
After minimization: energy = 2537.33, improvement = 2478.63
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 2577.29, improvement = 2438.67
After minimization: energy = 2548.81, improvement = 2467.15

Complex relaxation cycle 14/25
After repacking: energy = 2580.71, improvement = 2435.25
After minimization: energy = 2549.11, improvement = 2466.84

Complex relaxation cycle 15/25
After repacking: energy = 2568.38, improvement = 2447.58
After minimization: energy = 2537.04, improvement = 2478.92
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 2593.82, improvement = 2422.14
After minimization: energy = 2568.01, improvement = 2447.95

Complex relaxation cycle 17/25
After repacking: energy = 2562.40, improvement = 2453.55
After minimization: energy = 2536.41, improvement = 2479.54

Complex relaxation cycle 18/25
After repacking: energy = 2576.35, improvement = 2439.60
After minimization: energy = 2551.59, improvement = 2464.36
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 2588.21, improvement = 2427.74
After minimization: energy = 2570.51, improvement = 2445.44

Complex relaxation cycle 20/25
After repacking: energy = 2571.54, improvement = 2444.41
After minimization: energy = 2548.03, improvement = 2467.93

Complex relaxation cycle 21/25
After repacking: energy = 2568.27, improvement = 2447.68
After minimization: energy = 2535.32, improvement = 2480.63
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 2604.38, improvement = 2411.58
After minimization: energy = 2573.76, improvement = 2442.19

Complex relaxation cycle 23/25
After repacking: energy = 2576.90, improvement = 2439.06
After minimization: energy = 2556.78, improvement = 2459.17

Complex relaxation cycle 24/25
After repacking: energy = 2570.97, improvement = 2444.98
After minimization: energy = 2547.67, improvement = 2468.29
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 2565.34, improvement = 2450.62
After minimization: energy = 2534.84, improvement = 2481.11

=== Complex Relaxation Summary ===
Initial energy: 5015.95
Final energy: 2340.62
Total energy improvement: 2675.33 (53.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.47 Å
Interface energy: 2651.28
Saved relaxed complex structure to docking_results/1_peptide_15mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 2340.62
Checking contacts between peptide and CDR-L2...
Found 28 contacts with CDR-L2 (350.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 2651.28

Best binding found with CDR-L3, score: -386.57
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -222.19159393067974, 'relaxed_score': -386.5709141323383, 'interface_energy': -52.21943944115861, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 8, 'salt_bridges': 0, 'hydrophobic': 5, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/1_peptide_15mer_Ab1_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/1_peptide_15mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 3_peptide_25mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/3_peptide_25mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 3_peptide_25mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/3_peptide_25mer_Ab0...
Peptide sequence: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSER
Antibody has 232 residues
Peptide has 25 residues
Saving antibody to docking_results/3_peptide_25mer_Ab0_antibody.pdb
Saving peptide to docking_results/3_peptide_25mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab0_CDR-H3_combined.pdb
Initial score: -405.83
  Found better pose: -405.91
  Found better pose: -405.92
  Found better pose: -405.92
  Found better pose: -405.92
  Found better pose: -405.93
  Found better pose: -405.94
  Found better pose: -405.97
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab0_CDR-H2_combined.pdb
Initial score: 13080.05
  Found better pose: 10660.48
  Found better pose: 10284.66
  Found better pose: 10235.85
  Found better pose: 7022.12
  Found better pose: 4305.71
  Found better pose: 4174.42
  Found better pose: 4058.30
  Found better pose: 3870.38
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab0_CDR-H1_combined.pdb
Initial score: 41962.26
  Found better pose: 41860.26
  Found better pose: 38886.92
  Found better pose: 35745.56
  Found better pose: 32954.24
  Found better pose: 30922.11
  Found better pose: 30196.19
  Found better pose: 29919.13
  Found better pose: 29483.20
  Found better pose: 26309.52
  Found better pose: 25215.59
  Found better pose: 24829.83
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab0_CDR-L3_combined.pdb
Initial score: 10845.28
  Found better pose: 9249.79
  Found better pose: 8869.25
  Found better pose: 8459.52
  Found better pose: 6905.80
  Found better pose: 6802.12
  Found better pose: 6800.70
  Found better pose: 6616.14
  Found better pose: 5602.39
  Found better pose: 5406.44
  Found better pose: 4828.92
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 4828.92
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 3810.96, improvement = 1017.96
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 4613.08, improvement = 215.84
After minimization: energy = 4445.93, improvement = 382.98

Complex relaxation cycle 2/25
After repacking: energy = 4580.29, improvement = 248.62
After minimization: energy = 4454.88, improvement = 374.04

Complex relaxation cycle 3/25
After repacking: energy = 4527.07, improvement = 301.84
After minimization: energy = 4458.14, improvement = 370.78

Complex relaxation cycle 4/25
After repacking: energy = 4503.25, improvement = 325.67
After minimization: energy = 4449.70, improvement = 379.22

Complex relaxation cycle 5/25
After repacking: energy = 4510.64, improvement = 318.28
After minimization: energy = 4450.09, improvement = 378.83

Complex relaxation cycle 6/25
After repacking: energy = 4503.12, improvement = 325.79
After minimization: energy = 4450.16, improvement = 378.76
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 4504.07, improvement = 324.84
After minimization: energy = 4452.82, improvement = 376.10

Complex relaxation cycle 8/25
After repacking: energy = 4490.86, improvement = 338.06
After minimization: energy = 4452.28, improvement = 376.64

Complex relaxation cycle 9/25
After repacking: energy = 4495.60, improvement = 333.32
After minimization: energy = 4451.95, improvement = 376.97
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 4491.84, improvement = 337.07
After minimization: energy = 4448.89, improvement = 380.02

Complex relaxation cycle 11/25
After repacking: energy = 4501.33, improvement = 327.59
After minimization: energy = 4448.81, improvement = 380.11

Complex relaxation cycle 12/25
After repacking: energy = 4499.88, improvement = 329.04
After minimization: energy = 4449.47, improvement = 379.44
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 4499.52, improvement = 329.39
After minimization: energy = 4449.45, improvement = 379.46

Complex relaxation cycle 14/25
After repacking: energy = 4501.05, improvement = 327.87
After minimization: energy = 4449.48, improvement = 379.44

Complex relaxation cycle 15/25
After repacking: energy = 4540.28, improvement = 288.64
After minimization: energy = 4489.16, improvement = 339.76
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 4500.06, improvement = 328.86
After minimization: energy = 4452.92, improvement = 376.00

Complex relaxation cycle 17/25
After repacking: energy = 4487.10, improvement = 341.82
After minimization: energy = 4448.62, improvement = 380.29

Complex relaxation cycle 18/25
After repacking: energy = 4504.33, improvement = 324.59
After minimization: energy = 4449.27, improvement = 379.64
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 4501.60, improvement = 327.32
After minimization: energy = 4448.89, improvement = 380.03

Complex relaxation cycle 20/25
After repacking: energy = 4501.72, improvement = 327.19
After minimization: energy = 4448.76, improvement = 380.16

Complex relaxation cycle 21/25
After repacking: energy = 4504.09, improvement = 324.83
After minimization: energy = 4455.28, improvement = 373.63
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 4488.41, improvement = 340.51
After minimization: energy = 4453.27, improvement = 375.65

Complex relaxation cycle 23/25
After repacking: energy = 4493.04, improvement = 335.88
After minimization: energy = 4450.51, improvement = 378.41

Complex relaxation cycle 24/25
After repacking: energy = 4501.98, improvement = 326.94
After minimization: energy = 4449.51, improvement = 379.41
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 4504.23, improvement = 324.69
After minimization: energy = 4449.73, improvement = 379.19

=== Complex Relaxation Summary ===
Initial energy: 4828.92
Final energy: 3810.96
Total energy improvement: 1017.96 (21.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.26 Å
Interface energy: 4185.19
Saved relaxed complex structure to docking_results/3_peptide_25mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: 3810.96
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: 4185.19

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab0_CDR-L1_combined.pdb
Initial score: 295.72
  Found better pose: -70.48
  Found better pose: -262.98
  Found better pose: -388.83
  Found better pose: -404.41
  Found better pose: -405.31
  Found better pose: -406.44
  Found better pose: -406.83
  Found better pose: -406.94
  Found better pose: -407.37
  Found better pose: -407.69
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -407.69
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -588.33, improvement = 180.64
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -343.29, improvement = -64.39
After minimization: energy = -514.84, improvement = 107.15

Complex relaxation cycle 2/25
After repacking: energy = -353.96, improvement = -53.73
After minimization: energy = -504.39, improvement = 96.70

Complex relaxation cycle 3/25
After repacking: energy = -441.07, improvement = 33.39
After minimization: energy = -518.18, improvement = 110.49

Complex relaxation cycle 4/25
After repacking: energy = -372.19, improvement = -35.49
After minimization: energy = -500.06, improvement = 92.37

Complex relaxation cycle 5/25
After repacking: energy = -446.59, improvement = 38.90
After minimization: energy = -505.11, improvement = 97.43

Complex relaxation cycle 6/25
After repacking: energy = -446.37, improvement = 38.68
After minimization: energy = -505.42, improvement = 97.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -441.10, improvement = 33.41
After minimization: energy = -505.92, improvement = 98.24

Complex relaxation cycle 8/25
After repacking: energy = -446.44, improvement = 38.76
After minimization: energy = -504.46, improvement = 96.77

Complex relaxation cycle 9/25
After repacking: energy = -447.01, improvement = 39.33
After minimization: energy = -504.51, improvement = 96.82
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -446.58, improvement = 38.89
After minimization: energy = -504.47, improvement = 96.78

Complex relaxation cycle 11/25
After repacking: energy = -446.33, improvement = 38.65
After minimization: energy = -505.55, improvement = 97.87

Complex relaxation cycle 12/25
After repacking: energy = -448.63, improvement = 40.94
After minimization: energy = -505.55, improvement = 97.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -448.68, improvement = 40.99
After minimization: energy = -505.55, improvement = 97.86

Complex relaxation cycle 14/25
After repacking: energy = -448.74, improvement = 41.06
After minimization: energy = -505.51, improvement = 97.82

Complex relaxation cycle 15/25
After repacking: energy = -448.81, improvement = 41.13
After minimization: energy = -509.70, improvement = 102.01
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -452.06, improvement = 44.37
After minimization: energy = -509.40, improvement = 101.71

Complex relaxation cycle 17/25
After repacking: energy = -451.58, improvement = 43.89
After minimization: energy = -511.46, improvement = 103.78

Complex relaxation cycle 18/25
After repacking: energy = -451.41, improvement = 43.72
After minimization: energy = -515.53, improvement = 107.84
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -446.95, improvement = 39.26
After minimization: energy = -515.60, improvement = 107.92

Complex relaxation cycle 20/25
After repacking: energy = -406.59, improvement = -1.10
After minimization: energy = -475.79, improvement = 68.10

Complex relaxation cycle 21/25
After repacking: energy = -445.64, improvement = 37.96
After minimization: energy = -515.46, improvement = 107.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -446.28, improvement = 38.60
After minimization: energy = -515.57, improvement = 107.88

Complex relaxation cycle 23/25
After repacking: energy = -445.39, improvement = 37.71
After minimization: energy = -515.51, improvement = 107.83

Complex relaxation cycle 24/25
After repacking: energy = -446.07, improvement = 38.39
After minimization: energy = -515.24, improvement = 107.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -447.05, improvement = 39.36
After minimization: energy = -515.34, improvement = 107.65

=== Complex Relaxation Summary ===
Initial energy: -407.69
Final energy: -588.33
Total energy improvement: 180.64 (44.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.26 Å
Interface energy: -57.21
Saved relaxed complex structure to docking_results/3_peptide_25mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -588.33
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -57.21

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab0_CDR-L2_combined.pdb
Initial score: 149.63
  Found better pose: -310.47
  Found better pose: -352.35
  Found better pose: -403.62
  Found better pose: -405.55
  Found better pose: -406.07
  Found better pose: -406.29
  Found better pose: -406.52
  Found better pose: -406.53
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -406.53
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -586.15, improvement = 179.61
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -344.01, improvement = -62.52
After minimization: energy = -516.33, improvement = 109.79

Complex relaxation cycle 2/25
After repacking: energy = -320.92, improvement = -85.62
After minimization: energy = -465.71, improvement = 59.18

Complex relaxation cycle 3/25
After repacking: energy = -444.66, improvement = 38.13
After minimization: energy = -515.66, improvement = 109.12

Complex relaxation cycle 4/25
After repacking: energy = -447.80, improvement = 41.27
After minimization: energy = -513.01, improvement = 106.48

Complex relaxation cycle 5/25
After repacking: energy = -446.02, improvement = 39.49
After minimization: energy = -512.75, improvement = 106.21

Complex relaxation cycle 6/25
After repacking: energy = -442.89, improvement = 36.35
After minimization: energy = -512.68, improvement = 106.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -443.61, improvement = 37.08
After minimization: energy = -512.79, improvement = 106.25

Complex relaxation cycle 8/25
After repacking: energy = -443.36, improvement = 36.83
After minimization: energy = -512.73, improvement = 106.19

Complex relaxation cycle 9/25
After repacking: energy = -403.41, improvement = -3.13
After minimization: energy = -473.07, improvement = 66.53
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -443.11, improvement = 36.58
After minimization: energy = -512.64, improvement = 106.11

Complex relaxation cycle 11/25
After repacking: energy = -442.62, improvement = 36.09
After minimization: energy = -512.62, improvement = 106.09

Complex relaxation cycle 12/25
After repacking: energy = -443.11, improvement = 36.58
After minimization: energy = -511.64, improvement = 105.11
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -443.07, improvement = 36.54
After minimization: energy = -512.75, improvement = 106.21

Complex relaxation cycle 14/25
After repacking: energy = -441.77, improvement = 35.24
After minimization: energy = -512.82, improvement = 106.28

Complex relaxation cycle 15/25
After repacking: energy = -442.79, improvement = 36.26
After minimization: energy = -512.87, improvement = 106.33
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -401.56, improvement = -4.97
After minimization: energy = -473.51, improvement = 66.97

Complex relaxation cycle 17/25
After repacking: energy = -442.45, improvement = 35.92
After minimization: energy = -513.12, improvement = 106.59

Complex relaxation cycle 18/25
After repacking: energy = -443.28, improvement = 36.75
After minimization: energy = -513.18, improvement = 106.65
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -443.51, improvement = 36.97
After minimization: energy = -513.32, improvement = 106.78

Complex relaxation cycle 20/25
After repacking: energy = -402.93, improvement = -3.60
After minimization: energy = -473.48, improvement = 66.95

Complex relaxation cycle 21/25
After repacking: energy = -442.13, improvement = 35.59
After minimization: energy = -513.15, improvement = 106.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -444.21, improvement = 37.68
After minimization: energy = -513.19, improvement = 106.65

Complex relaxation cycle 23/25
After repacking: energy = -444.02, improvement = 37.49
After minimization: energy = -513.31, improvement = 106.78

Complex relaxation cycle 24/25
After repacking: energy = -441.58, improvement = 35.05
After minimization: energy = -512.41, improvement = 105.87
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -443.41, improvement = 36.88
After minimization: energy = -513.25, improvement = 106.72

=== Complex Relaxation Summary ===
Initial energy: -406.53
Final energy: -586.15
Total energy improvement: 179.61 (44.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.30 Å
Interface energy: -55.73
Saved relaxed complex structure to docking_results/3_peptide_25mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -586.15
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -55.73

Best binding found with CDR-L1, score: -588.33
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -407.68588770217576, 'relaxed_score': -588.3261005409604, 'interface_energy': -57.21495682925956, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 10, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/3_peptide_25mer_Ab0_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/3_peptide_25mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.3308587297651961), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

----- Processing antibody Ab1 with peptide 3_peptide_25mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/3_peptide_25mer_Ab1...
Peptide sequence: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSER
Antibody has 240 residues
Peptide has 25 residues
Saving antibody to docking_results/3_peptide_25mer_Ab1_antibody.pdb
Saving peptide to docking_results/3_peptide_25mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab1_CDR-H3_combined.pdb
Initial score: 6568.98
  Found better pose: 3332.86
  Found better pose: 2916.77
  Found better pose: 2403.93
  Found better pose: 1733.29
  Found better pose: 1430.38
  Found better pose: 689.36
  Found better pose: 323.64
  Found better pose: -95.89
  Found better pose: -216.96
  Found better pose: -228.36
  Found better pose: -230.24
  Found better pose: -230.61
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab1_CDR-H2_combined.pdb
Initial score: 14188.31
  Found better pose: 10129.28
  Found better pose: 9754.41
  Found better pose: 9602.77
  Found better pose: 9255.98
  Found better pose: 7393.83
  Found better pose: 7285.87
  Found better pose: 6259.09
  Found better pose: 6195.47
  Found better pose: 5680.46
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab1_CDR-H1_combined.pdb
Initial score: 33221.08
  Found better pose: 29893.89
  Found better pose: 29871.12
  Found better pose: 29475.92
  Found better pose: 29353.57
  Found better pose: 29156.59
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab1_CDR-L3_combined.pdb
Initial score: 11544.36
  Found better pose: 11354.63
  Found better pose: 11337.64
  Found better pose: 10737.56
  Found better pose: 10320.37
  Found better pose: 9995.58
  Found better pose: 9979.28
  Found better pose: 9859.96
  Found better pose: 9436.96
  Found better pose: 9355.40
  Found better pose: 9172.53
  Found better pose: 8665.24
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 8665.24
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 4395.18, improvement = 4270.06
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 5905.52, improvement = 2759.72
After minimization: energy = 5403.16, improvement = 3262.08

Complex relaxation cycle 2/25
After repacking: energy = 5393.91, improvement = 3271.33
After minimization: energy = 5331.02, improvement = 3334.22

Complex relaxation cycle 3/25
After repacking: energy = 6819.07, improvement = 1846.17
After minimization: energy = 5355.79, improvement = 3309.45

Complex relaxation cycle 4/25
After repacking: energy = 5378.04, improvement = 3287.20
After minimization: energy = 5337.83, improvement = 3327.42

Complex relaxation cycle 5/25
After repacking: energy = 5391.01, improvement = 3274.23
After minimization: energy = 5350.14, improvement = 3315.10

Complex relaxation cycle 6/25
After repacking: energy = 5367.00, improvement = 3298.24
After minimization: energy = 5338.35, improvement = 3326.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 5385.90, improvement = 3279.34
After minimization: energy = 5357.81, improvement = 3307.43

Complex relaxation cycle 8/25
After repacking: energy = 5365.54, improvement = 3299.70
After minimization: energy = 5339.15, improvement = 3326.09

Complex relaxation cycle 9/25
After repacking: energy = 5357.77, improvement = 3307.48
After minimization: energy = 5333.87, improvement = 3331.37
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 5370.46, improvement = 3294.78
After minimization: energy = 5349.35, improvement = 3315.89

Complex relaxation cycle 11/25
After repacking: energy = 5369.32, improvement = 3295.93
After minimization: energy = 5345.92, improvement = 3319.33

Complex relaxation cycle 12/25
After repacking: energy = 5362.01, improvement = 3303.24
After minimization: energy = 5333.19, improvement = 3332.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 5374.48, improvement = 3290.76
After minimization: energy = 5346.61, improvement = 3318.64

Complex relaxation cycle 14/25
After repacking: energy = 5359.58, improvement = 3305.66
After minimization: energy = 5334.92, improvement = 3330.32

Complex relaxation cycle 15/25
After repacking: energy = 5358.29, improvement = 3306.95
After minimization: energy = 5340.43, improvement = 3324.81
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 5352.76, improvement = 3312.48
After minimization: energy = 5332.51, improvement = 3332.73

Complex relaxation cycle 17/25
After repacking: energy = 5370.17, improvement = 3295.07
After minimization: energy = 5341.41, improvement = 3323.83

Complex relaxation cycle 18/25
After repacking: energy = 5375.12, improvement = 3290.12
After minimization: energy = 5346.23, improvement = 3319.01
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 5366.57, improvement = 3298.67
After minimization: energy = 5343.63, improvement = 3321.61

Complex relaxation cycle 20/25
After repacking: energy = 5357.73, improvement = 3307.51
After minimization: energy = 5335.83, improvement = 3329.41

Complex relaxation cycle 21/25
After repacking: energy = 5359.04, improvement = 3306.20
After minimization: energy = 5337.68, improvement = 3327.56
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 5352.55, improvement = 3312.69
After minimization: energy = 5336.26, improvement = 3328.99

Complex relaxation cycle 23/25
After repacking: energy = 5357.85, improvement = 3307.39
After minimization: energy = 5344.80, improvement = 3320.44

Complex relaxation cycle 24/25
After repacking: energy = 5361.65, improvement = 3303.60
After minimization: energy = 5345.24, improvement = 3320.00
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 5361.38, improvement = 3303.87
After minimization: energy = 5337.87, improvement = 3327.37

=== Complex Relaxation Summary ===
Initial energy: 8665.24
Final energy: 4395.18
Total energy improvement: 4270.06 (49.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.48 Å
Interface energy: 4624.91
Saved relaxed complex structure to docking_results/3_peptide_25mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: 4395.18
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: 4624.91

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab1_CDR-L1_combined.pdb
Initial score: -229.89
  Found better pose: -230.57
  Found better pose: -231.17
  Found better pose: -231.24
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -231.24
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -376.12, improvement = 144.88
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 317.15, improvement = -548.39
After minimization: energy = -191.33, improvement = -39.91

Complex relaxation cycle 2/25
After repacking: energy = -177.35, improvement = -53.88
After minimization: energy = -253.76, improvement = 22.52

Complex relaxation cycle 3/25
After repacking: energy = -206.40, improvement = -24.83
After minimization: energy = -267.35, improvement = 36.11

Complex relaxation cycle 4/25
After repacking: energy = -213.24, improvement = -17.99
After minimization: energy = -267.31, improvement = 36.08

Complex relaxation cycle 5/25
After repacking: energy = -204.82, improvement = -26.41
After minimization: energy = -268.43, improvement = 37.19

Complex relaxation cycle 6/25
After repacking: energy = -199.03, improvement = -32.21
After minimization: energy = -260.22, improvement = 28.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -210.12, improvement = -21.12
After minimization: energy = -267.23, improvement = 35.99

Complex relaxation cycle 8/25
After repacking: energy = -219.54, improvement = -11.69
After minimization: energy = -277.02, improvement = 45.78

Complex relaxation cycle 9/25
After repacking: energy = -219.04, improvement = -12.20
After minimization: energy = -277.13, improvement = 45.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -209.53, improvement = -21.70
After minimization: energy = -264.45, improvement = 33.21

Complex relaxation cycle 11/25
After repacking: energy = -208.06, improvement = -23.18
After minimization: energy = -266.40, improvement = 35.16

Complex relaxation cycle 12/25
After repacking: energy = -211.78, improvement = -19.46
After minimization: energy = -265.07, improvement = 33.84
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -211.14, improvement = -20.10
After minimization: energy = -264.82, improvement = 33.58

Complex relaxation cycle 14/25
After repacking: energy = -221.26, improvement = -9.98
After minimization: energy = -278.82, improvement = 47.58

Complex relaxation cycle 15/25
After repacking: energy = -211.24, improvement = -19.99
After minimization: energy = -264.97, improvement = 33.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -195.76, improvement = -35.48
After minimization: energy = -251.29, improvement = 20.05

Complex relaxation cycle 17/25
After repacking: energy = -208.77, improvement = -22.47
After minimization: energy = -266.05, improvement = 34.82

Complex relaxation cycle 18/25
After repacking: energy = -184.04, improvement = -47.19
After minimization: energy = -239.41, improvement = 8.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -210.20, improvement = -21.04
After minimization: energy = -266.10, improvement = 34.86

Complex relaxation cycle 20/25
After repacking: energy = -183.92, improvement = -47.32
After minimization: energy = -239.43, improvement = 8.19

Complex relaxation cycle 21/25
After repacking: energy = -222.44, improvement = -8.80
After minimization: energy = -278.11, improvement = 46.87
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -222.84, improvement = -8.40
After minimization: energy = -276.45, improvement = 45.21

Complex relaxation cycle 23/25
After repacking: energy = -223.91, improvement = -7.33
After minimization: energy = -274.51, improvement = 43.27

Complex relaxation cycle 24/25
After repacking: energy = -220.32, improvement = -10.92
After minimization: energy = -278.08, improvement = 46.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -210.83, improvement = -20.40
After minimization: energy = -264.29, improvement = 33.05

=== Complex Relaxation Summary ===
Initial energy: -231.24
Final energy: -376.12
Total energy improvement: 144.88 (62.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.39 Å
Interface energy: -59.97
Saved relaxed complex structure to docking_results/3_peptide_25mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -376.12
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -59.97

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-38.19, 59.23, -12.28)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/3_peptide_25mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/3_peptide_25mer_Ab1_CDR-L2_combined.pdb
Initial score: 14231.32
  Found better pose: 10055.07
  Found better pose: 9325.54
  Found better pose: 7271.51
  Found better pose: 4645.72
  Found better pose: 3866.15
  Found better pose: 2229.36
  Found better pose: 1200.70
  Found better pose: 550.40
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 550.40
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -366.49, improvement = 916.89
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 392.38, improvement = 158.02
After minimization: energy = -159.51, improvement = 709.91

Complex relaxation cycle 2/25
After repacking: energy = -117.73, improvement = 668.13
After minimization: energy = -195.21, improvement = 745.61

Complex relaxation cycle 3/25
After repacking: energy = -130.73, improvement = 681.13
After minimization: energy = -205.95, improvement = 756.35

Complex relaxation cycle 4/25
After repacking: energy = -141.68, improvement = 692.08
After minimization: energy = -216.51, improvement = 766.91

Complex relaxation cycle 5/25
After repacking: energy = -138.10, improvement = 688.50
After minimization: energy = -209.80, improvement = 760.20

Complex relaxation cycle 6/25
After repacking: energy = -146.69, improvement = 697.09
After minimization: energy = -221.51, improvement = 771.91
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -152.69, improvement = 703.09
After minimization: energy = -225.41, improvement = 775.82

Complex relaxation cycle 8/25
After repacking: energy = -151.38, improvement = 701.78
After minimization: energy = -228.26, improvement = 778.66

Complex relaxation cycle 9/25
After repacking: energy = -135.30, improvement = 685.70
After minimization: energy = -256.80, improvement = 807.20
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 1357.41, improvement = -807.01
After minimization: energy = -191.96, improvement = 742.36

Complex relaxation cycle 11/25
After repacking: energy = -192.26, improvement = 742.66
After minimization: energy = -250.32, improvement = 800.72

Complex relaxation cycle 12/25
After repacking: energy = -187.87, improvement = 738.27
After minimization: energy = -249.76, improvement = 800.16
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -204.46, improvement = 754.86
After minimization: energy = -249.89, improvement = 800.29

Complex relaxation cycle 14/25
After repacking: energy = -203.74, improvement = 754.14
After minimization: energy = -237.41, improvement = 787.81

Complex relaxation cycle 15/25
After repacking: energy = -227.26, improvement = 777.66
After minimization: energy = -261.82, improvement = 812.22
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -176.81, improvement = 727.21
After minimization: energy = -222.27, improvement = 772.67

Complex relaxation cycle 17/25
After repacking: energy = -204.11, improvement = 754.51
After minimization: energy = -249.37, improvement = 799.77

Complex relaxation cycle 18/25
After repacking: energy = -216.09, improvement = 766.50
After minimization: energy = -259.82, improvement = 810.22
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -203.91, improvement = 754.31
After minimization: energy = -248.87, improvement = 799.27

Complex relaxation cycle 20/25
After repacking: energy = -216.85, improvement = 767.25
After minimization: energy = -260.25, improvement = 810.66

Complex relaxation cycle 21/25
After repacking: energy = -204.11, improvement = 754.52
After minimization: energy = -248.21, improvement = 798.61
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -201.10, improvement = 751.50
After minimization: energy = -250.13, improvement = 800.53

Complex relaxation cycle 23/25
After repacking: energy = -201.93, improvement = 752.33
After minimization: energy = -250.83, improvement = 801.23

Complex relaxation cycle 24/25
After repacking: energy = -210.70, improvement = 761.10
After minimization: energy = -262.01, improvement = 812.41
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -214.59, improvement = 765.00
After minimization: energy = -261.11, improvement = 811.51

=== Complex Relaxation Summary ===
Initial energy: 550.40
Final energy: -366.49
Total energy improvement: 916.89 (166.6%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.39 Å
Interface energy: -56.89
Saved relaxed complex structure to docking_results/3_peptide_25mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -366.49
Checking contacts between peptide and CDR-L2...
Found 28 contacts with CDR-L2 (350.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -56.89

Best binding found with CDR-L1, score: -376.12
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -231.23638163933376, 'relaxed_score': -376.11706803304963, 'interface_energy': -59.967940316534566, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/3_peptide_25mer_Ab1_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/3_peptide_25mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.3308587297651961), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

===== Processing peptide: 4_peptide_15mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/4_peptide_15mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 4_peptide_15mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/4_peptide_15mer_Ab0...
Peptide sequence: CYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLYTYR
Antibody has 232 residues
Peptide has 15 residues
Saving antibody to docking_results/4_peptide_15mer_Ab0_antibody.pdb
Saving peptide to docking_results/4_peptide_15mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab0_CDR-H3_combined.pdb
Initial score: -400.70
  Found better pose: -400.73
  Found better pose: -400.76
  Found better pose: -400.78
  Found better pose: -400.97
  Found better pose: -400.98
  Found better pose: -401.14
  Found better pose: -401.22
  Found better pose: -401.49
  Found better pose: -401.63
  Found better pose: -401.77
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab0_CDR-H2_combined.pdb
Initial score: 239.44
  Found better pose: -359.08
  Found better pose: -388.68
  Found better pose: -389.62
  Found better pose: -401.67
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab0_CDR-H1_combined.pdb
Initial score: 26714.13
  Found better pose: 25026.91
  Found better pose: 22352.99
  Found better pose: 20684.01
  Found better pose: 19898.02
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab0_CDR-L3_combined.pdb
Initial score: -400.68
  Found better pose: -400.99
  Found better pose: -400.99
  Found better pose: -401.76
  Found better pose: -401.93
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -401.93
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -585.49, improvement = 183.56
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -341.47, improvement = -60.46
After minimization: energy = -513.05, improvement = 111.12

Complex relaxation cycle 2/25
After repacking: energy = -377.12, improvement = -24.81
After minimization: energy = -498.85, improvement = 96.92

Complex relaxation cycle 3/25
After repacking: energy = -441.90, improvement = 39.98
After minimization: energy = -504.90, improvement = 102.97

Complex relaxation cycle 4/25
After repacking: energy = -455.33, improvement = 53.41
After minimization: energy = -505.64, improvement = 103.71

Complex relaxation cycle 5/25
After repacking: energy = -452.99, improvement = 51.06
After minimization: energy = -505.56, improvement = 103.63

Complex relaxation cycle 6/25
After repacking: energy = -453.16, improvement = 51.23
After minimization: energy = -505.62, improvement = 103.69
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -452.09, improvement = 50.16
After minimization: energy = -506.05, improvement = 104.12

Complex relaxation cycle 8/25
After repacking: energy = -408.94, improvement = 7.02
After minimization: energy = -469.70, improvement = 67.77

Complex relaxation cycle 9/25
After repacking: energy = -437.76, improvement = 35.83
After minimization: energy = -508.64, improvement = 106.71
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -438.19, improvement = 36.26
After minimization: energy = -509.72, improvement = 107.79

Complex relaxation cycle 11/25
After repacking: energy = -439.81, improvement = 37.88
After minimization: energy = -510.15, improvement = 108.22

Complex relaxation cycle 12/25
After repacking: energy = -430.83, improvement = 28.90
After minimization: energy = -510.19, improvement = 108.26
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -413.94, improvement = 12.02
After minimization: energy = -509.12, improvement = 107.19

Complex relaxation cycle 14/25
After repacking: energy = -427.14, improvement = 25.21
After minimization: energy = -509.64, improvement = 107.71

Complex relaxation cycle 15/25
After repacking: energy = -431.11, improvement = 29.18
After minimization: energy = -513.56, improvement = 111.63
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -428.42, improvement = 26.49
After minimization: energy = -510.77, improvement = 108.84

Complex relaxation cycle 17/25
After repacking: energy = -385.69, improvement = -16.24
After minimization: energy = -470.93, improvement = 69.00

Complex relaxation cycle 18/25
After repacking: energy = -409.52, improvement = 7.59
After minimization: energy = -508.63, improvement = 106.70
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -424.87, improvement = 22.94
After minimization: energy = -513.42, improvement = 111.49

Complex relaxation cycle 20/25
After repacking: energy = -424.11, improvement = 22.18
After minimization: energy = -510.80, improvement = 108.87

Complex relaxation cycle 21/25
After repacking: energy = -425.32, improvement = 23.39
After minimization: energy = -510.81, improvement = 108.88
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -411.81, improvement = 9.88
After minimization: energy = -509.71, improvement = 107.78

Complex relaxation cycle 23/25
After repacking: energy = -423.70, improvement = 21.77
After minimization: energy = -512.91, improvement = 110.98

Complex relaxation cycle 24/25
After repacking: energy = -431.74, improvement = 29.81
After minimization: energy = -511.79, improvement = 109.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -434.44, improvement = 32.52
After minimization: energy = -511.81, improvement = 109.88

=== Complex Relaxation Summary ===
Initial energy: -401.93
Final energy: -585.49
Total energy improvement: 183.56 (45.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.27 Å
Interface energy: -52.84
Saved relaxed complex structure to docking_results/4_peptide_15mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -585.49
Checking contacts between peptide and CDR-L3...
Found 39 contacts with CDR-L3 (354.5% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -52.84

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab0_CDR-L1_combined.pdb
Initial score: 7349.21
  Found better pose: 6207.69
  Found better pose: 5249.77
  Found better pose: 4149.07
  Found better pose: 3058.87
  Found better pose: 2726.08
  Found better pose: 1900.43
  Found better pose: 1518.44
  Found better pose: 1515.42
  Found better pose: 628.09
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 628.09
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -562.01, improvement = 1190.10
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -321.42, improvement = 949.51
After minimization: energy = -493.81, improvement = 1121.89

Complex relaxation cycle 2/25
After repacking: energy = -368.79, improvement = 996.87
After minimization: energy = -483.49, improvement = 1111.57

Complex relaxation cycle 3/25
After repacking: energy = -416.76, improvement = 1044.84
After minimization: energy = -484.08, improvement = 1112.16

Complex relaxation cycle 4/25
After repacking: energy = -406.13, improvement = 1034.21
After minimization: energy = -489.80, improvement = 1117.88

Complex relaxation cycle 5/25
After repacking: energy = -428.07, improvement = 1056.16
After minimization: energy = -491.35, improvement = 1119.43

Complex relaxation cycle 6/25
After repacking: energy = -429.78, improvement = 1057.87
After minimization: energy = -491.17, improvement = 1119.26
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -429.32, improvement = 1057.40
After minimization: energy = -490.85, improvement = 1118.93

Complex relaxation cycle 8/25
After repacking: energy = -427.25, improvement = 1055.33
After minimization: energy = -492.40, improvement = 1120.48

Complex relaxation cycle 9/25
After repacking: energy = -426.59, improvement = 1054.68
After minimization: energy = -490.86, improvement = 1118.94
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -425.27, improvement = 1053.36
After minimization: energy = -490.67, improvement = 1118.75

Complex relaxation cycle 11/25
After repacking: energy = -426.54, improvement = 1054.62
After minimization: energy = -490.78, improvement = 1118.86

Complex relaxation cycle 12/25
After repacking: energy = -426.29, improvement = 1054.38
After minimization: energy = -491.66, improvement = 1119.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -426.74, improvement = 1054.83
After minimization: energy = -491.99, improvement = 1120.08

Complex relaxation cycle 14/25
After repacking: energy = -427.00, improvement = 1055.08
After minimization: energy = -492.35, improvement = 1120.44

Complex relaxation cycle 15/25
After repacking: energy = -427.30, improvement = 1055.38
After minimization: energy = -492.14, improvement = 1120.23
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -425.42, improvement = 1053.51
After minimization: energy = -491.16, improvement = 1119.24

Complex relaxation cycle 17/25
After repacking: energy = -426.95, improvement = 1055.04
After minimization: energy = -491.49, improvement = 1119.57

Complex relaxation cycle 18/25
After repacking: energy = -427.49, improvement = 1055.58
After minimization: energy = -491.19, improvement = 1119.27
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -426.68, improvement = 1054.77
After minimization: energy = -490.85, improvement = 1118.93

Complex relaxation cycle 20/25
After repacking: energy = -427.09, improvement = 1055.17
After minimization: energy = -490.74, improvement = 1118.83

Complex relaxation cycle 21/25
After repacking: energy = -426.78, improvement = 1054.86
After minimization: energy = -490.43, improvement = 1118.51
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -426.95, improvement = 1055.04
After minimization: energy = -491.85, improvement = 1119.93

Complex relaxation cycle 23/25
After repacking: energy = -426.85, improvement = 1054.94
After minimization: energy = -491.84, improvement = 1119.93

Complex relaxation cycle 24/25
After repacking: energy = -427.37, improvement = 1055.45
After minimization: energy = -491.47, improvement = 1119.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -427.14, improvement = 1055.23
After minimization: energy = -491.15, improvement = 1119.23

=== Complex Relaxation Summary ===
Initial energy: 628.09
Final energy: -562.01
Total energy improvement: 1190.10 (189.5%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.29 Å
Interface energy: -42.50
Saved relaxed complex structure to docking_results/4_peptide_15mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -562.01
Checking contacts between peptide and CDR-L1...
Found 58 contacts with CDR-L1 (362.5% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -42.50

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab0_CDR-L2_combined.pdb
Initial score: -386.88
  Found better pose: -399.52
  Found better pose: -401.29
  Found better pose: -401.54
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -401.54
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -585.59, improvement = 184.05
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -338.48, improvement = -63.05
After minimization: energy = -512.73, improvement = 111.20

Complex relaxation cycle 2/25
After repacking: energy = -381.30, improvement = -20.24
After minimization: energy = -500.28, improvement = 98.74

Complex relaxation cycle 3/25
After repacking: energy = -379.58, improvement = -21.96
After minimization: energy = -480.61, improvement = 79.07

Complex relaxation cycle 4/25
After repacking: energy = -387.32, improvement = -14.22
After minimization: energy = -505.20, improvement = 103.66

Complex relaxation cycle 5/25
After repacking: energy = -451.33, improvement = 49.80
After minimization: energy = -508.71, improvement = 107.17

Complex relaxation cycle 6/25
After repacking: energy = -446.15, improvement = 44.61
After minimization: energy = -508.79, improvement = 107.25
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -442.70, improvement = 41.16
After minimization: energy = -507.61, improvement = 106.07

Complex relaxation cycle 8/25
After repacking: energy = -443.03, improvement = 41.49
After minimization: energy = -507.62, improvement = 106.08

Complex relaxation cycle 9/25
After repacking: energy = -441.38, improvement = 39.84
After minimization: energy = -507.67, improvement = 106.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -441.47, improvement = 39.94
After minimization: energy = -507.99, improvement = 106.45

Complex relaxation cycle 11/25
After repacking: energy = -442.33, improvement = 40.79
After minimization: energy = -507.82, improvement = 106.29

Complex relaxation cycle 12/25
After repacking: energy = -442.18, improvement = 40.64
After minimization: energy = -506.91, improvement = 105.38
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -429.24, improvement = 27.71
After minimization: energy = -506.35, improvement = 104.81

Complex relaxation cycle 14/25
After repacking: energy = -440.68, improvement = 39.14
After minimization: energy = -506.02, improvement = 104.49

Complex relaxation cycle 15/25
After repacking: energy = -441.31, improvement = 39.77
After minimization: energy = -506.40, improvement = 104.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -441.40, improvement = 39.86
After minimization: energy = -508.06, improvement = 106.52

Complex relaxation cycle 17/25
After repacking: energy = -441.98, improvement = 40.45
After minimization: energy = -508.05, improvement = 106.52

Complex relaxation cycle 18/25
After repacking: energy = -441.75, improvement = 40.22
After minimization: energy = -507.07, improvement = 105.54
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -440.29, improvement = 38.75
After minimization: energy = -507.91, improvement = 106.37

Complex relaxation cycle 20/25
After repacking: energy = -428.93, improvement = 27.39
After minimization: energy = -507.03, improvement = 105.49

Complex relaxation cycle 21/25
After repacking: energy = -439.48, improvement = 37.95
After minimization: energy = -505.48, improvement = 103.94
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -439.28, improvement = 37.74
After minimization: energy = -508.85, improvement = 107.31

Complex relaxation cycle 23/25
After repacking: energy = -409.74, improvement = 8.20
After minimization: energy = -469.45, improvement = 67.91

Complex relaxation cycle 24/25
After repacking: energy = -450.73, improvement = 49.19
After minimization: energy = -509.10, improvement = 107.56
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -450.42, improvement = 48.88
After minimization: energy = -509.81, improvement = 108.27

=== Complex Relaxation Summary ===
Initial energy: -401.54
Final energy: -585.59
Total energy improvement: 184.05 (45.8%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.25 Å
Interface energy: -52.73
Saved relaxed complex structure to docking_results/4_peptide_15mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -585.59
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -52.73

Best binding found with CDR-L2, score: -585.59
Docking complete. Results: {'binding_cdr': 'CDR-L2', 'initial_score': -401.53801856915135, 'relaxed_score': -585.5853897841931, 'interface_energy': -52.72977205034192, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 6, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/4_peptide_15mer_Ab0_CDR-L2_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/4_peptide_15mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 4_peptide_15mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/4_peptide_15mer_Ab1...
Peptide sequence: CYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLYTYR
Antibody has 240 residues
Peptide has 15 residues
Saving antibody to docking_results/4_peptide_15mer_Ab1_antibody.pdb
Saving peptide to docking_results/4_peptide_15mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab1_CDR-H3_combined.pdb
Initial score: 386.56
  Found better pose: 182.92
  Found better pose: -137.34
  Found better pose: -221.34
  Found better pose: -224.87
  Found better pose: -225.14
  Found better pose: -225.81
  Found better pose: -226.67
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab1_CDR-H2_combined.pdb
Initial score: 932.01
  Found better pose: 316.27
  Found better pose: -5.87
  Found better pose: -73.72
  Found better pose: -219.44
  Found better pose: -220.71
  Found better pose: -223.45
  Found better pose: -223.71
  Found better pose: -224.09
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab1_CDR-H1_combined.pdb
Initial score: 21678.07
  Found better pose: 20550.23
  Found better pose: 19655.76
  Found better pose: 18404.74
  Found better pose: 18232.45
  Found better pose: 17919.54
  Found better pose: 17807.26
  Found better pose: 16854.29
  Found better pose: 16246.27
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab1_CDR-L3_combined.pdb
Initial score: -222.62
  Found better pose: -222.80
  Found better pose: -222.82
  Found better pose: -222.82
  Found better pose: -222.83
  Found better pose: -222.83
  Found better pose: -222.86
  Found better pose: -222.97
  Found better pose: -223.01
  Found better pose: -223.11
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -223.11
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -384.05, improvement = 160.94
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 335.31, improvement = -558.42
After minimization: energy = -174.80, improvement = -48.30

Complex relaxation cycle 2/25
After repacking: energy = -164.01, improvement = -59.10
After minimization: energy = -229.30, improvement = 6.20

Complex relaxation cycle 3/25
After repacking: energy = -206.60, improvement = -16.50
After minimization: energy = -256.38, improvement = 33.28

Complex relaxation cycle 4/25
After repacking: energy = -219.45, improvement = -3.66
After minimization: energy = -265.45, improvement = 42.35

Complex relaxation cycle 5/25
After repacking: energy = -208.38, improvement = -14.73
After minimization: energy = -256.43, improvement = 33.32

Complex relaxation cycle 6/25
After repacking: energy = -219.58, improvement = -3.52
After minimization: energy = -268.43, improvement = 45.32
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -219.17, improvement = -3.94
After minimization: energy = -270.76, improvement = 47.65

Complex relaxation cycle 8/25
After repacking: energy = -224.03, improvement = 0.93
After minimization: energy = -272.11, improvement = 49.00

Complex relaxation cycle 9/25
After repacking: energy = -205.54, improvement = -17.57
After minimization: energy = -258.09, improvement = 34.99
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -209.01, improvement = -14.09
After minimization: energy = -259.98, improvement = 36.88

Complex relaxation cycle 11/25
After repacking: energy = -197.37, improvement = -25.74
After minimization: energy = -243.86, improvement = 20.76

Complex relaxation cycle 12/25
After repacking: energy = -214.57, improvement = -8.54
After minimization: energy = -258.84, improvement = 35.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -214.46, improvement = -8.65
After minimization: energy = -258.87, improvement = 35.77

Complex relaxation cycle 14/25
After repacking: energy = -213.55, improvement = -9.55
After minimization: energy = -258.54, improvement = 35.44

Complex relaxation cycle 15/25
After repacking: energy = -214.54, improvement = -8.56
After minimization: energy = -256.66, improvement = 33.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -187.18, improvement = -35.93
After minimization: energy = -232.00, improvement = 8.89

Complex relaxation cycle 17/25
After repacking: energy = -214.26, improvement = -8.84
After minimization: energy = -258.59, improvement = 35.49

Complex relaxation cycle 18/25
After repacking: energy = -187.14, improvement = -35.97
After minimization: energy = -231.75, improvement = 8.64
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -214.23, improvement = -8.88
After minimization: energy = -258.48, improvement = 35.38

Complex relaxation cycle 20/25
After repacking: energy = -213.90, improvement = -9.20
After minimization: energy = -258.63, improvement = 35.52

Complex relaxation cycle 21/25
After repacking: energy = -213.98, improvement = -9.13
After minimization: energy = -258.75, improvement = 35.64
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -199.35, improvement = -23.75
After minimization: energy = -243.91, improvement = 20.80

Complex relaxation cycle 23/25
After repacking: energy = -187.42, improvement = -35.69
After minimization: energy = -232.00, improvement = 8.90

Complex relaxation cycle 24/25
After repacking: energy = -213.32, improvement = -9.78
After minimization: energy = -258.74, improvement = 35.64
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -226.10, improvement = 2.99
After minimization: energy = -271.08, improvement = 47.98

=== Complex Relaxation Summary ===
Initial energy: -223.11
Final energy: -384.05
Total energy improvement: 160.94 (72.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.48 Å
Interface energy: -51.20
Saved relaxed complex structure to docking_results/4_peptide_15mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -384.05
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -51.20

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab1_CDR-L1_combined.pdb
Initial score: 4313.01
  Found better pose: 4188.64
  Found better pose: 3617.04
  Found better pose: 3607.60
  Found better pose: 3487.04
  Found better pose: 2925.64
  Found better pose: 2018.26
  Found better pose: 1807.48
  Found better pose: 1324.16
  Found better pose: 728.03
  Found better pose: 108.89
  Found better pose: -11.14
  Found better pose: -17.56
  Found better pose: -39.04
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -39.04
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -191.18, improvement = 152.14
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 583.07, improvement = -622.11
After minimization: energy = 76.05, improvement = -115.08

Complex relaxation cycle 2/25
After repacking: energy = 66.16, improvement = -105.20
After minimization: energy = -14.86, improvement = -24.18

Complex relaxation cycle 3/25
After repacking: energy = 72.14, improvement = -111.18
After minimization: energy = 9.44, improvement = -48.47

Complex relaxation cycle 4/25
After repacking: energy = 33.78, improvement = -72.82
After minimization: energy = -16.73, improvement = -22.31

Complex relaxation cycle 5/25
After repacking: energy = 36.26, improvement = -75.30
After minimization: energy = -11.94, improvement = -27.10

Complex relaxation cycle 6/25
After repacking: energy = 41.12, improvement = -80.15
After minimization: energy = -6.94, improvement = -32.10
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 28.85, improvement = -67.89
After minimization: energy = -18.92, improvement = -20.12

Complex relaxation cycle 8/25
After repacking: energy = 27.64, improvement = -66.68
After minimization: energy = -19.67, improvement = -19.36

Complex relaxation cycle 9/25
After repacking: energy = 38.64, improvement = -77.67
After minimization: energy = -8.27, improvement = -30.77
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 26.89, improvement = -65.92
After minimization: energy = -20.31, improvement = -18.73

Complex relaxation cycle 11/25
After repacking: energy = 39.81, improvement = -78.85
After minimization: energy = -7.18, improvement = -31.85

Complex relaxation cycle 12/25
After repacking: energy = 40.00, improvement = -79.04
After minimization: energy = -7.19, improvement = -31.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 38.94, improvement = -77.97
After minimization: energy = -8.28, improvement = -30.76

Complex relaxation cycle 14/25
After repacking: energy = 28.58, improvement = -67.61
After minimization: energy = -19.02, improvement = -20.01

Complex relaxation cycle 15/25
After repacking: energy = 38.56, improvement = -77.59
After minimization: energy = -13.77, improvement = -25.26
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 55.30, improvement = -94.34
After minimization: energy = 1.15, improvement = -40.18

Complex relaxation cycle 17/25
After repacking: energy = 35.21, improvement = -74.25
After minimization: energy = -25.24, improvement = -13.80

Complex relaxation cycle 18/25
After repacking: energy = 42.54, improvement = -81.58
After minimization: energy = -27.62, improvement = -11.41
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 31.60, improvement = -70.64
After minimization: energy = -27.11, improvement = -11.92

Complex relaxation cycle 20/25
After repacking: energy = 71.43, improvement = -110.46
After minimization: energy = 10.70, improvement = -49.74

Complex relaxation cycle 21/25
After repacking: energy = 45.06, improvement = -84.09
After minimization: energy = -14.99, improvement = -24.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 45.89, improvement = -84.93
After minimization: energy = -14.21, improvement = -24.82

Complex relaxation cycle 23/25
After repacking: energy = 32.87, improvement = -71.91
After minimization: energy = -26.98, improvement = -12.05

Complex relaxation cycle 24/25
After repacking: energy = 44.39, improvement = -83.43
After minimization: energy = -14.98, improvement = -24.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 45.62, improvement = -84.66
After minimization: energy = -14.99, improvement = -24.05

=== Complex Relaxation Summary ===
Initial energy: -39.04
Final energy: -191.18
Total energy improvement: 152.14 (389.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.46 Å
Interface energy: 125.80
Saved relaxed complex structure to docking_results/4_peptide_15mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -191.18
Checking contacts between peptide and CDR-L1...
Found 58 contacts with CDR-L1 (362.5% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 125.80

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-42.36, 32.72, 18.78)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/4_peptide_15mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/4_peptide_15mer_Ab1_CDR-L2_combined.pdb
Initial score: 3298.05
  Found better pose: 1862.38
  Found better pose: 1675.74
  Found better pose: 1250.50
  Found better pose: 379.95
  Found better pose: 127.96
  Found better pose: -98.37
  Found better pose: -169.79
  Found better pose: -209.46
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -209.46
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -381.45, improvement = 172.00
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 339.26, improvement = -548.72
After minimization: energy = -169.42, improvement = -40.03

Complex relaxation cycle 2/25
After repacking: energy = -184.52, improvement = -24.94
After minimization: energy = -252.05, improvement = 42.59

Complex relaxation cycle 3/25
After repacking: energy = -188.98, improvement = -20.48
After minimization: energy = -253.72, improvement = 44.26

Complex relaxation cycle 4/25
After repacking: energy = -198.51, improvement = -10.94
After minimization: energy = -255.19, improvement = 45.73

Complex relaxation cycle 5/25
After repacking: energy = -190.64, improvement = -18.82
After minimization: energy = -240.84, improvement = 31.38

Complex relaxation cycle 6/25
After repacking: energy = -216.64, improvement = 7.18
After minimization: energy = -265.79, improvement = 56.33
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -219.82, improvement = 10.37
After minimization: energy = -265.28, improvement = 55.83

Complex relaxation cycle 8/25
After repacking: energy = -211.63, improvement = 2.17
After minimization: energy = -259.37, improvement = 49.91

Complex relaxation cycle 9/25
After repacking: energy = -212.12, improvement = 2.66
After minimization: energy = -260.49, improvement = 51.03
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -213.94, improvement = 4.49
After minimization: energy = -260.43, improvement = 50.98

Complex relaxation cycle 11/25
After repacking: energy = -226.08, improvement = 16.63
After minimization: energy = -271.84, improvement = 62.38

Complex relaxation cycle 12/25
After repacking: energy = -225.13, improvement = 15.67
After minimization: energy = -272.18, improvement = 62.72
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -213.97, improvement = 4.52
After minimization: energy = -250.02, improvement = 40.56

Complex relaxation cycle 14/25
After repacking: energy = -234.72, improvement = 25.27
After minimization: energy = -275.73, improvement = 66.28

Complex relaxation cycle 15/25
After repacking: energy = -219.22, improvement = 9.77
After minimization: energy = -264.08, improvement = 54.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -211.39, improvement = 1.93
After minimization: energy = -253.59, improvement = 44.13

Complex relaxation cycle 17/25
After repacking: energy = 1453.45, improvement = -1662.91
After minimization: energy = -252.83, improvement = 43.37

Complex relaxation cycle 18/25
After repacking: energy = -201.74, improvement = -7.71
After minimization: energy = -250.15, improvement = 40.69
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -177.19, improvement = -32.27
After minimization: energy = -220.63, improvement = 11.17

Complex relaxation cycle 20/25
After repacking: energy = -205.19, improvement = -4.27
After minimization: energy = -247.51, improvement = 38.06

Complex relaxation cycle 21/25
After repacking: energy = -211.33, improvement = 1.87
After minimization: energy = -253.54, improvement = 44.09
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -203.70, improvement = -5.75
After minimization: energy = -247.54, improvement = 38.08

Complex relaxation cycle 23/25
After repacking: energy = -204.56, improvement = -4.90
After minimization: energy = -247.65, improvement = 38.19

Complex relaxation cycle 24/25
After repacking: energy = -205.32, improvement = -4.14
After minimization: energy = -247.62, improvement = 38.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -190.58, improvement = -18.87
After minimization: energy = -232.95, improvement = 23.50

=== Complex Relaxation Summary ===
Initial energy: -209.46
Final energy: -381.45
Total energy improvement: 172.00 (82.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.72 Å
Interface energy: -52.41
Saved relaxed complex structure to docking_results/4_peptide_15mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -381.45
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -52.41

Best binding found with CDR-L3, score: -384.05
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -223.10504549125602, 'relaxed_score': -384.0500302036358, 'interface_energy': -51.197155158852865, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 8, 'salt_bridges': 0, 'hydrophobic': 5, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/4_peptide_15mer_Ab1_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/4_peptide_15mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 3_peptide_20mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/3_peptide_20mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 3_peptide_20mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/3_peptide_20mer_Ab0...
Peptide sequence: SERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLYTYR
Antibody has 232 residues
Peptide has 20 residues
Saving antibody to docking_results/3_peptide_20mer_Ab0_antibody.pdb
Saving peptide to docking_results/3_peptide_20mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab0_CDR-H3_combined.pdb
Initial score: -402.71
  Found better pose: -402.71
  Found better pose: -402.71
  Found better pose: -402.81
  Found better pose: -403.08
  Found better pose: -403.19
  Found better pose: -403.44
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab0_CDR-H2_combined.pdb
Initial score: 1591.34
  Found better pose: 485.13
  Found better pose: -97.15
  Found better pose: -309.86
  Found better pose: -394.49
  Found better pose: -402.10
  Found better pose: -402.22
  Found better pose: -402.69
  Found better pose: -402.80
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab0_CDR-H1_combined.pdb
Initial score: 31057.33
  Found better pose: 30584.25
  Found better pose: 29331.13
  Found better pose: 26721.46
  Found better pose: 25709.58
  Found better pose: 23353.25
  Found better pose: 20982.92
  Found better pose: 19986.12
  Found better pose: 19011.61
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab0_CDR-L3_combined.pdb
Initial score: 2222.32
  Found better pose: 1959.68
  Found better pose: 790.19
  Found better pose: 8.90
  Found better pose: -230.05
  Found better pose: -380.51
  Found better pose: -399.39
  Found better pose: -399.91
  Found better pose: -401.49
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -401.49
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -587.51, improvement = 186.02
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -340.57, improvement = -60.92
After minimization: energy = -512.73, improvement = 111.24

Complex relaxation cycle 2/25
After repacking: energy = -365.79, improvement = -35.70
After minimization: energy = -500.97, improvement = 99.48

Complex relaxation cycle 3/25
After repacking: energy = -433.58, improvement = 32.09
After minimization: energy = -513.07, improvement = 111.58

Complex relaxation cycle 4/25
After repacking: energy = -460.18, improvement = 58.69
After minimization: energy = -509.41, improvement = 107.92

Complex relaxation cycle 5/25
After repacking: energy = -457.79, improvement = 56.30
After minimization: energy = -508.09, improvement = 106.59

Complex relaxation cycle 6/25
After repacking: energy = -442.16, improvement = 40.67
After minimization: energy = -506.98, improvement = 105.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -414.97, improvement = 13.48
After minimization: energy = -468.05, improvement = 66.55

Complex relaxation cycle 8/25
After repacking: energy = -455.95, improvement = 54.46
After minimization: energy = -508.46, improvement = 106.96

Complex relaxation cycle 9/25
After repacking: energy = -455.78, improvement = 54.29
After minimization: energy = -507.81, improvement = 106.31
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -415.68, improvement = 14.19
After minimization: energy = -468.41, improvement = 66.92

Complex relaxation cycle 11/25
After repacking: energy = -456.15, improvement = 54.66
After minimization: energy = -508.13, improvement = 106.64

Complex relaxation cycle 12/25
After repacking: energy = -444.32, improvement = 42.83
After minimization: energy = -507.00, improvement = 105.51
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -455.13, improvement = 53.64
After minimization: energy = -508.11, improvement = 106.62

Complex relaxation cycle 14/25
After repacking: energy = -456.74, improvement = 55.24
After minimization: energy = -508.18, improvement = 106.68

Complex relaxation cycle 15/25
After repacking: energy = -444.03, improvement = 42.54
After minimization: energy = -506.87, improvement = 105.37
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -456.39, improvement = 54.90
After minimization: energy = -508.16, improvement = 106.67

Complex relaxation cycle 17/25
After repacking: energy = -456.60, improvement = 55.10
After minimization: energy = -508.01, improvement = 106.52

Complex relaxation cycle 18/25
After repacking: energy = -443.91, improvement = 42.41
After minimization: energy = -507.06, improvement = 105.57
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -455.07, improvement = 53.58
After minimization: energy = -507.94, improvement = 106.44

Complex relaxation cycle 20/25
After repacking: energy = -455.69, improvement = 54.20
After minimization: energy = -507.94, improvement = 106.44

Complex relaxation cycle 21/25
After repacking: energy = -456.38, improvement = 54.89
After minimization: energy = -503.39, improvement = 101.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -464.66, improvement = 63.17
After minimization: energy = -508.39, improvement = 106.90

Complex relaxation cycle 23/25
After repacking: energy = -452.71, improvement = 51.22
After minimization: energy = -508.38, improvement = 106.89

Complex relaxation cycle 24/25
After repacking: energy = -452.71, improvement = 51.21
After minimization: energy = -507.92, improvement = 106.43
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -453.37, improvement = 51.88
After minimization: energy = -508.36, improvement = 106.87

=== Complex Relaxation Summary ===
Initial energy: -401.49
Final energy: -587.51
Total energy improvement: 186.02 (46.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.33 Å
Interface energy: -55.13
Saved relaxed complex structure to docking_results/3_peptide_20mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -587.51
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -55.13

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab0_CDR-L1_combined.pdb
Initial score: -228.76
  Found better pose: -341.46
  Found better pose: -399.98
  Found better pose: -402.61
  Found better pose: -404.51
  Found better pose: -404.64
  Found better pose: -404.69
  Found better pose: -404.96
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -404.96
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -581.85, improvement = 176.89
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -340.70, improvement = -64.26
After minimization: energy = -511.01, improvement = 106.05

Complex relaxation cycle 2/25
After repacking: energy = -372.74, improvement = -32.22
After minimization: energy = -497.39, improvement = 92.43

Complex relaxation cycle 3/25
After repacking: energy = -422.09, improvement = 17.13
After minimization: energy = -507.13, improvement = 102.17

Complex relaxation cycle 4/25
After repacking: energy = -449.44, improvement = 44.48
After minimization: energy = -513.27, improvement = 108.31

Complex relaxation cycle 5/25
After repacking: energy = -444.77, improvement = 39.81
After minimization: energy = -513.34, improvement = 108.38

Complex relaxation cycle 6/25
After repacking: energy = -447.08, improvement = 42.12
After minimization: energy = -513.84, improvement = 108.88
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -444.19, improvement = 39.23
After minimization: energy = -511.04, improvement = 106.08

Complex relaxation cycle 8/25
After repacking: energy = -441.62, improvement = 36.66
After minimization: energy = -510.25, improvement = 105.29

Complex relaxation cycle 9/25
After repacking: energy = -443.80, improvement = 38.84
After minimization: energy = -510.30, improvement = 105.34
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -442.94, improvement = 37.98
After minimization: energy = -510.38, improvement = 105.42

Complex relaxation cycle 11/25
After repacking: energy = -444.72, improvement = 39.76
After minimization: energy = -510.44, improvement = 105.48

Complex relaxation cycle 12/25
After repacking: energy = -443.78, improvement = 38.82
After minimization: energy = -510.98, improvement = 106.02
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -442.95, improvement = 37.99
After minimization: energy = -510.97, improvement = 106.01

Complex relaxation cycle 14/25
After repacking: energy = -443.13, improvement = 38.17
After minimization: energy = -510.87, improvement = 105.91

Complex relaxation cycle 15/25
After repacking: energy = -443.69, improvement = 38.73
After minimization: energy = -510.93, improvement = 105.97
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -444.15, improvement = 39.19
After minimization: energy = -510.81, improvement = 105.85

Complex relaxation cycle 17/25
After repacking: energy = -444.19, improvement = 39.23
After minimization: energy = -510.98, improvement = 106.02

Complex relaxation cycle 18/25
After repacking: energy = -443.50, improvement = 38.54
After minimization: energy = -510.98, improvement = 106.02
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -443.80, improvement = 38.83
After minimization: energy = -510.97, improvement = 106.01

Complex relaxation cycle 20/25
After repacking: energy = -444.29, improvement = 39.33
After minimization: energy = -510.99, improvement = 106.03

Complex relaxation cycle 21/25
After repacking: energy = -442.77, improvement = 37.81
After minimization: energy = -510.50, improvement = 105.54
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -444.21, improvement = 39.25
After minimization: energy = -510.39, improvement = 105.43

Complex relaxation cycle 23/25
After repacking: energy = -444.37, improvement = 39.41
After minimization: energy = -510.53, improvement = 105.57

Complex relaxation cycle 24/25
After repacking: energy = -443.90, improvement = 38.94
After minimization: energy = -510.52, improvement = 105.56
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -443.89, improvement = 38.93
After minimization: energy = -510.52, improvement = 105.56

=== Complex Relaxation Summary ===
Initial energy: -404.96
Final energy: -581.85
Total energy improvement: 176.89 (43.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.28 Å
Interface energy: -56.46
Saved relaxed complex structure to docking_results/3_peptide_20mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -581.85
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -56.46

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab0_CDR-L2_combined.pdb
Initial score: 7221.01
  Found better pose: 4471.92
  Found better pose: 3846.88
  Found better pose: 3783.61
  Found better pose: 2084.31
  Found better pose: 1180.82
  Found better pose: 819.67
  Found better pose: 72.01
  Found better pose: -321.16
  Found better pose: -342.94
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -342.94
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -588.25, improvement = 245.30
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -333.94, improvement = -9.00
After minimization: energy = -510.09, improvement = 167.15

Complex relaxation cycle 2/25
After repacking: energy = -377.25, improvement = 34.30
After minimization: energy = -500.46, improvement = 157.51

Complex relaxation cycle 3/25
After repacking: energy = -432.27, improvement = 89.33
After minimization: energy = -506.53, improvement = 163.59

Complex relaxation cycle 4/25
After repacking: energy = -448.42, improvement = 105.48
After minimization: energy = -508.60, improvement = 165.66

Complex relaxation cycle 5/25
After repacking: energy = -398.02, improvement = 55.07
After minimization: energy = -467.52, improvement = 124.58

Complex relaxation cycle 6/25
After repacking: energy = -446.93, improvement = 103.99
After minimization: energy = -508.66, improvement = 165.72
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -446.07, improvement = 103.13
After minimization: energy = -509.00, improvement = 166.05

Complex relaxation cycle 8/25
After repacking: energy = -443.39, improvement = 100.45
After minimization: energy = -508.91, improvement = 165.96

Complex relaxation cycle 9/25
After repacking: energy = -444.12, improvement = 101.17
After minimization: energy = -509.52, improvement = 166.58
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -444.23, improvement = 101.29
After minimization: energy = -510.35, improvement = 167.41

Complex relaxation cycle 11/25
After repacking: energy = -440.38, improvement = 97.44
After minimization: energy = -509.27, improvement = 166.32

Complex relaxation cycle 12/25
After repacking: energy = -437.74, improvement = 94.79
After minimization: energy = -508.05, improvement = 165.11
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -398.79, improvement = 55.85
After minimization: energy = -468.78, improvement = 125.83

Complex relaxation cycle 14/25
After repacking: energy = -440.85, improvement = 97.90
After minimization: energy = -507.97, improvement = 165.02

Complex relaxation cycle 15/25
After repacking: energy = -442.40, improvement = 99.46
After minimization: energy = -508.82, improvement = 165.88
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -442.17, improvement = 99.23
After minimization: energy = -509.19, improvement = 166.24

Complex relaxation cycle 17/25
After repacking: energy = -440.42, improvement = 97.47
After minimization: energy = -508.68, improvement = 165.73

Complex relaxation cycle 18/25
After repacking: energy = -441.82, improvement = 98.88
After minimization: energy = -508.67, improvement = 165.73
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -444.16, improvement = 101.22
After minimization: energy = -508.74, improvement = 165.80

Complex relaxation cycle 20/25
After repacking: energy = -442.80, improvement = 99.86
After minimization: energy = -508.63, improvement = 165.69

Complex relaxation cycle 21/25
After repacking: energy = -442.83, improvement = 99.88
After minimization: energy = -508.72, improvement = 165.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -443.41, improvement = 100.46
After minimization: energy = -508.72, improvement = 165.78

Complex relaxation cycle 23/25
After repacking: energy = -442.94, improvement = 99.99
After minimization: energy = -508.71, improvement = 165.77

Complex relaxation cycle 24/25
After repacking: energy = -443.50, improvement = 100.56
After minimization: energy = -508.70, improvement = 165.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -404.32, improvement = 61.37
After minimization: energy = -469.10, improvement = 126.16

=== Complex Relaxation Summary ===
Initial energy: -342.94
Final energy: -588.25
Total energy improvement: 245.30 (71.5%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.25 Å
Interface energy: -54.31
Saved relaxed complex structure to docking_results/3_peptide_20mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -588.25
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -54.31

Best binding found with CDR-L2, score: -588.25
Docking complete. Results: {'binding_cdr': 'CDR-L2', 'initial_score': -342.94347937483013, 'relaxed_score': -588.2458250196318, 'interface_energy': -54.30779069297478, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 6, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/3_peptide_20mer_Ab0_CDR-L2_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/3_peptide_20mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.05579177039643105), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

----- Processing antibody Ab1 with peptide 3_peptide_20mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/3_peptide_20mer_Ab1...
Peptide sequence: SERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASNGLYVALGLYTYR
Antibody has 240 residues
Peptide has 20 residues
Saving antibody to docking_results/3_peptide_20mer_Ab1_antibody.pdb
Saving peptide to docking_results/3_peptide_20mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab1_CDR-H3_combined.pdb
Initial score: 4990.40
  Found better pose: 3439.83
  Found better pose: 2726.51
  Found better pose: 2618.86
  Found better pose: 2455.82
  Found better pose: 1422.41
  Found better pose: 1101.41
  Found better pose: 641.80
  Found better pose: 57.18
  Found better pose: -32.41
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab1_CDR-H2_combined.pdb
Initial score: 3133.56
  Found better pose: 2143.07
  Found better pose: 1096.07
  Found better pose: 591.68
  Found better pose: 221.03
  Found better pose: -165.71
  Found better pose: -212.51
  Found better pose: -218.92
  Found better pose: -220.88
  Found better pose: -222.25
  Found better pose: -223.73
  Found better pose: -224.40
  Found better pose: -225.24
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab1_CDR-H1_combined.pdb
Initial score: 26036.67
  Found better pose: 25099.92
  Found better pose: 21777.49
  Found better pose: 21740.93
  Found better pose: 19450.37
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab1_CDR-L3_combined.pdb
Initial score: 2252.02
  Found better pose: 1738.49
  Found better pose: 772.10
  Found better pose: 306.23
  Found better pose: 264.50
  Found better pose: -154.16
  Found better pose: -204.69
  Found better pose: -217.88
  Found better pose: -219.09
  Found better pose: -223.19
  Found better pose: -223.89
  Found better pose: -224.61
  Found better pose: -224.65
  Found better pose: -224.67
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -224.67
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -369.24, improvement = 144.57
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 371.63, improvement = -596.30
After minimization: energy = -101.84, improvement = -122.83

Complex relaxation cycle 2/25
After repacking: energy = -204.62, improvement = -20.05
After minimization: energy = -263.06, improvement = 38.39

Complex relaxation cycle 3/25
After repacking: energy = -216.10, improvement = -8.57
After minimization: energy = -265.32, improvement = 40.65

Complex relaxation cycle 4/25
After repacking: energy = -219.04, improvement = -5.62
After minimization: energy = -270.38, improvement = 45.71

Complex relaxation cycle 5/25
After repacking: energy = -207.06, improvement = -17.61
After minimization: energy = -256.07, improvement = 31.40

Complex relaxation cycle 6/25
After repacking: energy = -202.93, improvement = -21.74
After minimization: energy = -257.78, improvement = 33.11
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -219.56, improvement = -5.10
After minimization: energy = -270.35, improvement = 45.68

Complex relaxation cycle 8/25
After repacking: energy = -207.17, improvement = -17.50
After minimization: energy = -258.37, improvement = 33.70

Complex relaxation cycle 9/25
After repacking: energy = -207.04, improvement = -17.63
After minimization: energy = -258.38, improvement = 33.71
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -207.23, improvement = -17.43
After minimization: energy = -258.39, improvement = 33.72

Complex relaxation cycle 11/25
After repacking: energy = -207.26, improvement = -17.41
After minimization: energy = -258.43, improvement = 33.77

Complex relaxation cycle 12/25
After repacking: energy = -207.16, improvement = -17.51
After minimization: energy = -258.45, improvement = 33.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -219.19, improvement = -5.48
After minimization: energy = -270.27, improvement = 45.60

Complex relaxation cycle 14/25
After repacking: energy = -220.40, improvement = -4.27
After minimization: energy = -270.20, improvement = 45.53

Complex relaxation cycle 15/25
After repacking: energy = -210.11, improvement = -14.55
After minimization: energy = -258.29, improvement = 33.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -215.12, improvement = -9.55
After minimization: energy = -264.23, improvement = 39.56

Complex relaxation cycle 17/25
After repacking: energy = -209.40, improvement = -15.27
After minimization: energy = -257.74, improvement = 33.07

Complex relaxation cycle 18/25
After repacking: energy = -208.80, improvement = -15.87
After minimization: energy = -257.73, improvement = 33.06
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -204.88, improvement = -19.79
After minimization: energy = -253.86, improvement = 29.19

Complex relaxation cycle 20/25
After repacking: energy = -221.01, improvement = -3.66
After minimization: energy = -267.75, improvement = 43.08

Complex relaxation cycle 21/25
After repacking: energy = -195.07, improvement = -29.60
After minimization: energy = -242.85, improvement = 18.19
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -205.59, improvement = -19.08
After minimization: energy = -251.71, improvement = 27.04

Complex relaxation cycle 23/25
After repacking: energy = -212.63, improvement = -12.04
After minimization: energy = -256.92, improvement = 32.25

Complex relaxation cycle 24/25
After repacking: energy = -207.94, improvement = -16.72
After minimization: energy = -254.01, improvement = 29.34
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -221.58, improvement = -3.09
After minimization: energy = -261.47, improvement = 36.80

=== Complex Relaxation Summary ===
Initial energy: -224.67
Final energy: -369.24
Total energy improvement: 144.57 (64.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.43 Å
Interface energy: -56.71
Saved relaxed complex structure to docking_results/3_peptide_20mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -369.24
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -56.71

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab1_CDR-L1_combined.pdb
Initial score: -222.38
  Found better pose: -223.20
  Found better pose: -223.74
  Found better pose: -224.54
  Found better pose: -224.58
  Found better pose: -224.70
  Found better pose: -224.79
  Found better pose: -224.92
  Found better pose: -224.93
  Found better pose: -224.93
  Found better pose: -224.93
  Found better pose: -224.93
  Found better pose: -224.93
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -224.93
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -386.27, improvement = 161.34
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 371.64, improvement = -596.57
After minimization: energy = -99.52, improvement = -125.42

Complex relaxation cycle 2/25
After repacking: energy = -177.34, improvement = -47.60
After minimization: energy = -254.91, improvement = 29.97

Complex relaxation cycle 3/25
After repacking: energy = -201.00, improvement = -23.93
After minimization: energy = -255.36, improvement = 30.43

Complex relaxation cycle 4/25
After repacking: energy = -217.87, improvement = -7.06
After minimization: energy = -267.53, improvement = 42.60

Complex relaxation cycle 5/25
After repacking: energy = -217.60, improvement = -7.33
After minimization: energy = -270.25, improvement = 45.32

Complex relaxation cycle 6/25
After repacking: energy = -220.26, improvement = -4.68
After minimization: energy = -270.33, improvement = 45.39
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -220.08, improvement = -4.85
After minimization: energy = -270.41, improvement = 45.48

Complex relaxation cycle 8/25
After repacking: energy = -220.07, improvement = -4.87
After minimization: energy = -265.19, improvement = 40.26

Complex relaxation cycle 9/25
After repacking: energy = -221.32, improvement = -3.61
After minimization: energy = -268.68, improvement = 43.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -220.57, improvement = -4.36
After minimization: energy = -268.45, improvement = 43.52

Complex relaxation cycle 11/25
After repacking: energy = -212.50, improvement = -12.44
After minimization: energy = -256.47, improvement = 31.53

Complex relaxation cycle 12/25
After repacking: energy = -185.37, improvement = -39.56
After minimization: energy = -229.84, improvement = 4.90
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -197.95, improvement = -26.99
After minimization: energy = -239.72, improvement = 14.78

Complex relaxation cycle 14/25
After repacking: energy = -196.13, improvement = -28.80
After minimization: energy = -241.87, improvement = 16.94

Complex relaxation cycle 15/25
After repacking: energy = -224.97, improvement = 0.04
After minimization: energy = -268.47, improvement = 43.53
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -212.60, improvement = -12.33
After minimization: energy = -256.50, improvement = 31.57

Complex relaxation cycle 17/25
After repacking: energy = -212.53, improvement = -12.41
After minimization: energy = -256.45, improvement = 31.52

Complex relaxation cycle 18/25
After repacking: energy = -212.36, improvement = -12.58
After minimization: energy = -256.52, improvement = 31.59
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -224.39, improvement = -0.55
After minimization: energy = -268.47, improvement = 43.54

Complex relaxation cycle 20/25
After repacking: energy = -224.40, improvement = -0.53
After minimization: energy = -268.48, improvement = 43.54

Complex relaxation cycle 21/25
After repacking: energy = -224.11, improvement = -0.82
After minimization: energy = -266.55, improvement = 41.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -216.66, improvement = -8.27
After minimization: energy = -262.06, improvement = 37.12

Complex relaxation cycle 23/25
After repacking: energy = -224.49, improvement = -0.44
After minimization: energy = -268.51, improvement = 43.57

Complex relaxation cycle 24/25
After repacking: energy = -212.50, improvement = -12.44
After minimization: energy = -256.51, improvement = 31.58
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -224.54, improvement = -0.39
After minimization: energy = -266.55, improvement = 41.62

=== Complex Relaxation Summary ===
Initial energy: -224.93
Final energy: -386.27
Total energy improvement: 161.34 (71.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.42 Å
Interface energy: -54.28
Saved relaxed complex structure to docking_results/3_peptide_20mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -386.27
Checking contacts between peptide and CDR-L1...
Found 60 contacts with CDR-L1 (375.0% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -54.28

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-49.50, 53.05, 26.89)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/3_peptide_20mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/3_peptide_20mer_Ab1_CDR-L2_combined.pdb
Initial score: 8566.61
  Found better pose: 5630.96
  Found better pose: 5595.72
  Found better pose: 4781.30
  Found better pose: 3205.08
  Found better pose: 3046.27
  Found better pose: 2366.87
  Found better pose: 1680.00
  Found better pose: 1191.02
  Found better pose: 619.99
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 619.99
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -153.19, improvement = 773.18
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 581.87, improvement = 38.12
After minimization: energy = 55.73, improvement = 564.26

Complex relaxation cycle 2/25
After repacking: energy = 49.41, improvement = 570.58
After minimization: energy = -38.93, improvement = 658.92

Complex relaxation cycle 3/25
After repacking: energy = 20.10, improvement = 599.89
After minimization: energy = -31.05, improvement = 651.04

Complex relaxation cycle 4/25
After repacking: energy = 34.16, improvement = 585.83
After minimization: energy = -16.82, improvement = 636.81

Complex relaxation cycle 5/25
After repacking: energy = 18.94, improvement = 601.05
After minimization: energy = -31.50, improvement = 651.49

Complex relaxation cycle 6/25
After repacking: energy = 14.78, improvement = 605.21
After minimization: energy = -42.79, improvement = 662.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 40.36, improvement = 579.63
After minimization: energy = -16.09, improvement = 636.08

Complex relaxation cycle 8/25
After repacking: energy = 14.17, improvement = 605.82
After minimization: energy = -43.15, improvement = 663.14

Complex relaxation cycle 9/25
After repacking: energy = 14.34, improvement = 605.65
After minimization: energy = -43.37, improvement = 663.36
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 25.81, improvement = 594.18
After minimization: energy = -31.12, improvement = 651.11

Complex relaxation cycle 11/25
After repacking: energy = 41.63, improvement = 578.36
After minimization: energy = -16.65, improvement = 636.64

Complex relaxation cycle 12/25
After repacking: energy = 25.70, improvement = 594.29
After minimization: energy = -31.36, improvement = 651.35
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 20.18, improvement = 599.81
After minimization: energy = -37.20, improvement = 657.19

Complex relaxation cycle 14/25
After repacking: energy = 14.41, improvement = 605.58
After minimization: energy = -42.79, improvement = 662.78

Complex relaxation cycle 15/25
After repacking: energy = 26.17, improvement = 593.82
After minimization: energy = -31.14, improvement = 651.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 13.88, improvement = 606.11
After minimization: energy = -43.14, improvement = 663.13

Complex relaxation cycle 17/25
After repacking: energy = 26.44, improvement = 593.55
After minimization: energy = -31.11, improvement = 651.10

Complex relaxation cycle 18/25
After repacking: energy = 26.41, improvement = 593.58
After minimization: energy = -31.17, improvement = 651.16
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 25.83, improvement = 594.16
After minimization: energy = -31.13, improvement = 651.12

Complex relaxation cycle 20/25
After repacking: energy = 14.72, improvement = 605.27
After minimization: energy = -43.36, improvement = 663.35

Complex relaxation cycle 21/25
After repacking: energy = 26.00, improvement = 593.99
After minimization: energy = -31.16, improvement = 651.16
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 26.16, improvement = 593.83
After minimization: energy = -31.14, improvement = 651.13

Complex relaxation cycle 23/25
After repacking: energy = 25.98, improvement = 594.01
After minimization: energy = -30.94, improvement = 650.93

Complex relaxation cycle 24/25
After repacking: energy = 14.14, improvement = 605.85
After minimization: energy = -43.14, improvement = 663.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 40.01, improvement = 579.98
After minimization: energy = -16.44, improvement = 636.43

=== Complex Relaxation Summary ===
Initial energy: 619.99
Final energy: -153.19
Total energy improvement: 773.18 (124.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.67 Å
Interface energy: 166.74
Saved relaxed complex structure to docking_results/3_peptide_20mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -153.19
Checking contacts between peptide and CDR-L2...
Found 28 contacts with CDR-L2 (350.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 166.74

Best binding found with CDR-L1, score: -386.27
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -224.934875790749, 'relaxed_score': -386.2714255243351, 'interface_energy': -54.284995044065624, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/3_peptide_20mer_Ab1_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/3_peptide_20mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.05579177039643105), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

===== Processing peptide: 5_peptide_12mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/5_peptide_12mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 5_peptide_12mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/5_peptide_12mer_Ab0...
Peptide sequence: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYR
Antibody has 232 residues
Peptide has 12 residues
Saving antibody to docking_results/5_peptide_12mer_Ab0_antibody.pdb
Saving peptide to docking_results/5_peptide_12mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab0_CDR-H3_combined.pdb
Initial score: -399.43
  Found better pose: -399.56
  Found better pose: -399.81
  Found better pose: -400.06
  Found better pose: -400.58
  Found better pose: -400.71
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab0_CDR-H2_combined.pdb
Initial score: -398.86
  Found better pose: -399.50
  Found better pose: -399.68
  Found better pose: -399.86
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab0_CDR-H1_combined.pdb
Initial score: 25027.95
  Found better pose: 23140.07
  Found better pose: 22074.77
  Found better pose: 21513.83
  Found better pose: 18559.44
  Found better pose: 15099.62
  Found better pose: 15067.44
  Found better pose: 14736.53
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab0_CDR-L3_combined.pdb
Initial score: 4326.43
  Found better pose: 4218.57
  Found better pose: 4178.70
  Found better pose: 3600.15
  Found better pose: 3325.58
  Found better pose: 3058.74
  Found better pose: 3010.77
  Found better pose: 1949.62
  Found better pose: 1847.66
  Found better pose: 1225.34
  Found better pose: 1164.70
  Found better pose: 1019.40
  Found better pose: 311.05
  Found better pose: -64.23
  Found better pose: -95.54
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -95.54
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -578.40, improvement = 482.86
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -269.58, improvement = 174.04
After minimization: energy = -508.40, improvement = 412.86

Complex relaxation cycle 2/25
After repacking: energy = -369.18, improvement = 273.64
After minimization: energy = -495.59, improvement = 400.05

Complex relaxation cycle 3/25
After repacking: energy = -429.69, improvement = 334.15
After minimization: energy = -498.97, improvement = 403.43

Complex relaxation cycle 4/25
After repacking: energy = -435.36, improvement = 339.82
After minimization: energy = -499.84, improvement = 404.30

Complex relaxation cycle 5/25
After repacking: energy = -437.97, improvement = 342.44
After minimization: energy = -502.61, improvement = 407.07

Complex relaxation cycle 6/25
After repacking: energy = -437.73, improvement = 342.19
After minimization: energy = -499.43, improvement = 403.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -438.34, improvement = 342.80
After minimization: energy = -502.96, improvement = 407.42

Complex relaxation cycle 8/25
After repacking: energy = -436.93, improvement = 341.39
After minimization: energy = -499.74, improvement = 404.20

Complex relaxation cycle 9/25
After repacking: energy = -440.99, improvement = 345.45
After minimization: energy = -503.52, improvement = 407.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -446.61, improvement = 351.07
After minimization: energy = -506.18, improvement = 410.64

Complex relaxation cycle 11/25
After repacking: energy = -406.19, improvement = 310.65
After minimization: energy = -463.71, improvement = 368.17

Complex relaxation cycle 12/25
After repacking: energy = -446.09, improvement = 350.55
After minimization: energy = -506.19, improvement = 410.65
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -444.73, improvement = 349.19
After minimization: energy = -503.41, improvement = 407.87

Complex relaxation cycle 14/25
After repacking: energy = -445.71, improvement = 350.17
After minimization: energy = -506.18, improvement = 410.64

Complex relaxation cycle 15/25
After repacking: energy = -445.52, improvement = 349.98
After minimization: energy = -503.32, improvement = 407.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -446.26, improvement = 350.72
After minimization: energy = -505.87, improvement = 410.33

Complex relaxation cycle 17/25
After repacking: energy = -445.96, improvement = 350.42
After minimization: energy = -503.46, improvement = 407.92

Complex relaxation cycle 18/25
After repacking: energy = -445.71, improvement = 350.17
After minimization: energy = -506.38, improvement = 410.84
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -444.01, improvement = 348.47
After minimization: energy = -503.72, improvement = 408.18

Complex relaxation cycle 20/25
After repacking: energy = -446.15, improvement = 350.61
After minimization: energy = -506.01, improvement = 410.47

Complex relaxation cycle 21/25
After repacking: energy = -447.17, improvement = 351.63
After minimization: energy = -503.43, improvement = 407.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -445.93, improvement = 350.39
After minimization: energy = -506.12, improvement = 410.58

Complex relaxation cycle 23/25
After repacking: energy = -445.96, improvement = 350.42
After minimization: energy = -503.44, improvement = 407.90

Complex relaxation cycle 24/25
After repacking: energy = -447.00, improvement = 351.46
After minimization: energy = -506.05, improvement = 410.51
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -446.25, improvement = 350.71
After minimization: energy = -503.49, improvement = 407.95

=== Complex Relaxation Summary ===
Initial energy: -95.54
Final energy: -578.40
Total energy improvement: 482.86 (505.4%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.32 Å
Interface energy: -52.48
Saved relaxed complex structure to docking_results/5_peptide_12mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -578.40
Checking contacts between peptide and CDR-L3...
Found 41 contacts with CDR-L3 (372.7% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -52.48

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab0_CDR-L1_combined.pdb
Initial score: 1480.41
  Found better pose: 454.34
  Found better pose: 347.25
  Found better pose: 204.42
  Found better pose: 198.37
  Found better pose: -309.56
  Found better pose: -357.61
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -357.61
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -576.76, improvement = 219.15
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -334.45, improvement = -23.16
After minimization: energy = -505.82, improvement = 148.21

Complex relaxation cycle 2/25
After repacking: energy = -359.87, improvement = 2.26
After minimization: energy = -492.18, improvement = 134.57

Complex relaxation cycle 3/25
After repacking: energy = -414.96, improvement = 57.35
After minimization: energy = -498.53, improvement = 140.92

Complex relaxation cycle 4/25
After repacking: energy = -440.65, improvement = 83.04
After minimization: energy = -513.44, improvement = 155.83

Complex relaxation cycle 5/25
After repacking: energy = -406.54, improvement = 48.93
After minimization: energy = -498.06, improvement = 140.45

Complex relaxation cycle 6/25
After repacking: energy = -445.57, improvement = 87.96
After minimization: energy = -505.85, improvement = 148.24
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -438.53, improvement = 80.92
After minimization: energy = -503.03, improvement = 145.42

Complex relaxation cycle 8/25
After repacking: energy = -436.98, improvement = 79.37
After minimization: energy = -502.93, improvement = 145.33

Complex relaxation cycle 9/25
After repacking: energy = -433.75, improvement = 76.14
After minimization: energy = -503.06, improvement = 145.45
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -433.83, improvement = 76.22
After minimization: energy = -502.96, improvement = 145.35

Complex relaxation cycle 11/25
After repacking: energy = -434.01, improvement = 76.40
After minimization: energy = -503.01, improvement = 145.40

Complex relaxation cycle 12/25
After repacking: energy = -433.42, improvement = 75.81
After minimization: energy = -502.96, improvement = 145.35
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -434.17, improvement = 76.56
After minimization: energy = -503.04, improvement = 145.43

Complex relaxation cycle 14/25
After repacking: energy = -432.74, improvement = 75.13
After minimization: energy = -503.03, improvement = 145.42

Complex relaxation cycle 15/25
After repacking: energy = -432.52, improvement = 74.91
After minimization: energy = -503.08, improvement = 145.47
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -433.98, improvement = 76.37
After minimization: energy = -503.08, improvement = 145.47

Complex relaxation cycle 17/25
After repacking: energy = -433.85, improvement = 76.24
After minimization: energy = -502.90, improvement = 145.29

Complex relaxation cycle 18/25
After repacking: energy = -434.21, improvement = 76.60
After minimization: energy = -502.91, improvement = 145.30
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -433.90, improvement = 76.29
After minimization: energy = -502.84, improvement = 145.23

Complex relaxation cycle 20/25
After repacking: energy = -434.50, improvement = 76.89
After minimization: energy = -503.03, improvement = 145.42

Complex relaxation cycle 21/25
After repacking: energy = -432.31, improvement = 74.70
After minimization: energy = -502.89, improvement = 145.28
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -435.26, improvement = 77.65
After minimization: energy = -502.91, improvement = 145.30

Complex relaxation cycle 23/25
After repacking: energy = -434.84, improvement = 77.23
After minimization: energy = -503.05, improvement = 145.44

Complex relaxation cycle 24/25
After repacking: energy = -433.46, improvement = 75.85
After minimization: energy = -503.03, improvement = 145.42
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -433.01, improvement = 75.40
After minimization: energy = -502.94, improvement = 145.33

=== Complex Relaxation Summary ===
Initial energy: -357.61
Final energy: -576.76
Total energy improvement: 219.15 (61.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.31 Å
Interface energy: -50.03
Saved relaxed complex structure to docking_results/5_peptide_12mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -576.76
Checking contacts between peptide and CDR-L1...
Found 58 contacts with CDR-L1 (362.5% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -50.03

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab0_CDR-L2_combined.pdb
Initial score: 13056.34
  Found better pose: 9401.07
  Found better pose: 8968.82
  Found better pose: 8288.01
  Found better pose: 8025.25
  Found better pose: 6936.19
  Found better pose: 6601.35
  Found better pose: 6547.83
  Found better pose: 6375.52
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 6375.52
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 3820.26, improvement = 2555.26
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 5305.99, improvement = 1069.52
After minimization: energy = 5139.28, improvement = 1236.24

Complex relaxation cycle 2/25
After repacking: energy = 5284.27, improvement = 1091.25
After minimization: energy = 5146.56, improvement = 1228.96

Complex relaxation cycle 3/25
After repacking: energy = 5221.84, improvement = 1153.68
After minimization: energy = 5148.84, improvement = 1226.68

Complex relaxation cycle 4/25
After repacking: energy = 5247.75, improvement = 1127.77
After minimization: energy = 5187.12, improvement = 1188.40

Complex relaxation cycle 5/25
After repacking: energy = 5196.63, improvement = 1178.89
After minimization: energy = 5147.33, improvement = 1228.18

Complex relaxation cycle 6/25
After repacking: energy = 5194.00, improvement = 1181.51
After minimization: energy = 5156.73, improvement = 1218.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 5176.54, improvement = 1198.98
After minimization: energy = 5149.43, improvement = 1226.08

Complex relaxation cycle 8/25
After repacking: energy = 5188.98, improvement = 1186.53
After minimization: energy = 5147.36, improvement = 1228.16

Complex relaxation cycle 9/25
After repacking: energy = 5193.62, improvement = 1181.89
After minimization: energy = 5148.29, improvement = 1227.23
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 5189.96, improvement = 1185.55
After minimization: energy = 5148.40, improvement = 1227.11

Complex relaxation cycle 11/25
After repacking: energy = 5186.02, improvement = 1189.50
After minimization: energy = 5149.33, improvement = 1226.18

Complex relaxation cycle 12/25
After repacking: energy = 5183.43, improvement = 1192.08
After minimization: energy = 5149.27, improvement = 1226.25
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 5184.40, improvement = 1191.11
After minimization: energy = 5152.80, improvement = 1222.72

Complex relaxation cycle 14/25
After repacking: energy = 5182.27, improvement = 1193.25
After minimization: energy = 5153.08, improvement = 1222.44

Complex relaxation cycle 15/25
After repacking: energy = 5181.56, improvement = 1193.96
After minimization: energy = 5151.72, improvement = 1223.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 5189.77, improvement = 1185.75
After minimization: energy = 5157.43, improvement = 1218.08

Complex relaxation cycle 17/25
After repacking: energy = 5176.75, improvement = 1198.77
After minimization: energy = 5154.20, improvement = 1221.31

Complex relaxation cycle 18/25
After repacking: energy = 5180.82, improvement = 1194.69
After minimization: energy = 5148.05, improvement = 1227.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 5195.85, improvement = 1179.67
After minimization: energy = 5149.88, improvement = 1225.63

Complex relaxation cycle 20/25
After repacking: energy = 5188.89, improvement = 1186.63
After minimization: energy = 5147.40, improvement = 1228.12

Complex relaxation cycle 21/25
After repacking: energy = 5196.39, improvement = 1179.12
After minimization: energy = 5149.26, improvement = 1226.26
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 5193.96, improvement = 1181.56
After minimization: energy = 5149.96, improvement = 1225.56

Complex relaxation cycle 23/25
After repacking: energy = 5189.60, improvement = 1185.92
After minimization: energy = 5150.25, improvement = 1225.27

Complex relaxation cycle 24/25
After repacking: energy = 5188.77, improvement = 1186.75
After minimization: energy = 5151.20, improvement = 1224.32
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 5208.14, improvement = 1167.37
After minimization: energy = 5148.76, improvement = 1226.75

=== Complex Relaxation Summary ===
Initial energy: 6375.52
Final energy: 3820.26
Total energy improvement: 2555.26 (40.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.26 Å
Interface energy: 4217.67
Saved relaxed complex structure to docking_results/5_peptide_12mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 3820.26
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 4217.67

Best binding found with CDR-L3, score: -578.40
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -95.53972740061766, 'relaxed_score': -578.4046109646363, 'interface_energy': -52.48441104831386, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 7, 'salt_bridges': 0, 'hydrophobic': 8, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/5_peptide_12mer_Ab0_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/5_peptide_12mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 5_peptide_12mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/5_peptide_12mer_Ab1...
Peptide sequence: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYR
Antibody has 240 residues
Peptide has 12 residues
Saving antibody to docking_results/5_peptide_12mer_Ab1_antibody.pdb
Saving peptide to docking_results/5_peptide_12mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab1_CDR-H3_combined.pdb
Initial score: 13829.04
  Found better pose: 9399.63
  Found better pose: 8246.09
  Found better pose: 4417.61
  Found better pose: 4029.48
  Found better pose: 4019.39
  Found better pose: 2445.07
  Found better pose: 2201.12
  Found better pose: 1719.28
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab1_CDR-H2_combined.pdb
Initial score: -221.98
  Found better pose: -222.32
  Found better pose: -222.39
  Found better pose: -223.35
  Found better pose: -223.86
  Found better pose: -224.05
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab1_CDR-H1_combined.pdb
Initial score: 20521.91
  Found better pose: 20443.41
  Found better pose: 20254.45
  Found better pose: 18462.32
  Found better pose: 18362.20
  Found better pose: 18235.29
  Found better pose: 17806.90
  Found better pose: 17180.37
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab1_CDR-L3_combined.pdb
Initial score: 5025.86
  Found better pose: 4733.43
  Found better pose: 3919.34
  Found better pose: 3680.49
  Found better pose: 2389.62
  Found better pose: 1436.51
  Found better pose: 1175.26
  Found better pose: 1128.93
  Found better pose: 1043.34
  Found better pose: 329.95
  Found better pose: -10.12
  Found better pose: -162.72
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -162.72
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -348.40, improvement = 185.68
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 1426.70, improvement = -1589.42
After minimization: energy = 943.96, improvement = -1106.69

Complex relaxation cycle 2/25
After repacking: energy = -21.35, improvement = -141.37
After minimization: energy = -198.35, improvement = 35.63

Complex relaxation cycle 3/25
After repacking: energy = -147.12, improvement = -15.60
After minimization: energy = -208.05, improvement = 45.33

Complex relaxation cycle 4/25
After repacking: energy = -143.29, improvement = -19.43
After minimization: energy = -196.78, improvement = 34.06

Complex relaxation cycle 5/25
After repacking: energy = -153.85, improvement = -8.87
After minimization: energy = -209.21, improvement = 46.49

Complex relaxation cycle 6/25
After repacking: energy = -151.97, improvement = -10.75
After minimization: energy = -208.80, improvement = 46.08
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -141.59, improvement = -21.13
After minimization: energy = -197.15, improvement = 34.43

Complex relaxation cycle 8/25
After repacking: energy = -151.90, improvement = -10.82
After minimization: energy = -208.78, improvement = 46.06

Complex relaxation cycle 9/25
After repacking: energy = -139.81, improvement = -22.92
After minimization: energy = -196.83, improvement = 34.11
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -122.06, improvement = -40.66
After minimization: energy = -182.08, improvement = 19.36

Complex relaxation cycle 11/25
After repacking: energy = -140.41, improvement = -22.31
After minimization: energy = -197.18, improvement = 34.46

Complex relaxation cycle 12/25
After repacking: energy = -155.14, improvement = -7.58
After minimization: energy = -209.20, improvement = 46.48
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -137.64, improvement = -25.08
After minimization: energy = -206.73, improvement = 44.01

Complex relaxation cycle 14/25
After repacking: energy = -150.35, improvement = -12.37
After minimization: energy = -221.42, improvement = 58.70

Complex relaxation cycle 15/25
After repacking: energy = -151.73, improvement = -10.99
After minimization: energy = -221.27, improvement = 58.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -145.87, improvement = -16.85
After minimization: energy = -200.71, improvement = 37.99

Complex relaxation cycle 17/25
After repacking: energy = -159.71, improvement = -3.01
After minimization: energy = -210.75, improvement = 48.03

Complex relaxation cycle 18/25
After repacking: energy = -160.21, improvement = -2.51
After minimization: energy = -225.91, improvement = 63.19
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -162.04, improvement = -0.68
After minimization: energy = -227.25, improvement = 64.53

Complex relaxation cycle 20/25
After repacking: energy = -162.55, improvement = -0.17
After minimization: energy = -220.69, improvement = 57.97

Complex relaxation cycle 21/25
After repacking: energy = -153.92, improvement = -8.80
After minimization: energy = -217.04, improvement = 54.32
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -102.89, improvement = -59.84
After minimization: energy = -215.69, improvement = 52.97

Complex relaxation cycle 23/25
After repacking: energy = -132.55, improvement = -30.17
After minimization: energy = -202.48, improvement = 39.76

Complex relaxation cycle 24/25
After repacking: energy = -114.93, improvement = -47.79
After minimization: energy = -181.92, improvement = 19.20
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -151.71, improvement = -11.01
After minimization: energy = -217.10, improvement = 54.38

=== Complex Relaxation Summary ===
Initial energy: -162.72
Final energy: -348.40
Total energy improvement: 185.68 (114.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.52 Å
Interface energy: -26.20
Saved relaxed complex structure to docking_results/5_peptide_12mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -348.40
Checking contacts between peptide and CDR-L3...
Found 41 contacts with CDR-L3 (372.7% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -26.20

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab1_CDR-L1_combined.pdb
Initial score: 6102.40
  Found better pose: 5130.37
  Found better pose: 4963.39
  Found better pose: 3442.92
  Found better pose: 3107.87
  Found better pose: 1589.20
  Found better pose: 1345.98
  Found better pose: 867.80
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 867.80
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -353.42, improvement = 1221.22
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 369.97, improvement = 497.83
After minimization: energy = -156.74, improvement = 1024.54

Complex relaxation cycle 2/25
After repacking: energy = -174.45, improvement = 1042.26
After minimization: energy = -236.64, improvement = 1104.44

Complex relaxation cycle 3/25
After repacking: energy = -184.08, improvement = 1051.89
After minimization: energy = -238.77, improvement = 1106.57

Complex relaxation cycle 4/25
After repacking: energy = -131.43, improvement = 999.24
After minimization: energy = -200.68, improvement = 1068.48

Complex relaxation cycle 5/25
After repacking: energy = -171.21, improvement = 1039.01
After minimization: energy = -229.80, improvement = 1097.60

Complex relaxation cycle 6/25
After repacking: energy = -184.92, improvement = 1052.72
After minimization: energy = -240.74, improvement = 1108.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -174.43, improvement = 1042.24
After minimization: energy = -230.08, improvement = 1097.88

Complex relaxation cycle 8/25
After repacking: energy = -146.54, improvement = 1014.34
After minimization: energy = -203.49, improvement = 1071.30

Complex relaxation cycle 9/25
After repacking: energy = -178.73, improvement = 1046.54
After minimization: energy = -236.17, improvement = 1103.97
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -184.63, improvement = 1052.43
After minimization: energy = -242.22, improvement = 1110.02

Complex relaxation cycle 11/25
After repacking: energy = -172.72, improvement = 1040.52
After minimization: energy = -228.89, improvement = 1096.69

Complex relaxation cycle 12/25
After repacking: energy = -186.55, improvement = 1054.36
After minimization: energy = -242.11, improvement = 1109.91
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -184.48, improvement = 1052.28
After minimization: energy = -240.77, improvement = 1108.58

Complex relaxation cycle 14/25
After repacking: energy = -173.63, improvement = 1041.44
After minimization: energy = -228.87, improvement = 1096.67

Complex relaxation cycle 15/25
After repacking: energy = -173.63, improvement = 1041.43
After minimization: energy = -230.14, improvement = 1097.94
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -172.91, improvement = 1040.71
After minimization: energy = -230.15, improvement = 1097.95

Complex relaxation cycle 17/25
After repacking: energy = -157.45, improvement = 1025.25
After minimization: energy = -215.48, improvement = 1083.28

Complex relaxation cycle 18/25
After repacking: energy = -184.61, improvement = 1052.42
After minimization: energy = -242.19, improvement = 1109.99
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -172.61, improvement = 1040.41
After minimization: energy = -229.74, improvement = 1097.54

Complex relaxation cycle 20/25
After repacking: energy = -159.49, improvement = 1027.30
After minimization: energy = -215.36, improvement = 1083.16

Complex relaxation cycle 21/25
After repacking: energy = -186.17, improvement = 1053.97
After minimization: energy = -242.06, improvement = 1109.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -174.00, improvement = 1041.80
After minimization: energy = -228.86, improvement = 1096.66

Complex relaxation cycle 23/25
After repacking: energy = -187.54, improvement = 1055.34
After minimization: energy = -242.06, improvement = 1109.86

Complex relaxation cycle 24/25
After repacking: energy = -185.93, improvement = 1053.73
After minimization: energy = -240.54, improvement = 1108.34
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -175.54, improvement = 1043.34
After minimization: energy = -229.98, improvement = 1097.78

=== Complex Relaxation Summary ===
Initial energy: 867.80
Final energy: -353.42
Total energy improvement: 1221.22 (140.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.69 Å
Interface energy: -26.02
Saved relaxed complex structure to docking_results/5_peptide_12mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -353.42
Checking contacts between peptide and CDR-L1...
Found 62 contacts with CDR-L1 (387.5% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -26.02

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-41.11, 51.74, 3.73)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/5_peptide_12mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/5_peptide_12mer_Ab1_CDR-L2_combined.pdb
Initial score: 12466.56
  Found better pose: 11152.75
  Found better pose: 9322.87
  Found better pose: 8757.18
  Found better pose: 8230.25
  Found better pose: 7816.79
  Found better pose: 6812.48
  Found better pose: 6136.74
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 6136.74
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 1674.22, improvement = 4462.51
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 3853.15, improvement = 2283.59
After minimization: energy = 3325.75, improvement = 2810.99

Complex relaxation cycle 2/25
After repacking: energy = 3316.50, improvement = 2820.23
After minimization: energy = 3252.23, improvement = 2884.51

Complex relaxation cycle 3/25
After repacking: energy = 3310.33, improvement = 2826.41
After minimization: energy = 3246.68, improvement = 2890.06

Complex relaxation cycle 4/25
After repacking: energy = 3278.47, improvement = 2858.27
After minimization: energy = 3236.02, improvement = 2900.71

Complex relaxation cycle 5/25
After repacking: energy = 3264.85, improvement = 2871.89
After minimization: energy = 3235.33, improvement = 2901.40

Complex relaxation cycle 6/25
After repacking: energy = 3276.36, improvement = 2860.38
After minimization: energy = 3249.16, improvement = 2887.58
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 3264.73, improvement = 2872.00
After minimization: energy = 3235.83, improvement = 2900.90

Complex relaxation cycle 8/25
After repacking: energy = 3306.77, improvement = 2829.97
After minimization: energy = 3275.66, improvement = 2861.08

Complex relaxation cycle 9/25
After repacking: energy = 3981.75, improvement = 2154.99
After minimization: energy = 3951.90, improvement = 2184.84
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 3269.99, improvement = 2866.74
After minimization: energy = 3243.72, improvement = 2893.02

Complex relaxation cycle 11/25
After repacking: energy = 3282.98, improvement = 2853.75
After minimization: energy = 3251.35, improvement = 2885.39

Complex relaxation cycle 12/25
After repacking: energy = 3268.38, improvement = 2868.36
After minimization: energy = 3245.21, improvement = 2891.53
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 3269.63, improvement = 2867.10
After minimization: energy = 3245.10, improvement = 2891.63

Complex relaxation cycle 14/25
After repacking: energy = 3270.63, improvement = 2866.11
After minimization: energy = 3244.57, improvement = 2892.16

Complex relaxation cycle 15/25
After repacking: energy = 3271.22, improvement = 2865.51
After minimization: energy = 3243.96, improvement = 2892.77
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 3269.95, improvement = 2866.79
After minimization: energy = 3246.85, improvement = 2889.88

Complex relaxation cycle 17/25
After repacking: energy = 3270.20, improvement = 2866.54
After minimization: energy = 3247.81, improvement = 2888.93

Complex relaxation cycle 18/25
After repacking: energy = 3266.21, improvement = 2870.53
After minimization: energy = 3240.93, improvement = 2895.81
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 3268.82, improvement = 2867.92
After minimization: energy = 3252.17, improvement = 2884.57

Complex relaxation cycle 20/25
After repacking: energy = 3261.78, improvement = 2874.95
After minimization: energy = 3237.36, improvement = 2899.37

Complex relaxation cycle 21/25
After repacking: energy = 3264.17, improvement = 2872.56
After minimization: energy = 3239.00, improvement = 2897.73
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 3274.39, improvement = 2862.35
After minimization: energy = 3249.00, improvement = 2887.74

Complex relaxation cycle 23/25
After repacking: energy = 3262.44, improvement = 2874.30
After minimization: energy = 3236.59, improvement = 2900.14

Complex relaxation cycle 24/25
After repacking: energy = 3278.96, improvement = 2857.77
After minimization: energy = 3246.70, improvement = 2890.04
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 3265.24, improvement = 2871.50
After minimization: energy = 3226.79, improvement = 2909.94

=== Complex Relaxation Summary ===
Initial energy: 6136.74
Final energy: 1674.22
Total energy improvement: 4462.51 (72.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.50 Å
Interface energy: 1600.17
Saved relaxed complex structure to docking_results/5_peptide_12mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 1674.22
Checking contacts between peptide and CDR-L2...
Found 28 contacts with CDR-L2 (350.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 1600.17

Best binding found with CDR-L1, score: -353.42
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': 867.8021127493924, 'relaxed_score': -353.4173451325881, 'interface_energy': -26.021994892959242, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/5_peptide_12mer_Ab1_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/5_peptide_12mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 1_peptide_12mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/1_peptide_12mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 1_peptide_12mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/1_peptide_12mer_Ab0...
Peptide sequence: ALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLN
Antibody has 232 residues
Peptide has 12 residues
Saving antibody to docking_results/1_peptide_12mer_Ab0_antibody.pdb
Saving peptide to docking_results/1_peptide_12mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab0_CDR-H3_combined.pdb
Initial score: -403.48
  Found better pose: -403.61
  Found better pose: -403.63
  Found better pose: -403.63
  Found better pose: -403.63
  Found better pose: -403.63
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab0_CDR-H2_combined.pdb
Initial score: -387.34
  Found better pose: -403.50
  Found better pose: -403.80
  Found better pose: -404.37
  Found better pose: -404.51
  Found better pose: -405.38
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab0_CDR-H1_combined.pdb
Initial score: 29792.72
  Found better pose: 28533.69
  Found better pose: 27956.56
  Found better pose: 26123.34
  Found better pose: 25137.88
  Found better pose: 24941.75
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab0_CDR-L3_combined.pdb
Initial score: -342.71
  Found better pose: -402.05
  Found better pose: -403.68
  Found better pose: -403.78
  Found better pose: -404.61
  Found better pose: -404.76
  Found better pose: -404.91
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -404.91
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -585.98, improvement = 181.06
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -344.95, improvement = -59.97
After minimization: energy = -517.18, improvement = 112.26

Complex relaxation cycle 2/25
After repacking: energy = -381.98, improvement = -22.93
After minimization: energy = -507.15, improvement = 102.24

Complex relaxation cycle 3/25
After repacking: energy = -448.12, improvement = 43.20
After minimization: energy = -511.70, improvement = 106.79

Complex relaxation cycle 4/25
After repacking: energy = -458.07, improvement = 53.16
After minimization: energy = -512.20, improvement = 107.29

Complex relaxation cycle 5/25
After repacking: energy = -456.42, improvement = 51.51
After minimization: energy = -512.11, improvement = 107.20

Complex relaxation cycle 6/25
After repacking: energy = -457.62, improvement = 52.71
After minimization: energy = -511.38, improvement = 106.47
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -456.69, improvement = 51.77
After minimization: energy = -511.93, improvement = 107.02

Complex relaxation cycle 8/25
After repacking: energy = -457.52, improvement = 52.61
After minimization: energy = -511.34, improvement = 106.43

Complex relaxation cycle 9/25
After repacking: energy = -456.59, improvement = 51.68
After minimization: energy = -511.35, improvement = 106.44
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -457.42, improvement = 52.51
After minimization: energy = -511.31, improvement = 106.40

Complex relaxation cycle 11/25
After repacking: energy = -456.75, improvement = 51.84
After minimization: energy = -511.93, improvement = 107.02

Complex relaxation cycle 12/25
After repacking: energy = -456.50, improvement = 51.59
After minimization: energy = -512.05, improvement = 107.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -456.66, improvement = 51.75
After minimization: energy = -511.92, improvement = 107.01

Complex relaxation cycle 14/25
After repacking: energy = -456.40, improvement = 51.49
After minimization: energy = -511.93, improvement = 107.02

Complex relaxation cycle 15/25
After repacking: energy = -456.67, improvement = 51.76
After minimization: energy = -511.35, improvement = 106.44
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -456.68, improvement = 51.77
After minimization: energy = -511.95, improvement = 107.04

Complex relaxation cycle 17/25
After repacking: energy = -417.46, improvement = 12.55
After minimization: energy = -471.65, improvement = 66.73

Complex relaxation cycle 18/25
After repacking: energy = -456.39, improvement = 51.47
After minimization: energy = -511.96, improvement = 107.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -457.24, improvement = 52.32
After minimization: energy = -511.83, improvement = 106.91

Complex relaxation cycle 20/25
After repacking: energy = -456.86, improvement = 51.95
After minimization: energy = -511.98, improvement = 107.07

Complex relaxation cycle 21/25
After repacking: energy = -456.87, improvement = 51.96
After minimization: energy = -511.36, improvement = 106.45
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -456.44, improvement = 51.53
After minimization: energy = -511.90, improvement = 106.99

Complex relaxation cycle 23/25
After repacking: energy = -456.66, improvement = 51.75
After minimization: energy = -511.41, improvement = 106.50

Complex relaxation cycle 24/25
After repacking: energy = -456.26, improvement = 51.35
After minimization: energy = -512.04, improvement = 107.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -456.77, improvement = 51.86
After minimization: energy = -511.48, improvement = 106.56

=== Complex Relaxation Summary ===
Initial energy: -404.91
Final energy: -585.98
Total energy improvement: 181.06 (44.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.24 Å
Interface energy: -56.42
Saved relaxed complex structure to docking_results/1_peptide_12mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -585.98
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -56.42

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab0_CDR-L1_combined.pdb
Initial score: -395.05
  Found better pose: -404.03
  Found better pose: -404.20
  Found better pose: -404.84
  Found better pose: -405.00
  Found better pose: -405.66
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -405.66
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -586.46, improvement = 180.81
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -343.32, improvement = -62.34
After minimization: energy = -517.56, improvement = 111.91

Complex relaxation cycle 2/25
After repacking: energy = -389.99, improvement = -15.66
After minimization: energy = -499.23, improvement = 93.57

Complex relaxation cycle 3/25
After repacking: energy = -438.62, improvement = 32.96
After minimization: energy = -506.79, improvement = 101.14

Complex relaxation cycle 4/25
After repacking: energy = -425.46, improvement = 19.80
After minimization: energy = -506.38, improvement = 100.73

Complex relaxation cycle 5/25
After repacking: energy = -446.58, improvement = 40.93
After minimization: energy = -507.65, improvement = 101.99

Complex relaxation cycle 6/25
After repacking: energy = -447.92, improvement = 42.26
After minimization: energy = -507.82, improvement = 102.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -447.18, improvement = 41.52
After minimization: energy = -507.10, improvement = 101.44

Complex relaxation cycle 8/25
After repacking: energy = -449.28, improvement = 43.63
After minimization: energy = -507.67, improvement = 102.01

Complex relaxation cycle 9/25
After repacking: energy = -448.26, improvement = 42.61
After minimization: energy = -507.77, improvement = 102.11
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -446.83, improvement = 41.17
After minimization: energy = -507.73, improvement = 102.08

Complex relaxation cycle 11/25
After repacking: energy = -446.94, improvement = 41.29
After minimization: energy = -507.56, improvement = 101.90

Complex relaxation cycle 12/25
After repacking: energy = -407.50, improvement = 1.84
After minimization: energy = -468.58, improvement = 62.92
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -407.16, improvement = 1.50
After minimization: energy = -467.60, improvement = 61.94

Complex relaxation cycle 14/25
After repacking: energy = -446.48, improvement = 40.83
After minimization: energy = -508.19, improvement = 102.53

Complex relaxation cycle 15/25
After repacking: energy = -445.56, improvement = 39.91
After minimization: energy = -508.19, improvement = 102.53
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -405.67, improvement = 0.01
After minimization: energy = -473.55, improvement = 67.89

Complex relaxation cycle 17/25
After repacking: energy = -446.74, improvement = 41.08
After minimization: energy = -511.81, improvement = 106.15

Complex relaxation cycle 18/25
After repacking: energy = -445.47, improvement = 39.81
After minimization: energy = -512.46, improvement = 106.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -446.62, improvement = 40.96
After minimization: energy = -513.75, improvement = 108.09

Complex relaxation cycle 20/25
After repacking: energy = -446.90, improvement = 41.24
After minimization: energy = -513.82, improvement = 108.17

Complex relaxation cycle 21/25
After repacking: energy = -406.17, improvement = 0.51
After minimization: energy = -473.93, improvement = 68.27
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -443.56, improvement = 37.91
After minimization: energy = -513.77, improvement = 108.11

Complex relaxation cycle 23/25
After repacking: energy = -441.73, improvement = 36.08
After minimization: energy = -513.14, improvement = 107.49

Complex relaxation cycle 24/25
After repacking: energy = -442.29, improvement = 36.63
After minimization: energy = -513.56, improvement = 107.90
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -428.30, improvement = 22.65
After minimization: energy = -494.84, improvement = 89.19

=== Complex Relaxation Summary ===
Initial energy: -405.66
Final energy: -586.46
Total energy improvement: 180.81 (44.6%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.27 Å
Interface energy: -56.90
Saved relaxed complex structure to docking_results/1_peptide_12mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -586.46
Checking contacts between peptide and CDR-L1...
Found 59 contacts with CDR-L1 (368.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -56.90

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab0_CDR-L2_combined.pdb
Initial score: 4374.10
  Found better pose: 1543.34
  Found better pose: 691.73
  Found better pose: 162.59
  Found better pose: -390.80
  Found better pose: -403.16
  Found better pose: -404.47
  Found better pose: -404.90
  Found better pose: -405.50
  Found better pose: -405.98
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -405.98
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -592.45, improvement = 186.47
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -344.06, improvement = -61.92
After minimization: energy = -517.30, improvement = 111.32

Complex relaxation cycle 2/25
After repacking: energy = -363.03, improvement = -42.96
After minimization: energy = -505.93, improvement = 99.94

Complex relaxation cycle 3/25
After repacking: energy = -439.42, improvement = 33.44
After minimization: energy = -511.78, improvement = 105.79

Complex relaxation cycle 4/25
After repacking: energy = -460.32, improvement = 54.34
After minimization: energy = -515.81, improvement = 109.83

Complex relaxation cycle 5/25
After repacking: energy = -455.77, improvement = 49.78
After minimization: energy = -514.80, improvement = 108.81

Complex relaxation cycle 6/25
After repacking: energy = -450.96, improvement = 44.97
After minimization: energy = -516.01, improvement = 110.02
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -448.74, improvement = 42.75
After minimization: energy = -515.45, improvement = 109.46

Complex relaxation cycle 8/25
After repacking: energy = -446.10, improvement = 40.11
After minimization: energy = -516.59, improvement = 110.60

Complex relaxation cycle 9/25
After repacking: energy = -426.93, improvement = 20.95
After minimization: energy = -515.08, improvement = 109.09
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -443.13, improvement = 37.14
After minimization: energy = -517.45, improvement = 111.46

Complex relaxation cycle 11/25
After repacking: energy = -442.37, improvement = 36.38
After minimization: energy = -516.30, improvement = 110.32

Complex relaxation cycle 12/25
After repacking: energy = -439.11, improvement = 33.12
After minimization: energy = -516.86, improvement = 110.87
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -436.49, improvement = 30.51
After minimization: energy = -517.02, improvement = 111.04

Complex relaxation cycle 14/25
After repacking: energy = -434.32, improvement = 28.34
After minimization: energy = -516.44, improvement = 110.46

Complex relaxation cycle 15/25
After repacking: energy = -439.04, improvement = 33.05
After minimization: energy = -516.46, improvement = 110.47
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -441.52, improvement = 35.53
After minimization: energy = -516.49, improvement = 110.51

Complex relaxation cycle 17/25
After repacking: energy = -442.24, improvement = 36.25
After minimization: energy = -516.50, improvement = 110.51

Complex relaxation cycle 18/25
After repacking: energy = -442.02, improvement = 36.03
After minimization: energy = -516.34, improvement = 110.36
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -423.66, improvement = 17.67
After minimization: energy = -515.35, improvement = 109.37

Complex relaxation cycle 20/25
After repacking: energy = -441.92, improvement = 35.94
After minimization: energy = -517.84, improvement = 111.86

Complex relaxation cycle 21/25
After repacking: energy = -441.63, improvement = 35.64
After minimization: energy = -517.87, improvement = 111.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -439.68, improvement = 33.69
After minimization: energy = -516.32, improvement = 110.33

Complex relaxation cycle 23/25
After repacking: energy = -421.60, improvement = 15.62
After minimization: energy = -515.24, improvement = 109.25

Complex relaxation cycle 24/25
After repacking: energy = -443.37, improvement = 37.38
After minimization: energy = -519.16, improvement = 113.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -444.68, improvement = 38.70
After minimization: energy = -519.10, improvement = 113.11

=== Complex Relaxation Summary ===
Initial energy: -405.98
Final energy: -592.45
Total energy improvement: 186.47 (45.9%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.28 Å
Interface energy: -60.75
Saved relaxed complex structure to docking_results/1_peptide_12mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -592.45
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -60.75

Best binding found with CDR-L2, score: -592.45
Docking complete. Results: {'binding_cdr': 'CDR-L2', 'initial_score': -405.9848947981586, 'relaxed_score': -592.4506908542226, 'interface_energy': -60.751870377672844, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 6, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/1_peptide_12mer_Ab0_CDR-L2_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/1_peptide_12mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.2646502428919198), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 1_peptide_12mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/1_peptide_12mer_Ab1...
Peptide sequence: ALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLN
Antibody has 240 residues
Peptide has 12 residues
Saving antibody to docking_results/1_peptide_12mer_Ab1_antibody.pdb
Saving peptide to docking_results/1_peptide_12mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab1_CDR-H3_combined.pdb
Initial score: 6049.56
  Found better pose: 3724.05
  Found better pose: 3011.99
  Found better pose: 2604.21
  Found better pose: 2512.27
  Found better pose: 1757.59
  Found better pose: 1281.12
  Found better pose: 598.69
  Found better pose: 421.23
  Found better pose: 255.12
  Found better pose: -67.80
  Found better pose: -183.82
  Found better pose: -202.46
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab1_CDR-H2_combined.pdb
Initial score: -222.52
  Found better pose: -227.56
  Found better pose: -227.82
  Found better pose: -228.58
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab1_CDR-H1_combined.pdb
Initial score: 26264.21
  Found better pose: 24942.60
  Found better pose: 22084.90
  Found better pose: 21932.80
  Found better pose: 20542.01
  Found better pose: 20173.08
  Found better pose: 16803.57
  Found better pose: 15701.89
  Found better pose: 14145.04
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab1_CDR-L3_combined.pdb
Initial score: -227.54
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -227.54
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -383.70, improvement = 156.17
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 350.33, improvement = -577.87
After minimization: energy = -157.64, improvement = -69.90

Complex relaxation cycle 2/25
After repacking: energy = -204.29, improvement = -23.25
After minimization: energy = -270.11, improvement = 42.58

Complex relaxation cycle 3/25
After repacking: energy = -230.15, improvement = 2.61
After minimization: energy = -271.84, improvement = 44.30

Complex relaxation cycle 4/25
After repacking: energy = -228.13, improvement = 0.59
After minimization: energy = -272.45, improvement = 44.91

Complex relaxation cycle 5/25
After repacking: energy = -194.32, improvement = -33.22
After minimization: energy = -240.06, improvement = 12.52

Complex relaxation cycle 6/25
After repacking: energy = -227.68, improvement = 0.15
After minimization: energy = -269.59, improvement = 42.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -216.39, improvement = -11.15
After minimization: energy = -260.71, improvement = 33.18

Complex relaxation cycle 8/25
After repacking: energy = -227.95, improvement = 0.41
After minimization: energy = -272.65, improvement = 45.11

Complex relaxation cycle 9/25
After repacking: energy = -215.90, improvement = -11.64
After minimization: energy = -260.70, improvement = 33.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -221.52, improvement = -6.02
After minimization: energy = -266.63, improvement = 39.10

Complex relaxation cycle 11/25
After repacking: energy = -222.08, improvement = -5.46
After minimization: energy = -266.70, improvement = 39.16

Complex relaxation cycle 12/25
After repacking: energy = -227.70, improvement = 0.16
After minimization: energy = -272.67, improvement = 45.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -215.81, improvement = -11.73
After minimization: energy = -260.64, improvement = 33.10

Complex relaxation cycle 14/25
After repacking: energy = -227.94, improvement = 0.40
After minimization: energy = -272.66, improvement = 45.12

Complex relaxation cycle 15/25
After repacking: energy = -216.03, improvement = -11.51
After minimization: energy = -260.61, improvement = 33.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -216.25, improvement = -11.29
After minimization: energy = -260.68, improvement = 33.14

Complex relaxation cycle 17/25
After repacking: energy = -227.69, improvement = 0.15
After minimization: energy = -272.67, improvement = 45.13

Complex relaxation cycle 18/25
After repacking: energy = -189.22, improvement = -38.31
After minimization: energy = -233.93, improvement = 6.39
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -215.98, improvement = -11.56
After minimization: energy = -260.69, improvement = 33.15

Complex relaxation cycle 20/25
After repacking: energy = -227.62, improvement = 0.08
After minimization: energy = -272.64, improvement = 45.10

Complex relaxation cycle 21/25
After repacking: energy = -215.92, improvement = -11.62
After minimization: energy = -260.68, improvement = 33.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -215.57, improvement = -11.97
After minimization: energy = -260.62, improvement = 33.08

Complex relaxation cycle 23/25
After repacking: energy = -189.26, improvement = -38.27
After minimization: energy = -233.98, improvement = 6.45

Complex relaxation cycle 24/25
After repacking: energy = -227.73, improvement = 0.19
After minimization: energy = -272.71, improvement = 45.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -227.57, improvement = 0.03
After minimization: energy = -272.61, improvement = 45.08

=== Complex Relaxation Summary ===
Initial energy: -227.54
Final energy: -383.70
Total energy improvement: 156.17 (68.6%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.52 Å
Interface energy: -53.05
Saved relaxed complex structure to docking_results/1_peptide_12mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -383.70
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -53.05

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab1_CDR-L1_combined.pdb
Initial score: -225.92
  Found better pose: -226.08
  Found better pose: -226.65
  Found better pose: -226.81
  Found better pose: -227.28
  Found better pose: -227.85
  Found better pose: -228.09
  Found better pose: -229.68
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -229.68
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -379.37, improvement = 149.68
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 328.80, improvement = -558.49
After minimization: energy = -178.11, improvement = -51.57

Complex relaxation cycle 2/25
After repacking: energy = -206.79, improvement = -22.89
After minimization: energy = -269.82, improvement = 40.13

Complex relaxation cycle 3/25
After repacking: energy = -229.70, improvement = 0.02
After minimization: energy = -269.49, improvement = 39.81

Complex relaxation cycle 4/25
After repacking: energy = -219.65, improvement = -10.03
After minimization: energy = -258.67, improvement = 28.99

Complex relaxation cycle 5/25
After repacking: energy = -232.31, improvement = 2.63
After minimization: energy = -271.99, improvement = 42.31

Complex relaxation cycle 6/25
After repacking: energy = -235.54, improvement = 5.86
After minimization: energy = -273.75, improvement = 44.06
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -224.36, improvement = -5.32
After minimization: energy = -261.74, improvement = 32.06

Complex relaxation cycle 8/25
After repacking: energy = -236.40, improvement = 6.71
After minimization: energy = -271.07, improvement = 41.38

Complex relaxation cycle 9/25
After repacking: energy = -237.74, improvement = 8.06
After minimization: energy = -273.73, improvement = 44.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -236.30, improvement = 6.62
After minimization: energy = -273.74, improvement = 44.05

Complex relaxation cycle 11/25
After repacking: energy = -197.35, improvement = -32.33
After minimization: energy = -235.05, improvement = 5.36

Complex relaxation cycle 12/25
After repacking: energy = -235.37, improvement = 5.69
After minimization: energy = -264.95, improvement = 35.27
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -231.12, improvement = 1.44
After minimization: energy = -261.78, improvement = 32.10

Complex relaxation cycle 14/25
After repacking: energy = -197.46, improvement = -32.22
After minimization: energy = -235.07, improvement = 5.38

Complex relaxation cycle 15/25
After repacking: energy = -235.96, improvement = 6.27
After minimization: energy = -271.10, improvement = 41.42
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -198.97, improvement = -30.71
After minimization: energy = -235.07, improvement = 5.39

Complex relaxation cycle 17/25
After repacking: energy = -223.96, improvement = -5.72
After minimization: energy = -261.77, improvement = 32.09

Complex relaxation cycle 18/25
After repacking: energy = -223.35, improvement = -6.33
After minimization: energy = -261.47, improvement = 31.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -223.96, improvement = -5.72
After minimization: energy = -261.76, improvement = 32.08

Complex relaxation cycle 20/25
After repacking: energy = -235.96, improvement = 6.28
After minimization: energy = -273.74, improvement = 44.06

Complex relaxation cycle 21/25
After repacking: energy = -235.66, improvement = 5.98
After minimization: energy = -273.40, improvement = 43.72
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -235.95, improvement = 6.27
After minimization: energy = -273.71, improvement = 44.03

Complex relaxation cycle 23/25
After repacking: energy = -223.81, improvement = -5.87
After minimization: energy = -261.75, improvement = 32.07

Complex relaxation cycle 24/25
After repacking: energy = -219.00, improvement = -10.68
After minimization: energy = -257.04, improvement = 27.35
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -235.95, improvement = 6.27
After minimization: energy = -271.21, improvement = 41.53

=== Complex Relaxation Summary ===
Initial energy: -229.68
Final energy: -379.37
Total energy improvement: 149.68 (65.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.46 Å
Interface energy: -63.28
Saved relaxed complex structure to docking_results/1_peptide_12mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -379.37
Checking contacts between peptide and CDR-L1...
Found 65 contacts with CDR-L1 (406.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -63.28

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-37.24, 43.55, 2.04)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/1_peptide_12mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/1_peptide_12mer_Ab1_CDR-L2_combined.pdb
Initial score: 17215.56
  Found better pose: 14909.26
  Found better pose: 14706.70
  Found better pose: 12265.69
  Found better pose: 9416.79
  Found better pose: 7018.89
  Found better pose: 4827.37
  Found better pose: 4311.56
  Found better pose: 1754.04
  Found better pose: 920.45
  Found better pose: 306.41
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 306.41
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -331.07, improvement = 637.49
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 467.99, improvement = -161.57
After minimization: energy = -40.08, improvement = 346.50

Complex relaxation cycle 2/25
After repacking: energy = 24.64, improvement = 281.77
After minimization: energy = -102.79, improvement = 409.21

Complex relaxation cycle 3/25
After repacking: energy = -41.08, improvement = 347.50
After minimization: energy = -106.89, improvement = 413.30

Complex relaxation cycle 4/25
After repacking: energy = -57.16, improvement = 363.57
After minimization: energy = -119.11, improvement = 425.52

Complex relaxation cycle 5/25
After repacking: energy = -56.78, improvement = 363.19
After minimization: energy = -119.11, improvement = 425.52

Complex relaxation cycle 6/25
After repacking: energy = -56.47, improvement = 362.89
After minimization: energy = -119.11, improvement = 425.52
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -44.56, improvement = 350.98
After minimization: energy = -107.14, improvement = 413.55

Complex relaxation cycle 8/25
After repacking: energy = -56.73, improvement = 363.15
After minimization: energy = -119.11, improvement = 425.52

Complex relaxation cycle 9/25
After repacking: energy = -44.56, improvement = 350.97
After minimization: energy = -107.14, improvement = 413.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -49.48, improvement = 355.90
After minimization: energy = -110.17, improvement = 416.59

Complex relaxation cycle 11/25
After repacking: energy = -42.92, improvement = 349.33
After minimization: energy = -107.20, improvement = 413.61

Complex relaxation cycle 12/25
After repacking: energy = -43.52, improvement = 349.93
After minimization: energy = -107.19, improvement = 413.61
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -55.38, improvement = 361.79
After minimization: energy = -119.20, improvement = 425.61

Complex relaxation cycle 14/25
After repacking: energy = -34.39, improvement = 340.81
After minimization: energy = -109.79, improvement = 416.20

Complex relaxation cycle 15/25
After repacking: energy = -70.88, improvement = 377.29
After minimization: energy = -122.80, improvement = 429.21
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -71.74, improvement = 378.16
After minimization: energy = -123.35, improvement = 429.76

Complex relaxation cycle 17/25
After repacking: energy = -72.06, improvement = 378.48
After minimization: energy = -123.49, improvement = 429.91

Complex relaxation cycle 18/25
After repacking: energy = -59.56, improvement = 365.97
After minimization: energy = -111.43, improvement = 417.84
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -59.49, improvement = 365.90
After minimization: energy = -111.53, improvement = 417.95

Complex relaxation cycle 20/25
After repacking: energy = -71.74, improvement = 378.16
After minimization: energy = -123.44, improvement = 429.86

Complex relaxation cycle 21/25
After repacking: energy = -59.83, improvement = 366.25
After minimization: energy = -109.81, improvement = 416.23
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -73.68, improvement = 380.09
After minimization: energy = -123.82, improvement = 430.24

Complex relaxation cycle 23/25
After repacking: energy = -59.77, improvement = 366.18
After minimization: energy = -110.08, improvement = 416.49

Complex relaxation cycle 24/25
After repacking: energy = -72.76, improvement = 379.17
After minimization: energy = -122.04, improvement = 428.45
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -72.89, improvement = 379.30
After minimization: energy = -123.96, improvement = 430.37

=== Complex Relaxation Summary ===
Initial energy: 306.41
Final energy: -331.07
Total energy improvement: 637.49 (208.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.61 Å
Interface energy: -1.35
Saved relaxed complex structure to docking_results/1_peptide_12mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -331.07
Checking contacts between peptide and CDR-L2...
Found 28 contacts with CDR-L2 (350.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -1.35

Best binding found with CDR-L3, score: -383.70
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -227.53832304199426, 'relaxed_score': -383.70409304226166, 'interface_energy': -53.04957522324992, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 8, 'salt_bridges': 0, 'hydrophobic': 5, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/1_peptide_12mer_Ab1_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/1_peptide_12mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.2646502428919198), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 2_peptide_20mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/2_peptide_20mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 2_peptide_20mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/2_peptide_20mer_Ab0...
Peptide sequence: ILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASN
Antibody has 232 residues
Peptide has 20 residues
Saving antibody to docking_results/2_peptide_20mer_Ab0_antibody.pdb
Saving peptide to docking_results/2_peptide_20mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab0_CDR-H3_combined.pdb
Initial score: -404.13
  Found better pose: -404.13
  Found better pose: -404.13
  Found better pose: -404.14
  Found better pose: -404.24
  Found better pose: -404.30
  Found better pose: -404.39
  Found better pose: -404.45
  Found better pose: -404.52
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab0_CDR-H2_combined.pdb
Initial score: -404.11
  Found better pose: -404.13
  Found better pose: -404.13
  Found better pose: -404.13
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab0_CDR-H1_combined.pdb
Initial score: 22205.87
  Found better pose: 21907.01
  Found better pose: 21675.14
  Found better pose: 21362.15
  Found better pose: 20720.95
  Found better pose: 17242.12
  Found better pose: 15954.31
  Found better pose: 15505.91
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab0_CDR-L3_combined.pdb
Initial score: 16167.97
  Found better pose: 16076.25
  Found better pose: 15695.78
  Found better pose: 14485.03
  Found better pose: 14034.96
  Found better pose: 12759.81
  Found better pose: 11502.56
  Found better pose: 9368.09
  Found better pose: 7710.75
  Found better pose: 7335.31
  Found better pose: 5430.78
  Found better pose: 3495.55
  Found better pose: 3327.86
  Found better pose: 1954.13
  Found better pose: 823.01
  Found better pose: 738.65
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 738.65
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -206.86, improvement = 945.50
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 545.01, improvement = 193.64
After minimization: energy = 9.81, improvement = 728.84

Complex relaxation cycle 2/25
After repacking: energy = 76.06, improvement = 662.58
After minimization: energy = -53.22, improvement = 791.86

Complex relaxation cycle 3/25
After repacking: energy = 15.18, improvement = 723.47
After minimization: energy = -57.92, improvement = 796.56

Complex relaxation cycle 4/25
After repacking: energy = 4.45, improvement = 734.20
After minimization: energy = -57.92, improvement = 796.56

Complex relaxation cycle 5/25
After repacking: energy = 1.43, improvement = 737.21
After minimization: energy = -75.26, improvement = 813.91

Complex relaxation cycle 6/25
After repacking: energy = 48.65, improvement = 689.99
After minimization: energy = -57.13, improvement = 795.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 4.64, improvement = 734.01
After minimization: energy = -63.27, improvement = 801.91

Complex relaxation cycle 8/25
After repacking: energy = 8.33, improvement = 730.32
After minimization: energy = -62.46, improvement = 801.10

Complex relaxation cycle 9/25
After repacking: energy = 1.46, improvement = 737.18
After minimization: energy = -64.26, improvement = 802.90
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 12.72, improvement = 725.93
After minimization: energy = -62.45, improvement = 801.10

Complex relaxation cycle 11/25
After repacking: energy = 2.50, improvement = 736.14
After minimization: energy = -64.35, improvement = 803.00

Complex relaxation cycle 12/25
After repacking: energy = 5.53, improvement = 733.12
After minimization: energy = -64.36, improvement = 803.00
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 5.04, improvement = 733.60
After minimization: energy = -64.35, improvement = 803.00

Complex relaxation cycle 14/25
After repacking: energy = 4.84, improvement = 733.81
After minimization: energy = -64.40, improvement = 803.05

Complex relaxation cycle 15/25
After repacking: energy = 5.46, improvement = 733.19
After minimization: energy = -64.35, improvement = 802.99
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 45.05, improvement = 693.60
After minimization: energy = -24.61, improvement = 763.25

Complex relaxation cycle 17/25
After repacking: energy = 4.79, improvement = 733.86
After minimization: energy = -63.21, improvement = 801.85

Complex relaxation cycle 18/25
After repacking: energy = 0.51, improvement = 738.14
After minimization: energy = -64.32, improvement = 802.97
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 9.68, improvement = 728.96
After minimization: energy = -62.41, improvement = 801.06

Complex relaxation cycle 20/25
After repacking: energy = 4.60, improvement = 734.05
After minimization: energy = -64.17, improvement = 802.82

Complex relaxation cycle 21/25
After repacking: energy = 8.87, improvement = 729.78
After minimization: energy = -62.42, improvement = 801.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 4.81, improvement = 733.83
After minimization: energy = -64.17, improvement = 802.82

Complex relaxation cycle 23/25
After repacking: energy = 7.08, improvement = 731.57
After minimization: energy = -64.27, improvement = 802.92

Complex relaxation cycle 24/25
After repacking: energy = 9.54, improvement = 729.10
After minimization: energy = -62.47, improvement = 801.12
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 4.30, improvement = 734.35
After minimization: energy = -64.33, improvement = 802.97

=== Complex Relaxation Summary ===
Initial energy: 738.65
Final energy: -206.86
Total energy improvement: 945.50 (128.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.46 Å
Interface energy: 310.14
Saved relaxed complex structure to docking_results/2_peptide_20mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -206.86
Checking contacts between peptide and CDR-L3...
Found 39 contacts with CDR-L3 (354.5% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: 310.14

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab0_CDR-L1_combined.pdb
Initial score: -403.88
  Found better pose: -404.17
  Found better pose: -404.23
  Found better pose: -404.35
  Found better pose: -404.95
  Found better pose: -405.11
  Found better pose: -405.19
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -405.19
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -589.88, improvement = 184.69
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -342.70, improvement = -62.50
After minimization: energy = -514.76, improvement = 109.57

Complex relaxation cycle 2/25
After repacking: energy = -380.16, improvement = -25.03
After minimization: energy = -505.92, improvement = 100.73

Complex relaxation cycle 3/25
After repacking: energy = -440.84, improvement = 35.64
After minimization: energy = -505.84, improvement = 100.65

Complex relaxation cycle 4/25
After repacking: energy = -443.85, improvement = 38.66
After minimization: energy = -514.43, improvement = 109.24

Complex relaxation cycle 5/25
After repacking: energy = -436.94, improvement = 31.75
After minimization: energy = -515.92, improvement = 110.72

Complex relaxation cycle 6/25
After repacking: energy = -444.14, improvement = 38.94
After minimization: energy = -513.10, improvement = 107.91
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -443.67, improvement = 38.47
After minimization: energy = -512.15, improvement = 106.96

Complex relaxation cycle 8/25
After repacking: energy = -443.06, improvement = 37.87
After minimization: energy = -512.27, improvement = 107.08

Complex relaxation cycle 9/25
After repacking: energy = -441.58, improvement = 36.39
After minimization: energy = -512.31, improvement = 107.12
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -441.23, improvement = 36.04
After minimization: energy = -512.80, improvement = 107.61

Complex relaxation cycle 11/25
After repacking: energy = -442.99, improvement = 37.80
After minimization: energy = -512.27, improvement = 107.08

Complex relaxation cycle 12/25
After repacking: energy = -440.70, improvement = 35.51
After minimization: energy = -512.29, improvement = 107.10
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -441.12, improvement = 35.93
After minimization: energy = -512.79, improvement = 107.60

Complex relaxation cycle 14/25
After repacking: energy = -441.17, improvement = 35.98
After minimization: energy = -512.91, improvement = 107.72

Complex relaxation cycle 15/25
After repacking: energy = -442.25, improvement = 37.06
After minimization: energy = -512.85, improvement = 107.66
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -441.45, improvement = 36.25
After minimization: energy = -511.79, improvement = 106.60

Complex relaxation cycle 17/25
After repacking: energy = -441.99, improvement = 36.80
After minimization: energy = -512.16, improvement = 106.96

Complex relaxation cycle 18/25
After repacking: energy = -442.59, improvement = 37.40
After minimization: energy = -512.96, improvement = 107.77
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -441.61, improvement = 36.42
After minimization: energy = -512.79, improvement = 107.60

Complex relaxation cycle 20/25
After repacking: energy = -441.07, improvement = 35.87
After minimization: energy = -512.78, improvement = 107.59

Complex relaxation cycle 21/25
After repacking: energy = -442.24, improvement = 37.05
After minimization: energy = -512.93, improvement = 107.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -441.42, improvement = 36.23
After minimization: energy = -513.01, improvement = 107.82

Complex relaxation cycle 23/25
After repacking: energy = -440.45, improvement = 35.26
After minimization: energy = -512.88, improvement = 107.69

Complex relaxation cycle 24/25
After repacking: energy = -401.69, improvement = -3.50
After minimization: energy = -473.10, improvement = 67.91
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -439.77, improvement = 34.57
After minimization: energy = -511.97, improvement = 106.78

=== Complex Relaxation Summary ===
Initial energy: -405.19
Final energy: -589.88
Total energy improvement: 184.69 (45.6%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.28 Å
Interface energy: -60.01
Saved relaxed complex structure to docking_results/2_peptide_20mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -589.88
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -60.01

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab0_CDR-L2_combined.pdb
Initial score: 12308.63
  Found better pose: 11003.81
  Found better pose: 10283.53
  Found better pose: 10038.45
  Found better pose: 9194.59
  Found better pose: 8652.95
  Found better pose: 8202.50
  Found better pose: 7323.95
  Found better pose: 7323.72
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 7323.72
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 3946.74, improvement = 3376.98
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 5506.65, improvement = 1817.07
After minimization: energy = 5339.94, improvement = 1983.77

Complex relaxation cycle 2/25
After repacking: energy = 5520.01, improvement = 1803.70
After minimization: energy = 5394.06, improvement = 1929.65

Complex relaxation cycle 3/25
After repacking: energy = 5423.03, improvement = 1900.68
After minimization: energy = 5350.54, improvement = 1973.18

Complex relaxation cycle 4/25
After repacking: energy = 5405.21, improvement = 1918.51
After minimization: energy = 5350.66, improvement = 1973.06

Complex relaxation cycle 5/25
After repacking: energy = 5399.90, improvement = 1923.82
After minimization: energy = 5353.22, improvement = 1970.50

Complex relaxation cycle 6/25
After repacking: energy = 5393.77, improvement = 1929.94
After minimization: energy = 5351.94, improvement = 1971.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 5393.16, improvement = 1930.56
After minimization: energy = 5350.77, improvement = 1972.95

Complex relaxation cycle 8/25
After repacking: energy = 5434.14, improvement = 1889.58
After minimization: energy = 5391.64, improvement = 1932.08

Complex relaxation cycle 9/25
After repacking: energy = 5389.14, improvement = 1934.57
After minimization: energy = 5352.30, improvement = 1971.41
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 5388.09, improvement = 1935.62
After minimization: energy = 5352.12, improvement = 1971.60

Complex relaxation cycle 11/25
After repacking: energy = 5463.24, improvement = 1860.47
After minimization: energy = 5428.24, improvement = 1895.47

Complex relaxation cycle 12/25
After repacking: energy = 5385.48, improvement = 1938.24
After minimization: energy = 5352.50, improvement = 1971.22
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 5385.57, improvement = 1938.14
After minimization: energy = 5352.00, improvement = 1971.72

Complex relaxation cycle 14/25
After repacking: energy = 5387.92, improvement = 1935.79
After minimization: energy = 5353.91, improvement = 1969.81

Complex relaxation cycle 15/25
After repacking: energy = 5383.69, improvement = 1940.03
After minimization: energy = 5350.75, improvement = 1972.97
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 5388.65, improvement = 1935.06
After minimization: energy = 5354.78, improvement = 1968.93

Complex relaxation cycle 17/25
After repacking: energy = 5380.12, improvement = 1943.60
After minimization: energy = 5353.23, improvement = 1970.49

Complex relaxation cycle 18/25
After repacking: energy = 5381.79, improvement = 1941.93
After minimization: energy = 5355.92, improvement = 1967.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 5382.56, improvement = 1941.16
After minimization: energy = 5350.93, improvement = 1972.79

Complex relaxation cycle 20/25
After repacking: energy = 5387.86, improvement = 1935.86
After minimization: energy = 5352.19, improvement = 1971.52

Complex relaxation cycle 21/25
After repacking: energy = 5386.77, improvement = 1936.94
After minimization: energy = 5353.10, improvement = 1970.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 5387.17, improvement = 1936.55
After minimization: energy = 5360.25, improvement = 1963.47

Complex relaxation cycle 23/25
After repacking: energy = 5375.24, improvement = 1948.48
After minimization: energy = 5360.40, improvement = 1963.31

Complex relaxation cycle 24/25
After repacking: energy = 5408.22, improvement = 1915.50
After minimization: energy = 5387.76, improvement = 1935.96
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 5385.45, improvement = 1938.27
After minimization: energy = 5351.21, improvement = 1972.51

=== Complex Relaxation Summary ===
Initial energy: 7323.72
Final energy: 3946.74
Total energy improvement: 3376.98 (46.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.27 Å
Interface energy: 4218.99
Saved relaxed complex structure to docking_results/2_peptide_20mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 3946.74
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 4218.99

Best binding found with CDR-L1, score: -589.88
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -405.19257608651054, 'relaxed_score': -589.8841505206348, 'interface_energy': -60.00764619654262, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 10, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/2_peptide_20mer_Ab0_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/2_peptide_20mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.21333215316265305), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

----- Processing antibody Ab1 with peptide 2_peptide_20mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/2_peptide_20mer_Ab1...
Peptide sequence: ILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHRASN
Antibody has 240 residues
Peptide has 20 residues
Saving antibody to docking_results/2_peptide_20mer_Ab1_antibody.pdb
Saving peptide to docking_results/2_peptide_20mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab1_CDR-H3_combined.pdb
Initial score: 3336.76
  Found better pose: 3081.20
  Found better pose: 2003.74
  Found better pose: 785.43
  Found better pose: 539.59
  Found better pose: -102.29
  Found better pose: -157.08
  Found better pose: -224.40
  Found better pose: -224.58
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab1_CDR-H2_combined.pdb
Initial score: -226.38
  Found better pose: -226.41
  Found better pose: -226.44
  Found better pose: -226.58
  Found better pose: -226.59
  Found better pose: -226.74
  Found better pose: -227.42
  Found better pose: -227.59
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab1_CDR-H1_combined.pdb
Initial score: 16577.61
  Found better pose: 13387.00
  Found better pose: 13090.14
  Found better pose: 10015.40
  Found better pose: 8938.13
  Found better pose: 7300.91
  Found better pose: 5822.17
  Found better pose: 4682.61
  Found better pose: 3727.36
  Found better pose: 3505.75
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab1_CDR-L3_combined.pdb
Initial score: 17509.63
  Found better pose: 15662.93
  Found better pose: 15383.56
  Found better pose: 13914.73
  Found better pose: 13813.96
  Found better pose: 12450.12
  Found better pose: 11231.25
  Found better pose: 10836.93
  Found better pose: 10218.70
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 10218.70
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 6234.75, improvement = 3983.96
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 10755.74, improvement = -537.04
After minimization: energy = 10288.01, improvement = -69.31

Complex relaxation cycle 2/25
After repacking: energy = 10249.25, improvement = -30.55
After minimization: energy = 10164.32, improvement = 54.38

Complex relaxation cycle 3/25
After repacking: energy = 10199.61, improvement = 19.09
After minimization: energy = 10155.43, improvement = 63.28

Complex relaxation cycle 4/25
After repacking: energy = 10194.20, improvement = 24.51
After minimization: energy = 10162.90, improvement = 55.80

Complex relaxation cycle 5/25
After repacking: energy = 10192.48, improvement = 26.23
After minimization: energy = 10153.89, improvement = 64.81

Complex relaxation cycle 6/25
After repacking: energy = 10180.98, improvement = 37.73
After minimization: energy = 10150.74, improvement = 67.97
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 10190.73, improvement = 27.97
After minimization: energy = 10162.67, improvement = 56.03

Complex relaxation cycle 8/25
After repacking: energy = 10189.13, improvement = 29.57
After minimization: energy = 10161.29, improvement = 57.41

Complex relaxation cycle 9/25
After repacking: energy = 10189.67, improvement = 29.04
After minimization: energy = 10166.45, improvement = 52.26
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 10168.65, improvement = 50.05
After minimization: energy = 10151.20, improvement = 67.50

Complex relaxation cycle 11/25
After repacking: energy = 10181.95, improvement = 36.75
After minimization: energy = 10165.85, improvement = 52.86

Complex relaxation cycle 12/25
After repacking: energy = 10171.16, improvement = 47.55
After minimization: energy = 10156.32, improvement = 62.39
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 10180.78, improvement = 37.92
After minimization: energy = 10163.62, improvement = 55.09

Complex relaxation cycle 14/25
After repacking: energy = 10187.14, improvement = 31.56
After minimization: energy = 10158.45, improvement = 60.25

Complex relaxation cycle 15/25
After repacking: energy = 10184.97, improvement = 33.73
After minimization: energy = 10158.19, improvement = 60.52
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 10297.71, improvement = -79.01
After minimization: energy = 10275.78, improvement = -57.07

Complex relaxation cycle 17/25
After repacking: energy = 10165.29, improvement = 53.42
After minimization: energy = 10144.45, improvement = 74.26

Complex relaxation cycle 18/25
After repacking: energy = 10170.38, improvement = 48.32
After minimization: energy = 10147.89, improvement = 70.81
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 10176.77, improvement = 41.93
After minimization: energy = 10158.39, improvement = 60.32

Complex relaxation cycle 20/25
After repacking: energy = 10291.66, improvement = -72.96
After minimization: energy = 10272.87, improvement = -54.17

Complex relaxation cycle 21/25
After repacking: energy = 10176.38, improvement = 42.32
After minimization: energy = 10157.86, improvement = 60.84
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 10177.76, improvement = 40.95
After minimization: energy = 10159.74, improvement = 58.96

Complex relaxation cycle 23/25
After repacking: energy = 10173.28, improvement = 45.43
After minimization: energy = 10160.52, improvement = 58.19

Complex relaxation cycle 24/25
After repacking: energy = 10175.47, improvement = 43.24
After minimization: energy = 10159.60, improvement = 59.10
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 10163.15, improvement = 55.55
After minimization: energy = 10145.10, improvement = 73.60

=== Complex Relaxation Summary ===
Initial energy: 10218.70
Final energy: 6234.75
Total energy improvement: 3983.96 (39.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.65 Å
Interface energy: 6280.48
Saved relaxed complex structure to docking_results/2_peptide_20mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: 6234.75
Checking contacts between peptide and CDR-L3...
Found 41 contacts with CDR-L3 (372.7% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: 6280.48

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab1_CDR-L1_combined.pdb
Initial score: -67.73
  Found better pose: -147.10
  Found better pose: -227.58
  Found better pose: -227.66
  Found better pose: -227.70
  Found better pose: -228.38
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -228.38
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -390.60, improvement = 162.22
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 344.75, improvement = -573.13
After minimization: energy = -194.80, improvement = -33.58

Complex relaxation cycle 2/25
After repacking: energy = -176.63, improvement = -51.75
After minimization: energy = -257.67, improvement = 29.29

Complex relaxation cycle 3/25
After repacking: energy = -202.70, improvement = -25.68
After minimization: energy = -248.05, improvement = 19.67

Complex relaxation cycle 4/25
After repacking: energy = -219.63, improvement = -8.75
After minimization: energy = -270.02, improvement = 41.64

Complex relaxation cycle 5/25
After repacking: energy = -204.84, improvement = -23.55
After minimization: energy = -258.74, improvement = 30.36

Complex relaxation cycle 6/25
After repacking: energy = -212.57, improvement = -15.81
After minimization: energy = -263.28, improvement = 34.90
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -223.67, improvement = -4.71
After minimization: energy = -275.36, improvement = 46.97

Complex relaxation cycle 8/25
After repacking: energy = -211.47, improvement = -16.91
After minimization: energy = -263.03, improvement = 34.65

Complex relaxation cycle 9/25
After repacking: energy = -210.71, improvement = -17.67
After minimization: energy = -262.83, improvement = 34.45
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -208.78, improvement = -19.60
After minimization: energy = -258.80, improvement = 30.42

Complex relaxation cycle 11/25
After repacking: energy = -213.86, improvement = -14.52
After minimization: energy = -259.84, improvement = 31.46

Complex relaxation cycle 12/25
After repacking: energy = -210.70, improvement = -17.68
After minimization: energy = -259.33, improvement = 30.95
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -212.52, improvement = -15.86
After minimization: energy = -261.06, improvement = 32.68

Complex relaxation cycle 14/25
After repacking: energy = -199.53, improvement = -28.86
After minimization: energy = -244.73, improvement = 16.34

Complex relaxation cycle 15/25
After repacking: energy = -226.82, improvement = -1.56
After minimization: energy = -271.71, improvement = 43.33
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -190.78, improvement = -37.60
After minimization: energy = -235.33, improvement = 6.95

Complex relaxation cycle 17/25
After repacking: energy = -216.19, improvement = -12.19
After minimization: energy = -261.68, improvement = 33.30

Complex relaxation cycle 18/25
After repacking: energy = -217.07, improvement = -11.31
After minimization: energy = -261.93, improvement = 33.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -216.46, improvement = -11.92
After minimization: energy = -261.90, improvement = 33.52

Complex relaxation cycle 20/25
After repacking: energy = -216.74, improvement = -11.64
After minimization: energy = -260.06, improvement = 31.68

Complex relaxation cycle 21/25
After repacking: energy = -215.68, improvement = -12.70
After minimization: energy = -261.53, improvement = 33.15
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -217.23, improvement = -11.15
After minimization: energy = -261.95, improvement = 33.57

Complex relaxation cycle 23/25
After repacking: energy = -227.90, improvement = -0.48
After minimization: energy = -273.70, improvement = 45.31

Complex relaxation cycle 24/25
After repacking: energy = -228.92, improvement = 0.54
After minimization: energy = -273.93, improvement = 45.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -216.72, improvement = -11.66
After minimization: energy = -261.94, improvement = 33.56

=== Complex Relaxation Summary ===
Initial energy: -228.38
Final energy: -390.60
Total energy improvement: 162.22 (71.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.49 Å
Interface energy: -54.15
Saved relaxed complex structure to docking_results/2_peptide_20mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -390.60
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -54.15

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-45.27, 74.52, -2.62)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/2_peptide_20mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/2_peptide_20mer_Ab1_CDR-L2_combined.pdb
Initial score: 10286.20
  Found better pose: 9427.08
  Found better pose: 9322.36
  Found better pose: 7976.28
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 7976.28
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 5927.99, improvement = 2048.29
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 7809.49, improvement = 166.79
After minimization: energy = 7284.41, improvement = 691.87

Complex relaxation cycle 2/25
After repacking: energy = 7253.38, improvement = 722.90
After minimization: energy = 7151.75, improvement = 824.53

Complex relaxation cycle 3/25
After repacking: energy = 7240.16, improvement = 736.12
After minimization: energy = 7145.75, improvement = 830.53

Complex relaxation cycle 4/25
After repacking: energy = 7234.74, improvement = 741.54
After minimization: energy = 7136.51, improvement = 839.77

Complex relaxation cycle 5/25
After repacking: energy = 7241.41, improvement = 734.87
After minimization: energy = 7157.77, improvement = 818.51

Complex relaxation cycle 6/25
After repacking: energy = 7223.30, improvement = 752.98
After minimization: energy = 7169.97, improvement = 806.31
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 7202.58, improvement = 773.70
After minimization: energy = 7155.61, improvement = 820.67

Complex relaxation cycle 8/25
After repacking: energy = 7210.65, improvement = 765.63
After minimization: energy = 7156.04, improvement = 820.24

Complex relaxation cycle 9/25
After repacking: energy = 7216.01, improvement = 760.27
After minimization: energy = 7151.82, improvement = 824.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 7236.64, improvement = 739.64
After minimization: energy = 7155.37, improvement = 820.91

Complex relaxation cycle 11/25
After repacking: energy = 7244.74, improvement = 731.54
After minimization: energy = 7151.53, improvement = 824.76

Complex relaxation cycle 12/25
After repacking: energy = 7215.43, improvement = 760.85
After minimization: energy = 7134.35, improvement = 841.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 7228.56, improvement = 747.72
After minimization: energy = 7146.35, improvement = 829.93

Complex relaxation cycle 14/25
After repacking: energy = 7236.88, improvement = 739.40
After minimization: energy = 7163.43, improvement = 812.85

Complex relaxation cycle 15/25
After repacking: energy = 7194.16, improvement = 782.12
After minimization: energy = 7134.26, improvement = 842.02
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 7226.80, improvement = 749.48
After minimization: energy = 7145.56, improvement = 830.72

Complex relaxation cycle 17/25
After repacking: energy = 7224.32, improvement = 751.96
After minimization: energy = 7133.58, improvement = 842.70

Complex relaxation cycle 18/25
After repacking: energy = 7216.68, improvement = 759.60
After minimization: energy = 7135.17, improvement = 841.11
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 7216.50, improvement = 759.78
After minimization: energy = 7132.78, improvement = 843.50

Complex relaxation cycle 20/25
After repacking: energy = 7239.84, improvement = 736.44
After minimization: energy = 7146.84, improvement = 829.44

Complex relaxation cycle 21/25
After repacking: energy = 7214.71, improvement = 761.57
After minimization: energy = 7150.00, improvement = 826.28
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 7203.79, improvement = 772.49
After minimization: energy = 7152.46, improvement = 823.82

Complex relaxation cycle 23/25
After repacking: energy = 7197.81, improvement = 778.48
After minimization: energy = 7149.74, improvement = 826.55

Complex relaxation cycle 24/25
After repacking: energy = 7193.02, improvement = 783.26
After minimization: energy = 7148.21, improvement = 828.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 7175.32, improvement = 800.96
After minimization: energy = 7130.28, improvement = 846.01

=== Complex Relaxation Summary ===
Initial energy: 7976.28
Final energy: 5927.99
Total energy improvement: 2048.29 (25.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.73 Å
Interface energy: 6071.18
Saved relaxed complex structure to docking_results/2_peptide_20mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 5927.99
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 6071.18

Best binding found with CDR-L1, score: -390.60
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -228.38114730439733, 'relaxed_score': -390.60455140263764, 'interface_energy': -54.15410075560686, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/2_peptide_20mer_Ab1_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/2_peptide_20mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.21333215316265305), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Medium'}

===== Processing peptide: 4_peptide_12mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/4_peptide_12mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 4_peptide_12mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/4_peptide_12mer_Ab0...
Peptide sequence: GLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSER
Antibody has 232 residues
Peptide has 12 residues
Saving antibody to docking_results/4_peptide_12mer_Ab0_antibody.pdb
Saving peptide to docking_results/4_peptide_12mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab0_CDR-H3_combined.pdb
Initial score: 7200.68
  Found better pose: 5208.08
  Found better pose: 4843.12
  Found better pose: 4558.55
  Found better pose: 4489.51
  Found better pose: 4237.04
  Found better pose: 3971.35
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab0_CDR-H2_combined.pdb
Initial score: 11196.98
  Found better pose: 9213.56
  Found better pose: 9085.07
  Found better pose: 7523.98
  Found better pose: 5459.88
  Found better pose: 4184.09
  Found better pose: 4028.21
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab0_CDR-H1_combined.pdb
Initial score: 24015.18
  Found better pose: 22859.63
  Found better pose: 22743.79
  Found better pose: 21013.13
  Found better pose: 20242.86
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab0_CDR-L3_combined.pdb
Initial score: 10195.62
  Found better pose: 7890.59
  Found better pose: 7642.27
  Found better pose: 7045.10
  Found better pose: 6236.25
  Found better pose: 6204.57
  Found better pose: 5828.17
  Found better pose: 5658.90
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 5658.90
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -539.23, improvement = 6198.13
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 3755.65, improvement = 1903.25
After minimization: energy = -454.98, improvement = 6113.88

Complex relaxation cycle 2/25
After repacking: energy = -253.48, improvement = 5912.39
After minimization: energy = -472.15, improvement = 6131.05

Complex relaxation cycle 3/25
After repacking: energy = -413.52, improvement = 6072.43
After minimization: energy = -474.25, improvement = 6133.15

Complex relaxation cycle 4/25
After repacking: energy = -397.21, improvement = 6056.12
After minimization: energy = -475.51, improvement = 6134.41

Complex relaxation cycle 5/25
After repacking: energy = -397.08, improvement = 6055.98
After minimization: energy = -480.38, improvement = 6139.28

Complex relaxation cycle 6/25
After repacking: energy = -387.49, improvement = 6046.39
After minimization: energy = -482.58, improvement = 6141.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -414.54, improvement = 6073.45
After minimization: energy = -482.72, improvement = 6141.62

Complex relaxation cycle 8/25
After repacking: energy = -418.85, improvement = 6077.76
After minimization: energy = -482.85, improvement = 6141.75

Complex relaxation cycle 9/25
After repacking: energy = -419.94, improvement = 6078.84
After minimization: energy = -482.76, improvement = 6141.66
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -420.33, improvement = 6079.23
After minimization: energy = -482.84, improvement = 6141.74

Complex relaxation cycle 11/25
After repacking: energy = -420.93, improvement = 6079.83
After minimization: energy = -482.77, improvement = 6141.67

Complex relaxation cycle 12/25
After repacking: energy = -420.97, improvement = 6079.87
After minimization: energy = -482.82, improvement = 6141.73
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -420.09, improvement = 6078.99
After minimization: energy = -482.78, improvement = 6141.68

Complex relaxation cycle 14/25
After repacking: energy = -420.95, improvement = 6079.85
After minimization: energy = -482.87, improvement = 6141.77

Complex relaxation cycle 15/25
After repacking: energy = -419.87, improvement = 6078.77
After minimization: energy = -482.78, improvement = 6141.68
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -420.75, improvement = 6079.65
After minimization: energy = -482.82, improvement = 6141.72

Complex relaxation cycle 17/25
After repacking: energy = -419.98, improvement = 6078.89
After minimization: energy = -482.77, improvement = 6141.67

Complex relaxation cycle 18/25
After repacking: energy = -420.53, improvement = 6079.43
After minimization: energy = -482.82, improvement = 6141.73
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -420.51, improvement = 6079.41
After minimization: energy = -482.78, improvement = 6141.68

Complex relaxation cycle 20/25
After repacking: energy = -421.55, improvement = 6080.45
After minimization: energy = -482.75, improvement = 6141.65

Complex relaxation cycle 21/25
After repacking: energy = -420.19, improvement = 6079.09
After minimization: energy = -482.79, improvement = 6141.69
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -420.04, improvement = 6078.94
After minimization: energy = -482.75, improvement = 6141.66

Complex relaxation cycle 23/25
After repacking: energy = -418.53, improvement = 6077.43
After minimization: energy = -480.84, improvement = 6139.74

Complex relaxation cycle 24/25
After repacking: energy = -419.66, improvement = 6078.56
After minimization: energy = -482.72, improvement = 6141.63
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -420.43, improvement = 6079.33
After minimization: energy = -482.67, improvement = 6141.57

=== Complex Relaxation Summary ===
Initial energy: 5658.90
Final energy: -539.23
Total energy improvement: 6198.13 (109.5%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.65 Å
Interface energy: -51.59
Saved relaxed complex structure to docking_results/4_peptide_12mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -539.23
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -51.59

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab0_CDR-L1_combined.pdb
Initial score: 11340.58
  Found better pose: 11041.74
  Found better pose: 10381.87
  Found better pose: 10229.87
  Found better pose: 10124.20
  Found better pose: 9886.03
  Found better pose: 9489.44
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 9489.44
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -411.35, improvement = 9900.79
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 7114.05, improvement = 2375.39
After minimization: energy = -150.55, improvement = 9639.99

Complex relaxation cycle 2/25
After repacking: energy = 85.62, improvement = 9403.82
After minimization: energy = -307.95, improvement = 9797.38

Complex relaxation cycle 3/25
After repacking: energy = -240.87, improvement = 9730.31
After minimization: energy = -321.00, improvement = 9810.44

Complex relaxation cycle 4/25
After repacking: energy = -266.00, improvement = 9755.44
After minimization: energy = -328.78, improvement = 9818.21

Complex relaxation cycle 5/25
After repacking: energy = -158.36, improvement = 9647.80
After minimization: energy = -322.81, improvement = 9812.25

Complex relaxation cycle 6/25
After repacking: energy = -177.15, improvement = 9666.59
After minimization: energy = -320.29, improvement = 9809.72
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -176.32, improvement = 9665.75
After minimization: energy = -321.96, improvement = 9811.39

Complex relaxation cycle 8/25
After repacking: energy = -174.26, improvement = 9663.70
After minimization: energy = -321.58, improvement = 9811.02

Complex relaxation cycle 9/25
After repacking: energy = -177.31, improvement = 9666.74
After minimization: energy = -323.39, improvement = 9812.83
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -179.37, improvement = 9668.81
After minimization: energy = -323.44, improvement = 9812.87

Complex relaxation cycle 11/25
After repacking: energy = -173.77, improvement = 9663.20
After minimization: energy = -323.87, improvement = 9813.30

Complex relaxation cycle 12/25
After repacking: energy = -177.62, improvement = 9667.05
After minimization: energy = -322.97, improvement = 9812.41
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -180.56, improvement = 9670.00
After minimization: energy = -323.10, improvement = 9812.54

Complex relaxation cycle 14/25
After repacking: energy = -179.64, improvement = 9669.07
After minimization: energy = -323.00, improvement = 9812.43

Complex relaxation cycle 15/25
After repacking: energy = -178.97, improvement = 9668.41
After minimization: energy = -322.61, improvement = 9812.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -138.74, improvement = 9628.17
After minimization: energy = -282.87, improvement = 9772.30

Complex relaxation cycle 17/25
After repacking: energy = -179.55, improvement = 9668.99
After minimization: energy = -323.18, improvement = 9812.61

Complex relaxation cycle 18/25
After repacking: energy = -180.48, improvement = 9669.91
After minimization: energy = -322.63, improvement = 9812.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -179.98, improvement = 9669.41
After minimization: energy = -323.44, improvement = 9812.88

Complex relaxation cycle 20/25
After repacking: energy = -172.12, improvement = 9661.55
After minimization: energy = -321.95, improvement = 9811.38

Complex relaxation cycle 21/25
After repacking: energy = -175.01, improvement = 9664.45
After minimization: energy = -326.14, improvement = 9815.58
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -179.78, improvement = 9669.22
After minimization: energy = -323.47, improvement = 9812.90

Complex relaxation cycle 23/25
After repacking: energy = -182.96, improvement = 9672.40
After minimization: energy = -323.62, improvement = 9813.05

Complex relaxation cycle 24/25
After repacking: energy = -134.88, improvement = 9624.31
After minimization: energy = -277.81, improvement = 9767.25
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -137.71, improvement = 9627.15
After minimization: energy = -280.16, improvement = 9769.59

=== Complex Relaxation Summary ===
Initial energy: 9489.44
Final energy: -411.35
Total energy improvement: 9900.79 (104.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.87 Å
Interface energy: 0.98
Saved relaxed complex structure to docking_results/4_peptide_12mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -411.35
Checking contacts between peptide and CDR-L1...
Found 55 contacts with CDR-L1 (343.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 0.98

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab0_CDR-L2_combined.pdb
Initial score: 13003.74
  Found better pose: 10994.35
  Found better pose: 9546.31
  Found better pose: 8932.13
  Found better pose: 8382.83
  Found better pose: 5872.93
  Found better pose: 4023.19
  Found better pose: 3285.52
  Found better pose: 1987.01
  Found better pose: 276.21
  Found better pose: 238.53
  Found better pose: -5.94
  Found better pose: -316.67
  Found better pose: -356.76
  Found better pose: -357.92
  Found better pose: -360.11
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -360.11
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -582.55, improvement = 222.44
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -304.60, improvement = -55.51
After minimization: energy = -515.12, improvement = 155.01

Complex relaxation cycle 2/25
After repacking: energy = -370.92, improvement = 10.81
After minimization: energy = -505.74, improvement = 145.63

Complex relaxation cycle 3/25
After repacking: energy = -438.95, improvement = 78.83
After minimization: energy = -515.97, improvement = 155.86

Complex relaxation cycle 4/25
After repacking: energy = -442.52, improvement = 82.41
After minimization: energy = -519.10, improvement = 158.99

Complex relaxation cycle 5/25
After repacking: energy = -453.78, improvement = 93.66
After minimization: energy = -519.04, improvement = 158.93

Complex relaxation cycle 6/25
After repacking: energy = -450.40, improvement = 90.28
After minimization: energy = -516.03, improvement = 155.92
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -446.91, improvement = 86.80
After minimization: energy = -516.46, improvement = 156.35

Complex relaxation cycle 8/25
After repacking: energy = -448.39, improvement = 88.28
After minimization: energy = -519.83, improvement = 159.72

Complex relaxation cycle 9/25
After repacking: energy = -447.29, improvement = 87.18
After minimization: energy = -517.68, improvement = 157.57
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -445.91, improvement = 85.80
After minimization: energy = -516.51, improvement = 156.40

Complex relaxation cycle 11/25
After repacking: energy = -447.52, improvement = 87.41
After minimization: energy = -517.20, improvement = 157.09

Complex relaxation cycle 12/25
After repacking: energy = -447.24, improvement = 87.13
After minimization: energy = -516.63, improvement = 156.52
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -446.78, improvement = 86.67
After minimization: energy = -516.62, improvement = 156.51

Complex relaxation cycle 14/25
After repacking: energy = -447.38, improvement = 87.27
After minimization: energy = -516.60, improvement = 156.49

Complex relaxation cycle 15/25
After repacking: energy = -447.12, improvement = 87.01
After minimization: energy = -516.63, improvement = 156.52
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -447.20, improvement = 87.09
After minimization: energy = -517.25, improvement = 157.14

Complex relaxation cycle 17/25
After repacking: energy = -446.94, improvement = 86.83
After minimization: energy = -516.53, improvement = 156.42

Complex relaxation cycle 18/25
After repacking: energy = -446.36, improvement = 86.25
After minimization: energy = -516.49, improvement = 156.38
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -447.57, improvement = 87.46
After minimization: energy = -517.96, improvement = 157.85

Complex relaxation cycle 20/25
After repacking: energy = -447.02, improvement = 86.91
After minimization: energy = -517.91, improvement = 157.80

Complex relaxation cycle 21/25
After repacking: energy = -446.94, improvement = 86.83
After minimization: energy = -515.72, improvement = 155.61
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -447.97, improvement = 87.86
After minimization: energy = -520.71, improvement = 160.60

Complex relaxation cycle 23/25
After repacking: energy = -446.97, improvement = 86.86
After minimization: energy = -520.53, improvement = 160.42

Complex relaxation cycle 24/25
After repacking: energy = -445.79, improvement = 85.68
After minimization: energy = -519.89, improvement = 159.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -447.19, improvement = 87.08
After minimization: energy = -519.89, improvement = 159.78

=== Complex Relaxation Summary ===
Initial energy: -360.11
Final energy: -582.55
Total energy improvement: 222.44 (61.8%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.27 Å
Interface energy: -55.46
Saved relaxed complex structure to docking_results/4_peptide_12mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -582.55
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -55.46

Best binding found with CDR-L2, score: -582.55
Docking complete. Results: {'binding_cdr': 'CDR-L2', 'initial_score': -360.11060145926064, 'relaxed_score': -582.5532031591565, 'interface_energy': -55.45848746410684, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 7, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/4_peptide_12mer_Ab0_CDR-L2_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/4_peptide_12mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.4654075512893696), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 4_peptide_12mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/4_peptide_12mer_Ab1...
Peptide sequence: GLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSER
Antibody has 240 residues
Peptide has 12 residues
Saving antibody to docking_results/4_peptide_12mer_Ab1_antibody.pdb
Saving peptide to docking_results/4_peptide_12mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab1_CDR-H3_combined.pdb
Initial score: 22548.74
  Found better pose: 21271.91
  Found better pose: 18431.38
  Found better pose: 18089.11
  Found better pose: 16899.77
  Found better pose: 15617.15
  Found better pose: 14427.87
  Found better pose: 12254.98
  Found better pose: 11157.31
  Found better pose: 10994.93
  Found better pose: 9793.27
  Found better pose: 8785.43
  Found better pose: 8481.30
  Found better pose: 7880.38
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab1_CDR-H2_combined.pdb
Initial score: 10071.47
  Found better pose: 8957.30
  Found better pose: 8950.89
  Found better pose: 8225.23
  Found better pose: 7582.65
  Found better pose: 7059.77
  Found better pose: 5881.25
  Found better pose: 5223.47
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab1_CDR-H1_combined.pdb
Initial score: 29975.14
  Found better pose: 27247.03
  Found better pose: 25505.13
  Found better pose: 25155.02
  Found better pose: 24492.08
  Found better pose: 23960.88
  Found better pose: 22336.18
  Found better pose: 20974.61
  Found better pose: 19929.78
  Found better pose: 19632.65
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab1_CDR-L3_combined.pdb
Initial score: 8129.66
  Found better pose: 7104.14
  Found better pose: 4255.01
  Found better pose: 3543.96
  Found better pose: 3349.95
  Found better pose: 2289.06
  Found better pose: 1303.76
  Found better pose: 719.47
  Found better pose: 289.43
  Found better pose: 245.81
  Found better pose: -115.53
  Found better pose: -166.69
  Found better pose: -227.19
  Found better pose: -227.58
  Found better pose: -227.60
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -227.60
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -388.36, improvement = 160.76
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 329.21, improvement = -556.81
After minimization: energy = -176.23, improvement = -51.37

Complex relaxation cycle 2/25
After repacking: energy = -180.85, improvement = -46.75
After minimization: energy = -254.07, improvement = 26.47

Complex relaxation cycle 3/25
After repacking: energy = -170.74, improvement = -56.86
After minimization: energy = -230.18, improvement = 2.58

Complex relaxation cycle 4/25
After repacking: energy = -201.84, improvement = -25.76
After minimization: energy = -256.96, improvement = 29.36

Complex relaxation cycle 5/25
After repacking: energy = -214.26, improvement = -13.34
After minimization: energy = -269.22, improvement = 41.62

Complex relaxation cycle 6/25
After repacking: energy = -213.07, improvement = -14.53
After minimization: energy = -268.03, improvement = 40.43
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -183.23, improvement = -44.37
After minimization: energy = -242.75, improvement = 15.15

Complex relaxation cycle 8/25
After repacking: energy = -207.99, improvement = -19.61
After minimization: energy = -272.81, improvement = 45.21

Complex relaxation cycle 9/25
After repacking: energy = -216.78, improvement = -10.82
After minimization: energy = -273.91, improvement = 46.31
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -211.94, improvement = -15.66
After minimization: energy = -264.00, improvement = 36.40

Complex relaxation cycle 11/25
After repacking: energy = -216.08, improvement = -11.52
After minimization: energy = -267.77, improvement = 40.17

Complex relaxation cycle 12/25
After repacking: energy = -230.14, improvement = 2.54
After minimization: energy = -279.77, improvement = 52.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -229.62, improvement = 2.02
After minimization: energy = -279.57, improvement = 51.97

Complex relaxation cycle 14/25
After repacking: energy = -230.08, improvement = 2.47
After minimization: energy = -279.76, improvement = 52.16

Complex relaxation cycle 15/25
After repacking: energy = -228.54, improvement = 0.94
After minimization: energy = -278.36, improvement = 50.76
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -218.01, improvement = -9.59
After minimization: energy = -266.54, improvement = 38.94

Complex relaxation cycle 17/25
After repacking: energy = -218.70, improvement = -8.90
After minimization: energy = -267.76, improvement = 40.16

Complex relaxation cycle 18/25
After repacking: energy = -223.93, improvement = -3.67
After minimization: energy = -273.78, improvement = 46.18
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -218.17, improvement = -9.43
After minimization: energy = -267.74, improvement = 40.14

Complex relaxation cycle 20/25
After repacking: energy = -218.07, improvement = -9.54
After minimization: energy = -266.15, improvement = 38.55

Complex relaxation cycle 21/25
After repacking: energy = -215.52, improvement = -12.08
After minimization: energy = -267.77, improvement = 40.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -191.09, improvement = -36.51
After minimization: energy = -240.50, improvement = 12.90

Complex relaxation cycle 23/25
After repacking: energy = -229.87, improvement = 2.27
After minimization: energy = -279.76, improvement = 52.16

Complex relaxation cycle 24/25
After repacking: energy = -217.98, improvement = -9.62
After minimization: energy = -267.38, improvement = 39.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -224.20, improvement = -3.40
After minimization: energy = -273.79, improvement = 46.19

=== Complex Relaxation Summary ===
Initial energy: -227.60
Final energy: -388.36
Total energy improvement: 160.76 (70.6%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.47 Å
Interface energy: -56.59
Saved relaxed complex structure to docking_results/4_peptide_12mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -388.36
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -56.59

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab1_CDR-L1_combined.pdb
Initial score: 7068.47
  Found better pose: 6601.48
  Found better pose: 6202.07
  Found better pose: 4970.24
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 4970.24
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -290.53, improvement = 5260.78
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 4794.83, improvement = 175.41
After minimization: energy = 11.93, improvement = 4958.32

Complex relaxation cycle 2/25
After repacking: energy = -57.11, improvement = 5027.35
After minimization: energy = -136.58, improvement = 5106.82

Complex relaxation cycle 3/25
After repacking: energy = -104.87, improvement = 5075.11
After minimization: energy = -191.84, improvement = 5162.09

Complex relaxation cycle 4/25
After repacking: energy = -145.65, improvement = 5115.90
After minimization: energy = -192.94, improvement = 5163.19

Complex relaxation cycle 5/25
After repacking: energy = -145.34, improvement = 5115.58
After minimization: energy = -191.79, improvement = 5162.04

Complex relaxation cycle 6/25
After repacking: energy = -146.81, improvement = 5117.05
After minimization: energy = -197.81, improvement = 5168.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -121.42, improvement = 5091.66
After minimization: energy = -180.59, improvement = 5150.84

Complex relaxation cycle 8/25
After repacking: energy = -146.99, improvement = 5117.23
After minimization: energy = -193.16, improvement = 5163.40

Complex relaxation cycle 9/25
After repacking: energy = -132.86, improvement = 5103.10
After minimization: energy = -181.25, improvement = 5151.50
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -105.23, improvement = 5075.47
After minimization: energy = -155.47, improvement = 5125.72

Complex relaxation cycle 11/25
After repacking: energy = -129.79, improvement = 5100.03
After minimization: energy = -183.38, improvement = 5153.63

Complex relaxation cycle 12/25
After repacking: energy = -138.07, improvement = 5108.32
After minimization: energy = -188.22, improvement = 5158.47
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -139.31, improvement = 5109.56
After minimization: energy = -185.79, improvement = 5156.04

Complex relaxation cycle 14/25
After repacking: energy = -153.94, improvement = 5124.18
After minimization: energy = -203.69, improvement = 5173.94

Complex relaxation cycle 15/25
After repacking: energy = -144.28, improvement = 5114.52
After minimization: energy = -191.68, improvement = 5161.92
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -156.64, improvement = 5126.88
After minimization: energy = -203.59, improvement = 5173.84

Complex relaxation cycle 17/25
After repacking: energy = -117.85, improvement = 5088.10
After minimization: energy = -164.98, improvement = 5135.23

Complex relaxation cycle 18/25
After repacking: energy = -156.18, improvement = 5126.42
After minimization: energy = -206.95, improvement = 5177.19
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -147.90, improvement = 5118.15
After minimization: energy = -195.00, improvement = 5165.25

Complex relaxation cycle 20/25
After repacking: energy = -146.98, improvement = 5117.23
After minimization: energy = -194.82, improvement = 5165.06

Complex relaxation cycle 21/25
After repacking: energy = -146.82, improvement = 5117.07
After minimization: energy = -195.53, improvement = 5165.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -147.27, improvement = 5117.51
After minimization: energy = -195.54, improvement = 5165.79

Complex relaxation cycle 23/25
After repacking: energy = -132.32, improvement = 5102.56
After minimization: energy = -180.97, improvement = 5151.22

Complex relaxation cycle 24/25
After repacking: energy = -158.99, improvement = 5129.23
After minimization: energy = -207.61, improvement = 5177.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -158.82, improvement = 5129.07
After minimization: energy = -207.65, improvement = 5177.90

=== Complex Relaxation Summary ===
Initial energy: 4970.24
Final energy: -290.53
Total energy improvement: 5260.78 (105.8%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.99 Å
Interface energy: -39.23
Saved relaxed complex structure to docking_results/4_peptide_12mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -290.53
Checking contacts between peptide and CDR-L1...
Found 55 contacts with CDR-L1 (343.8% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -39.23

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-18.13, 22.72, 9.05)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/4_peptide_12mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/4_peptide_12mer_Ab1_CDR-L2_combined.pdb
Initial score: 16736.51
  Found better pose: 13531.81
  Found better pose: 13228.21
  Found better pose: 12919.31
  Found better pose: 11240.80
  Found better pose: 10987.41
  Found better pose: 8927.12
  Found better pose: 7838.45
  Found better pose: 6939.84
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 6939.84
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 1364.36, improvement = 5575.47
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 6657.82, improvement = 282.01
After minimization: energy = 6158.06, improvement = 781.77

Complex relaxation cycle 2/25
After repacking: energy = 5099.08, improvement = 1840.76
After minimization: energy = 1719.45, improvement = 5220.38

Complex relaxation cycle 3/25
After repacking: energy = 1740.84, improvement = 5198.99
After minimization: energy = 1620.68, improvement = 5319.16

Complex relaxation cycle 4/25
After repacking: energy = 1655.54, improvement = 5284.30
After minimization: energy = 1604.10, improvement = 5335.73

Complex relaxation cycle 5/25
After repacking: energy = 1653.34, improvement = 5286.50
After minimization: energy = 1607.13, improvement = 5332.71

Complex relaxation cycle 6/25
After repacking: energy = 1640.51, improvement = 5299.33
After minimization: energy = 1599.16, improvement = 5340.68
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 1648.89, improvement = 5290.94
After minimization: energy = 1609.79, improvement = 5330.05

Complex relaxation cycle 8/25
After repacking: energy = 1639.58, improvement = 5300.26
After minimization: energy = 1598.48, improvement = 5341.35

Complex relaxation cycle 9/25
After repacking: energy = 1645.01, improvement = 5294.82
After minimization: energy = 1600.40, improvement = 5339.43
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 1634.19, improvement = 5305.65
After minimization: energy = 1593.81, improvement = 5346.02

Complex relaxation cycle 11/25
After repacking: energy = 1672.88, improvement = 5266.96
After minimization: energy = 1631.29, improvement = 5308.55

Complex relaxation cycle 12/25
After repacking: energy = 1633.46, improvement = 5306.38
After minimization: energy = 1601.49, improvement = 5338.35
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 1630.96, improvement = 5308.88
After minimization: energy = 1605.37, improvement = 5334.47

Complex relaxation cycle 14/25
After repacking: energy = 1643.95, improvement = 5295.89
After minimization: energy = 1605.60, improvement = 5334.24

Complex relaxation cycle 15/25
After repacking: energy = 1631.75, improvement = 5308.09
After minimization: energy = 1593.22, improvement = 5346.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 1628.41, improvement = 5311.43
After minimization: energy = 1593.19, improvement = 5346.64

Complex relaxation cycle 17/25
After repacking: energy = 1667.24, improvement = 5272.60
After minimization: energy = 1631.87, improvement = 5307.97

Complex relaxation cycle 18/25
After repacking: energy = 1639.81, improvement = 5300.02
After minimization: energy = 1605.09, improvement = 5334.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 1640.35, improvement = 5299.48
After minimization: energy = 1605.05, improvement = 5334.79

Complex relaxation cycle 20/25
After repacking: energy = 1630.90, improvement = 5308.93
After minimization: energy = 1593.55, improvement = 5346.29

Complex relaxation cycle 21/25
After repacking: energy = 1634.64, improvement = 5305.20
After minimization: energy = 1598.85, improvement = 5340.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 1644.50, improvement = 5295.34
After minimization: energy = 1611.47, improvement = 5328.36

Complex relaxation cycle 23/25
After repacking: energy = 1619.95, improvement = 5319.89
After minimization: energy = 1591.24, improvement = 5348.60

Complex relaxation cycle 24/25
After repacking: energy = 1638.13, improvement = 5301.71
After minimization: energy = 1603.34, improvement = 5336.50
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 1626.12, improvement = 5313.72
After minimization: energy = 1591.60, improvement = 5348.24

=== Complex Relaxation Summary ===
Initial energy: 6939.84
Final energy: 1364.36
Total energy improvement: 5575.47 (80.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 1.73 Å
Interface energy: 1650.37
Saved relaxed complex structure to docking_results/4_peptide_12mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 1364.36
Checking contacts between peptide and CDR-L2...
Found 28 contacts with CDR-L2 (350.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 14
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 1650.37

Best binding found with CDR-L3, score: -388.36
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -227.60114291794267, 'relaxed_score': -388.3564387678591, 'interface_energy': -56.58938479969697, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 8, 'salt_bridges': 0, 'hydrophobic': 5, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/4_peptide_12mer_Ab1_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/4_peptide_12mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.4654075512893696), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 2_peptide_12mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/2_peptide_12mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 2_peptide_12mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/2_peptide_12mer_Ab0...
Peptide sequence: LEUPHEILETYRALAGLYSERGLUGLYPHEASNCYS
Antibody has 232 residues
Peptide has 12 residues
Saving antibody to docking_results/2_peptide_12mer_Ab0_antibody.pdb
Saving peptide to docking_results/2_peptide_12mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab0_CDR-H3_combined.pdb
Initial score: 2091.68
  Found better pose: 916.43
  Found better pose: -92.90
  Found better pose: -366.23
  Found better pose: -367.05
  Found better pose: -396.35
  Found better pose: -396.93
  Found better pose: -397.78
  Found better pose: -398.22
  Found better pose: -398.46
  Found better pose: -398.47
  Found better pose: -398.50
  Found better pose: -398.73
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab0_CDR-H2_combined.pdb
Initial score: 12222.19
  Found better pose: 11306.62
  Found better pose: 9455.65
  Found better pose: 8970.75
  Found better pose: 8962.11
  Found better pose: 8893.80
  Found better pose: 8891.15
  Found better pose: 8748.83
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab0_CDR-H1_combined.pdb
Initial score: 19325.83
  Found better pose: 17699.53
  Found better pose: 17694.59
  Found better pose: 17415.92
  Found better pose: 17367.79
  Found better pose: 17221.91
  Found better pose: 16971.44
  Found better pose: 16387.75
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab0_CDR-L3_combined.pdb
Initial score: -154.57
  Found better pose: -388.91
  Found better pose: -396.19
  Found better pose: -396.80
  Found better pose: -397.19
  Found better pose: -398.16
  Found better pose: -398.38
  Found better pose: -398.54
  Found better pose: -398.64
  Found better pose: -398.64
  Found better pose: -398.68
  Found better pose: -398.73
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -398.73
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -581.26, improvement = 182.53
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -339.23, improvement = -59.50
After minimization: energy = -511.59, improvement = 112.86

Complex relaxation cycle 2/25
After repacking: energy = -314.29, improvement = -84.45
After minimization: energy = -460.94, improvement = 62.21

Complex relaxation cycle 3/25
After repacking: energy = -439.27, improvement = 40.54
After minimization: energy = -510.75, improvement = 112.02

Complex relaxation cycle 4/25
After repacking: energy = -443.13, improvement = 44.40
After minimization: energy = -507.99, improvement = 109.25

Complex relaxation cycle 5/25
After repacking: energy = -440.86, improvement = 42.13
After minimization: energy = -508.33, improvement = 109.60

Complex relaxation cycle 6/25
After repacking: energy = -441.21, improvement = 42.47
After minimization: energy = -508.54, improvement = 109.81
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -437.74, improvement = 39.00
After minimization: energy = -508.37, improvement = 109.64

Complex relaxation cycle 8/25
After repacking: energy = -437.43, improvement = 38.70
After minimization: energy = -507.84, improvement = 109.11

Complex relaxation cycle 9/25
After repacking: energy = -436.50, improvement = 37.77
After minimization: energy = -507.87, improvement = 109.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -438.01, improvement = 39.28
After minimization: energy = -508.49, improvement = 109.76

Complex relaxation cycle 11/25
After repacking: energy = -436.70, improvement = 37.97
After minimization: energy = -507.34, improvement = 108.61

Complex relaxation cycle 12/25
After repacking: energy = -437.34, improvement = 38.61
After minimization: energy = -507.87, improvement = 109.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -437.36, improvement = 38.63
After minimization: energy = -507.62, improvement = 108.89

Complex relaxation cycle 14/25
After repacking: energy = -438.81, improvement = 40.08
After minimization: energy = -507.76, improvement = 109.03

Complex relaxation cycle 15/25
After repacking: energy = -437.16, improvement = 38.43
After minimization: energy = -507.87, improvement = 109.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -437.45, improvement = 38.72
After minimization: energy = -508.38, improvement = 109.65

Complex relaxation cycle 17/25
After repacking: energy = -437.26, improvement = 38.53
After minimization: energy = -507.89, improvement = 109.15

Complex relaxation cycle 18/25
After repacking: energy = -437.08, improvement = 38.35
After minimization: energy = -508.44, improvement = 109.70
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -438.82, improvement = 40.08
After minimization: energy = -508.39, improvement = 109.66

Complex relaxation cycle 20/25
After repacking: energy = -437.98, improvement = 39.25
After minimization: energy = -508.47, improvement = 109.74

Complex relaxation cycle 21/25
After repacking: energy = -438.19, improvement = 39.46
After minimization: energy = -508.31, improvement = 109.58
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -439.35, improvement = 40.62
After minimization: energy = -508.42, improvement = 109.68

Complex relaxation cycle 23/25
After repacking: energy = -436.59, improvement = 37.85
After minimization: energy = -507.41, improvement = 108.68

Complex relaxation cycle 24/25
After repacking: energy = -437.51, improvement = 38.78
After minimization: energy = -507.86, improvement = 109.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -437.61, improvement = 38.88
After minimization: energy = -507.87, improvement = 109.13

=== Complex Relaxation Summary ===
Initial energy: -398.73
Final energy: -581.26
Total energy improvement: 182.53 (45.8%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.27 Å
Interface energy: -49.78
Saved relaxed complex structure to docking_results/2_peptide_12mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -581.26
Checking contacts between peptide and CDR-L3...
Found 41 contacts with CDR-L3 (372.7% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -49.78

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab0_CDR-L1_combined.pdb
Initial score: 6075.52
  Found better pose: 5310.29
  Found better pose: 5205.77
  Found better pose: 5103.35
  Found better pose: 4474.04
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 4474.04
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 3669.12, improvement = 804.92
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 4694.60, improvement = -220.56
After minimization: energy = 3984.61, improvement = 489.43

Complex relaxation cycle 2/25
After repacking: energy = 4095.29, improvement = 378.75
After minimization: energy = 3985.51, improvement = 488.53

Complex relaxation cycle 3/25
After repacking: energy = 4040.40, improvement = 433.64
After minimization: energy = 3992.32, improvement = 481.72

Complex relaxation cycle 4/25
After repacking: energy = 4033.02, improvement = 441.02
After minimization: energy = 3996.30, improvement = 477.74

Complex relaxation cycle 5/25
After repacking: energy = 4017.42, improvement = 456.62
After minimization: energy = 3987.32, improvement = 486.72

Complex relaxation cycle 6/25
After repacking: energy = 4030.17, improvement = 443.87
After minimization: energy = 3986.19, improvement = 487.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 4022.80, improvement = 451.24
After minimization: energy = 3988.55, improvement = 485.49

Complex relaxation cycle 8/25
After repacking: energy = 4017.96, improvement = 456.08
After minimization: energy = 3988.65, improvement = 485.39

Complex relaxation cycle 9/25
After repacking: energy = 4015.74, improvement = 458.30
After minimization: energy = 3992.97, improvement = 481.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 4011.27, improvement = 462.77
After minimization: energy = 3983.68, improvement = 490.36

Complex relaxation cycle 11/25
After repacking: energy = 4019.92, improvement = 454.12
After minimization: energy = 3983.10, improvement = 490.93

Complex relaxation cycle 12/25
After repacking: energy = 4022.55, improvement = 451.49
After minimization: energy = 3985.07, improvement = 488.97
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 4024.73, improvement = 449.31
After minimization: energy = 3989.24, improvement = 484.80

Complex relaxation cycle 14/25
After repacking: energy = 4015.29, improvement = 458.75
After minimization: energy = 3987.64, improvement = 486.40

Complex relaxation cycle 15/25
After repacking: energy = 4016.76, improvement = 457.28
After minimization: energy = 3988.84, improvement = 485.20
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 4018.28, improvement = 455.76
After minimization: energy = 3985.07, improvement = 488.97

Complex relaxation cycle 17/25
After repacking: energy = 4022.57, improvement = 451.47
After minimization: energy = 3993.43, improvement = 480.61

Complex relaxation cycle 18/25
After repacking: energy = 4013.11, improvement = 460.93
After minimization: energy = 3984.98, improvement = 489.06
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 4019.59, improvement = 454.45
After minimization: energy = 3987.35, improvement = 486.69

Complex relaxation cycle 20/25
After repacking: energy = 4024.06, improvement = 449.98
After minimization: energy = 3993.72, improvement = 480.32

Complex relaxation cycle 21/25
After repacking: energy = 4015.17, improvement = 458.87
After minimization: energy = 3989.87, improvement = 484.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 4013.84, improvement = 460.20
After minimization: energy = 3985.62, improvement = 488.42

Complex relaxation cycle 23/25
After repacking: energy = 4017.88, improvement = 456.16
After minimization: energy = 3984.95, improvement = 489.09

Complex relaxation cycle 24/25
After repacking: energy = 4019.43, improvement = 454.61
After minimization: energy = 3992.25, improvement = 481.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 4010.10, improvement = 463.94
After minimization: energy = 3986.83, improvement = 487.21

=== Complex Relaxation Summary ===
Initial energy: 4474.04
Final energy: 3669.12
Total energy improvement: 804.92 (18.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.33 Å
Interface energy: 4188.11
Saved relaxed complex structure to docking_results/2_peptide_12mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: 3669.12
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 4188.11

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab0_CDR-L2_combined.pdb
Initial score: 1589.04
  Found better pose: 92.48
  Found better pose: -184.54
  Found better pose: -302.65
  Found better pose: -333.72
  Found better pose: -396.91
  Found better pose: -397.76
  Found better pose: -397.89
  Found better pose: -398.29
  Found better pose: -398.48
  Found better pose: -398.62
  Found better pose: -398.63
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -398.63
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -583.65, improvement = 185.02
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -338.67, improvement = -59.96
After minimization: energy = -510.38, improvement = 111.75

Complex relaxation cycle 2/25
After repacking: energy = -387.19, improvement = -11.44
After minimization: energy = -498.62, improvement = 99.99

Complex relaxation cycle 3/25
After repacking: energy = -435.77, improvement = 37.14
After minimization: energy = -500.70, improvement = 102.08

Complex relaxation cycle 4/25
After repacking: energy = -418.03, improvement = 19.40
After minimization: energy = -505.06, improvement = 106.43

Complex relaxation cycle 5/25
After repacking: energy = -442.76, improvement = 44.13
After minimization: energy = -506.14, improvement = 107.52

Complex relaxation cycle 6/25
After repacking: energy = -425.90, improvement = 27.28
After minimization: energy = -505.12, improvement = 106.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -443.36, improvement = 44.73
After minimization: energy = -505.96, improvement = 107.33

Complex relaxation cycle 8/25
After repacking: energy = -444.19, improvement = 45.56
After minimization: energy = -511.07, improvement = 112.44

Complex relaxation cycle 9/25
After repacking: energy = -445.88, improvement = 47.25
After minimization: energy = -511.17, improvement = 112.54
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -447.08, improvement = 48.45
After minimization: energy = -511.35, improvement = 112.72

Complex relaxation cycle 11/25
After repacking: energy = -447.25, improvement = 48.62
After minimization: energy = -508.12, improvement = 109.49

Complex relaxation cycle 12/25
After repacking: energy = -449.72, improvement = 51.10
After minimization: energy = -508.48, improvement = 109.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -445.81, improvement = 47.18
After minimization: energy = -505.87, improvement = 107.24

Complex relaxation cycle 14/25
After repacking: energy = -408.25, improvement = 9.63
After minimization: energy = -480.17, improvement = 81.54

Complex relaxation cycle 15/25
After repacking: energy = -397.77, improvement = -0.85
After minimization: energy = -502.24, improvement = 103.61
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -452.02, improvement = 53.39
After minimization: energy = -520.02, improvement = 121.39

Complex relaxation cycle 17/25
After repacking: energy = -386.88, improvement = -11.75
After minimization: energy = -504.78, improvement = 106.15

Complex relaxation cycle 18/25
After repacking: energy = -434.13, improvement = 35.50
After minimization: energy = -504.80, improvement = 106.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -448.32, improvement = 49.70
After minimization: energy = -505.96, improvement = 107.33

Complex relaxation cycle 20/25
After repacking: energy = -432.08, improvement = 33.45
After minimization: energy = -504.68, improvement = 106.06

Complex relaxation cycle 21/25
After repacking: energy = -443.38, improvement = 44.76
After minimization: energy = -519.09, improvement = 120.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -401.97, improvement = 3.34
After minimization: energy = -502.20, improvement = 103.57

Complex relaxation cycle 23/25
After repacking: energy = -433.94, improvement = 35.32
After minimization: energy = -504.76, improvement = 106.13

Complex relaxation cycle 24/25
After repacking: energy = -447.64, improvement = 49.01
After minimization: energy = -506.19, improvement = 107.56
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -448.83, improvement = 50.20
After minimization: energy = -520.05, improvement = 121.42

=== Complex Relaxation Summary ===
Initial energy: -398.63
Final energy: -583.65
Total energy improvement: 185.02 (46.4%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.24 Å
Interface energy: -49.36
Saved relaxed complex structure to docking_results/2_peptide_12mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -583.65
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -49.36

Best binding found with CDR-L2, score: -583.65
Docking complete. Results: {'binding_cdr': 'CDR-L2', 'initial_score': -398.62743909883307, 'relaxed_score': -583.6455756844674, 'interface_energy': -49.361206281907585, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 6, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/2_peptide_12mer_Ab0_CDR-L2_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/2_peptide_12mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 2_peptide_12mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/2_peptide_12mer_Ab1...
Peptide sequence: LEUPHEILETYRALAGLYSERGLUGLYPHEASNCYS
Antibody has 240 residues
Peptide has 12 residues
Saving antibody to docking_results/2_peptide_12mer_Ab1_antibody.pdb
Saving peptide to docking_results/2_peptide_12mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab1_CDR-H3_combined.pdb
Initial score: 11669.76
  Found better pose: 10733.24
  Found better pose: 9375.34
  Found better pose: 7322.68
  Found better pose: 6135.58
  Found better pose: 5572.52
  Found better pose: 3763.79
  Found better pose: 1315.42
  Found better pose: 1119.42
  Found better pose: 980.93
  Found better pose: 753.83
  Found better pose: 83.89
  Found better pose: 37.40
  Found better pose: 7.40
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab1_CDR-H2_combined.pdb
Initial score: 10841.40
  Found better pose: 10685.73
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab1_CDR-H1_combined.pdb
Initial score: 19401.80
  Found better pose: 18562.63
  Found better pose: 17489.53
  Found better pose: 16862.41
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab1_CDR-L3_combined.pdb
Initial score: -220.90
  Found better pose: -221.03
  Found better pose: -221.35
  Found better pose: -221.48
  Found better pose: -221.60
  Found better pose: -221.63
  Found better pose: -222.00
  Found better pose: -222.19
  Found better pose: -222.36
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -222.36
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -374.64, improvement = 152.28
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 351.53, improvement = -573.89
After minimization: energy = -181.51, improvement = -40.85

Complex relaxation cycle 2/25
After repacking: energy = -186.47, improvement = -35.89
After minimization: energy = -259.10, improvement = 36.74

Complex relaxation cycle 3/25
After repacking: energy = -212.95, improvement = -9.41
After minimization: energy = -265.80, improvement = 43.44

Complex relaxation cycle 4/25
After repacking: energy = -207.08, improvement = -15.28
After minimization: energy = -253.79, improvement = 31.43

Complex relaxation cycle 5/25
After repacking: energy = -206.39, improvement = -15.97
After minimization: energy = -250.58, improvement = 28.22

Complex relaxation cycle 6/25
After repacking: energy = -209.06, improvement = -13.30
After minimization: energy = -253.83, improvement = 31.47
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -207.21, improvement = -15.15
After minimization: energy = -254.31, improvement = 31.95

Complex relaxation cycle 8/25
After repacking: energy = -218.69, improvement = -3.67
After minimization: energy = -266.34, improvement = 43.98

Complex relaxation cycle 9/25
After repacking: energy = -212.72, improvement = -9.64
After minimization: energy = -259.85, improvement = 37.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -206.55, improvement = -15.81
After minimization: energy = -254.31, improvement = 31.95

Complex relaxation cycle 11/25
After repacking: energy = -179.61, improvement = -42.74
After minimization: energy = -227.13, improvement = 4.77

Complex relaxation cycle 12/25
After repacking: energy = -199.85, improvement = -22.50
After minimization: energy = -255.53, improvement = 33.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -200.73, improvement = -21.63
After minimization: energy = -254.49, improvement = 32.13

Complex relaxation cycle 14/25
After repacking: energy = -216.45, improvement = -5.91
After minimization: energy = -255.47, improvement = 33.12

Complex relaxation cycle 15/25
After repacking: energy = -208.44, improvement = -13.92
After minimization: energy = -246.54, improvement = 24.18
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -236.82, improvement = 14.46
After minimization: energy = -278.42, improvement = 56.06

Complex relaxation cycle 17/25
After repacking: energy = -241.51, improvement = 19.15
After minimization: energy = -279.76, improvement = 57.40

Complex relaxation cycle 18/25
After repacking: energy = -242.96, improvement = 20.60
After minimization: energy = -283.31, improvement = 60.96
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -233.99, improvement = 11.63
After minimization: energy = -271.27, improvement = 48.91

Complex relaxation cycle 20/25
After repacking: energy = -245.75, improvement = 23.39
After minimization: energy = -283.27, improvement = 60.91

Complex relaxation cycle 21/25
After repacking: energy = -233.52, improvement = 11.16
After minimization: energy = -270.85, improvement = 48.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -238.26, improvement = 15.90
After minimization: energy = -277.01, improvement = 54.65

Complex relaxation cycle 23/25
After repacking: energy = -219.49, improvement = -2.87
After minimization: energy = -256.60, improvement = 34.24

Complex relaxation cycle 24/25
After repacking: energy = -233.37, improvement = 11.01
After minimization: energy = -270.98, improvement = 48.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -207.16, improvement = -15.20
After minimization: energy = -244.58, improvement = 22.22

=== Complex Relaxation Summary ===
Initial energy: -222.36
Final energy: -374.64
Total energy improvement: 152.28 (68.5%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.43 Å
Interface energy: -51.57
Saved relaxed complex structure to docking_results/2_peptide_12mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -374.64
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -51.57

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab1_CDR-L1_combined.pdb
Initial score: 6519.28
  Found better pose: 5949.28
  Found better pose: 5699.69
  Found better pose: 4558.13
  Found better pose: 3418.84
  Found better pose: 2799.87
  Found better pose: 2600.83
  Found better pose: 1574.26
  Found better pose: 1234.01
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 1234.01
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 798.08, improvement = 435.93
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 1533.26, improvement = -299.25
After minimization: energy = 1023.51, improvement = 210.50

Complex relaxation cycle 2/25
After repacking: energy = 1021.54, improvement = 212.47
After minimization: energy = 959.77, improvement = 274.24

Complex relaxation cycle 3/25
After repacking: energy = 980.33, improvement = 253.68
After minimization: energy = 942.19, improvement = 291.82

Complex relaxation cycle 4/25
After repacking: energy = 1029.57, improvement = 204.44
After minimization: energy = 970.44, improvement = 263.57

Complex relaxation cycle 5/25
After repacking: energy = 997.54, improvement = 236.47
After minimization: energy = 948.00, improvement = 286.01

Complex relaxation cycle 6/25
After repacking: energy = 995.65, improvement = 238.36
After minimization: energy = 949.38, improvement = 284.63
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 992.46, improvement = 241.55
After minimization: energy = 945.97, improvement = 288.04

Complex relaxation cycle 8/25
After repacking: energy = 985.75, improvement = 248.26
After minimization: energy = 933.60, improvement = 300.41

Complex relaxation cycle 9/25
After repacking: energy = 989.66, improvement = 244.35
After minimization: energy = 944.52, improvement = 289.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 988.97, improvement = 245.04
After minimization: energy = 944.41, improvement = 289.60

Complex relaxation cycle 11/25
After repacking: energy = 976.91, improvement = 257.10
After minimization: energy = 932.69, improvement = 301.32

Complex relaxation cycle 12/25
After repacking: energy = 989.16, improvement = 244.85
After minimization: energy = 944.31, improvement = 289.70
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 988.55, improvement = 245.46
After minimization: energy = 944.44, improvement = 289.57

Complex relaxation cycle 14/25
After repacking: energy = 976.82, improvement = 257.19
After minimization: energy = 932.43, improvement = 301.58

Complex relaxation cycle 15/25
After repacking: energy = 994.22, improvement = 239.79
After minimization: energy = 949.43, improvement = 284.58
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 990.28, improvement = 243.73
After minimization: energy = 946.80, improvement = 287.21

Complex relaxation cycle 17/25
After repacking: energy = 990.17, improvement = 243.84
After minimization: energy = 943.89, improvement = 290.12

Complex relaxation cycle 18/25
After repacking: energy = 988.75, improvement = 245.26
After minimization: energy = 944.87, improvement = 289.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 989.48, improvement = 244.53
After minimization: energy = 944.46, improvement = 289.55

Complex relaxation cycle 20/25
After repacking: energy = 989.77, improvement = 244.24
After minimization: energy = 944.76, improvement = 289.25

Complex relaxation cycle 21/25
After repacking: energy = 989.42, improvement = 244.59
After minimization: energy = 950.43, improvement = 283.58
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 981.37, improvement = 252.64
After minimization: energy = 944.26, improvement = 289.75

Complex relaxation cycle 23/25
After repacking: energy = 989.54, improvement = 244.47
After minimization: energy = 944.39, improvement = 289.62

Complex relaxation cycle 24/25
After repacking: energy = 976.87, improvement = 257.14
After minimization: energy = 932.21, improvement = 301.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 989.03, improvement = 244.98
After minimization: energy = 944.53, improvement = 289.48

=== Complex Relaxation Summary ===
Initial energy: 1234.01
Final energy: 798.08
Total energy improvement: 435.93 (35.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.70 Å
Interface energy: 1126.31
Saved relaxed complex structure to docking_results/2_peptide_12mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: 798.08
Checking contacts between peptide and CDR-L1...
Found 62 contacts with CDR-L1 (387.5% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 1126.31

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-17.65, 28.40, 19.29)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/2_peptide_12mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/2_peptide_12mer_Ab1_CDR-L2_combined.pdb
Initial score: 9616.12
  Found better pose: 9388.60
  Found better pose: 8163.92
  Found better pose: 7813.64
  Found better pose: 5784.63
  Found better pose: 4412.01
  Found better pose: 2283.64
  Found better pose: 973.49
  Found better pose: 202.83
  Found better pose: 167.27
  Found better pose: 16.96
  Found better pose: -82.25
  Found better pose: -165.15
  Found better pose: -214.94
  Found better pose: -223.22
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -223.22
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -374.32, improvement = 151.11
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 370.87, improvement = -594.09
After minimization: energy = -167.39, improvement = -55.83

Complex relaxation cycle 2/25
After repacking: energy = -188.66, improvement = -34.56
After minimization: energy = -256.62, improvement = 33.40

Complex relaxation cycle 3/25
After repacking: energy = -208.50, improvement = -14.72
After minimization: energy = -253.77, improvement = 30.56

Complex relaxation cycle 4/25
After repacking: energy = -209.60, improvement = -13.62
After minimization: energy = -257.98, improvement = 34.76

Complex relaxation cycle 5/25
After repacking: energy = -209.39, improvement = -13.83
After minimization: energy = -255.48, improvement = 32.27

Complex relaxation cycle 6/25
After repacking: energy = -208.80, improvement = -14.41
After minimization: energy = -258.32, improvement = 35.10
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -179.89, improvement = -43.33
After minimization: energy = -227.85, improvement = 4.63

Complex relaxation cycle 8/25
After repacking: energy = -205.75, improvement = -17.47
After minimization: energy = -259.15, improvement = 35.93

Complex relaxation cycle 9/25
After repacking: energy = -222.34, improvement = -0.88
After minimization: energy = -264.56, improvement = 41.34
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -228.26, improvement = 5.05
After minimization: energy = -270.76, improvement = 47.55

Complex relaxation cycle 11/25
After repacking: energy = -217.86, improvement = -5.36
After minimization: energy = -260.21, improvement = 36.99

Complex relaxation cycle 12/25
After repacking: energy = -218.10, improvement = -5.12
After minimization: energy = -260.45, improvement = 37.23
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -218.10, improvement = -5.12
After minimization: energy = -260.46, improvement = 37.25

Complex relaxation cycle 14/25
After repacking: energy = -229.56, improvement = 6.34
After minimization: energy = -272.00, improvement = 48.78

Complex relaxation cycle 15/25
After repacking: energy = -230.04, improvement = 6.82
After minimization: energy = -272.06, improvement = 48.84
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -230.35, improvement = 7.14
After minimization: energy = -272.49, improvement = 49.28

Complex relaxation cycle 17/25
After repacking: energy = -218.46, improvement = -4.75
After minimization: energy = -260.47, improvement = 37.26

Complex relaxation cycle 18/25
After repacking: energy = -218.37, improvement = -4.84
After minimization: energy = -260.44, improvement = 37.22
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -230.71, improvement = 7.50
After minimization: energy = -274.07, improvement = 50.85

Complex relaxation cycle 20/25
After repacking: energy = -227.30, improvement = 4.08
After minimization: energy = -274.14, improvement = 50.92

Complex relaxation cycle 21/25
After repacking: energy = -209.96, improvement = -13.25
After minimization: energy = -257.71, improvement = 34.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -226.72, improvement = 3.50
After minimization: energy = -270.79, improvement = 47.57

Complex relaxation cycle 23/25
After repacking: energy = -218.25, improvement = -4.97
After minimization: energy = -269.23, improvement = 46.01

Complex relaxation cycle 24/25
After repacking: energy = -189.32, improvement = -33.89
After minimization: energy = -235.16, improvement = 11.95
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -226.32, improvement = 3.10
After minimization: energy = -274.26, improvement = 51.04

=== Complex Relaxation Summary ===
Initial energy: -223.22
Final energy: -374.32
Total energy improvement: 151.11 (67.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.65 Å
Interface energy: -53.63
Saved relaxed complex structure to docking_results/2_peptide_12mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -374.32
Checking contacts between peptide and CDR-L2...
Found 30 contacts with CDR-L2 (375.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -53.63

Best binding found with CDR-L3, score: -374.64
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -222.35934908132273, 'relaxed_score': -374.63589102281736, 'interface_energy': -51.56588588777879, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 8, 'salt_bridges': 0, 'hydrophobic': 5, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/2_peptide_12mer_Ab1_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/2_peptide_12mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 1_peptide_20mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/1_peptide_20mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 1_peptide_20mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/1_peptide_20mer_Ab0...
Peptide sequence: ASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLN
Antibody has 232 residues
Peptide has 20 residues
Saving antibody to docking_results/1_peptide_20mer_Ab0_antibody.pdb
Saving peptide to docking_results/1_peptide_20mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab0_CDR-H3_combined.pdb
Initial score: 25706.82
  Found better pose: 24071.59
  Found better pose: 23070.81
  Found better pose: 21374.84
  Found better pose: 20709.79
  Found better pose: 18257.90
  Found better pose: 18186.51
  Found better pose: 17734.57
  Found better pose: 17732.52
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab0_CDR-H2_combined.pdb
Initial score: 19166.93
  Found better pose: 16026.62
  Found better pose: 14498.88
  Found better pose: 13687.18
  Found better pose: 9730.96
  Found better pose: 6948.01
  Found better pose: 6912.45
  Found better pose: 4187.49
  Found better pose: 2519.11
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab0_CDR-H1_combined.pdb
Initial score: 27380.46
  Found better pose: 23902.72
  Found better pose: 21122.17
  Found better pose: 18517.48
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab0_CDR-L3_combined.pdb
Initial score: 21543.79
  Found better pose: 20486.59
  Found better pose: 17454.83
  Found better pose: 16896.05
  Found better pose: 16486.54
  Found better pose: 15713.07
  Found better pose: 15036.86
  Found better pose: 15007.40
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 15007.40
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -477.89, improvement = 15485.29
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 14728.16, improvement = 279.25
After minimization: energy = 18906.83, improvement = -3899.43

Complex relaxation cycle 2/25
After repacking: energy = 15350.58, improvement = -343.18
After minimization: energy = 2630.24, improvement = 12377.16

Complex relaxation cycle 3/25
After repacking: energy = 2305.41, improvement = 12701.99
After minimization: energy = -341.91, improvement = 15349.31

Complex relaxation cycle 4/25
After repacking: energy = -234.11, improvement = 15241.51
After minimization: energy = -368.56, improvement = 15375.96

Complex relaxation cycle 5/25
After repacking: energy = -302.44, improvement = 15309.84
After minimization: energy = -375.53, improvement = 15382.93

Complex relaxation cycle 6/25
After repacking: energy = -323.81, improvement = 15331.21
After minimization: energy = -379.03, improvement = 15386.43
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -323.79, improvement = 15331.20
After minimization: energy = -382.14, improvement = 15389.54

Complex relaxation cycle 8/25
After repacking: energy = -328.19, improvement = 15335.60
After minimization: energy = -380.63, improvement = 15388.03

Complex relaxation cycle 9/25
After repacking: energy = -329.31, improvement = 15336.71
After minimization: energy = -380.67, improvement = 15388.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -326.15, improvement = 15333.55
After minimization: energy = -381.63, improvement = 15389.03

Complex relaxation cycle 11/25
After repacking: energy = -333.94, improvement = 15341.34
After minimization: energy = -381.87, improvement = 15389.28

Complex relaxation cycle 12/25
After repacking: energy = -295.72, improvement = 15303.12
After minimization: energy = -348.38, improvement = 15355.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -334.07, improvement = 15341.48
After minimization: energy = -386.76, improvement = 15394.16

Complex relaxation cycle 14/25
After repacking: energy = -335.98, improvement = 15343.38
After minimization: energy = -387.13, improvement = 15394.53

Complex relaxation cycle 15/25
After repacking: energy = -335.50, improvement = 15342.90
After minimization: energy = -387.10, improvement = 15394.51
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -335.69, improvement = 15343.09
After minimization: energy = -386.86, improvement = 15394.27

Complex relaxation cycle 17/25
After repacking: energy = -331.24, improvement = 15338.65
After minimization: energy = -390.70, improvement = 15398.11

Complex relaxation cycle 18/25
After repacking: energy = -337.09, improvement = 15344.49
After minimization: energy = -391.02, improvement = 15398.42
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -336.59, improvement = 15343.99
After minimization: energy = -390.89, improvement = 15398.29

Complex relaxation cycle 20/25
After repacking: energy = -336.81, improvement = 15344.21
After minimization: energy = -391.12, improvement = 15398.52

Complex relaxation cycle 21/25
After repacking: energy = -336.60, improvement = 15344.00
After minimization: energy = -390.58, improvement = 15397.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -336.70, improvement = 15344.10
After minimization: energy = -390.54, improvement = 15397.94

Complex relaxation cycle 23/25
After repacking: energy = -337.31, improvement = 15344.71
After minimization: energy = -391.01, improvement = 15398.42

Complex relaxation cycle 24/25
After repacking: energy = -336.40, improvement = 15343.80
After minimization: energy = -390.94, improvement = 15398.34
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -336.67, improvement = 15344.08
After minimization: energy = -391.03, improvement = 15398.43

=== Complex Relaxation Summary ===
Initial energy: 15007.40
Final energy: -477.89
Total energy improvement: 15485.29 (103.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 1.47 Å
Interface energy: -63.72
Saved relaxed complex structure to docking_results/1_peptide_20mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -477.89
Checking contacts between peptide and CDR-L3...
Found 33 contacts with CDR-L3 (300.0% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -63.72

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab0_CDR-L1_combined.pdb
Initial score: 19585.23
  Found better pose: 18267.32
  Found better pose: 17881.40
  Found better pose: 14860.21
  Found better pose: 14030.91
  Found better pose: 9733.99
  Found better pose: 8519.14
  Found better pose: 4936.03
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 4936.03
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -361.33, improvement = 5297.37
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 1286.18, improvement = 3649.85
After minimization: energy = -311.45, improvement = 5247.49

Complex relaxation cycle 2/25
After repacking: energy = -210.36, improvement = 5146.40
After minimization: energy = -321.47, improvement = 5257.51

Complex relaxation cycle 3/25
After repacking: energy = -249.17, improvement = 5185.20
After minimization: energy = -335.73, improvement = 5271.77

Complex relaxation cycle 4/25
After repacking: energy = -249.39, improvement = 5185.42
After minimization: energy = -335.55, improvement = 5271.59

Complex relaxation cycle 5/25
After repacking: energy = -251.96, improvement = 5187.99
After minimization: energy = -335.71, improvement = 5271.74

Complex relaxation cycle 6/25
After repacking: energy = -251.23, improvement = 5187.27
After minimization: energy = -335.83, improvement = 5271.86
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -255.24, improvement = 5191.28
After minimization: energy = -336.03, improvement = 5272.07

Complex relaxation cycle 8/25
After repacking: energy = -252.41, improvement = 5188.45
After minimization: energy = -335.47, improvement = 5271.50

Complex relaxation cycle 9/25
After repacking: energy = -250.16, improvement = 5186.20
After minimization: energy = -335.90, improvement = 5271.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -253.74, improvement = 5189.77
After minimization: energy = -335.82, improvement = 5271.85

Complex relaxation cycle 11/25
After repacking: energy = -251.57, improvement = 5187.61
After minimization: energy = -335.91, improvement = 5271.94

Complex relaxation cycle 12/25
After repacking: energy = -251.62, improvement = 5187.66
After minimization: energy = -335.81, improvement = 5271.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -252.24, improvement = 5188.27
After minimization: energy = -336.05, improvement = 5272.09

Complex relaxation cycle 14/25
After repacking: energy = -252.30, improvement = 5188.33
After minimization: energy = -335.97, improvement = 5272.01

Complex relaxation cycle 15/25
After repacking: energy = -250.41, improvement = 5186.45
After minimization: energy = -335.48, improvement = 5271.51
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -248.45, improvement = 5184.49
After minimization: energy = -334.98, improvement = 5271.02

Complex relaxation cycle 17/25
After repacking: energy = -252.85, improvement = 5188.89
After minimization: energy = -335.83, improvement = 5271.86

Complex relaxation cycle 18/25
After repacking: energy = -250.90, improvement = 5186.93
After minimization: energy = -336.03, improvement = 5272.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -252.77, improvement = 5188.80
After minimization: energy = -336.04, improvement = 5272.08

Complex relaxation cycle 20/25
After repacking: energy = -252.75, improvement = 5188.79
After minimization: energy = -335.96, improvement = 5271.99

Complex relaxation cycle 21/25
After repacking: energy = -252.79, improvement = 5188.82
After minimization: energy = -335.86, improvement = 5271.90
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -254.81, improvement = 5190.85
After minimization: energy = -335.85, improvement = 5271.88

Complex relaxation cycle 23/25
After repacking: energy = -251.49, improvement = 5187.53
After minimization: energy = -335.91, improvement = 5271.94

Complex relaxation cycle 24/25
After repacking: energy = -253.33, improvement = 5189.37
After minimization: energy = -335.84, improvement = 5271.87
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -250.22, improvement = 5186.26
After minimization: energy = -336.04, improvement = 5272.07

=== Complex Relaxation Summary ===
Initial energy: 4936.03
Final energy: -361.33
Total energy improvement: 5297.37 (107.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.51 Å
Interface energy: 137.70
Saved relaxed complex structure to docking_results/1_peptide_20mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -361.33
Checking contacts between peptide and CDR-L1...
Found 60 contacts with CDR-L1 (375.0% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 137.70

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab0_CDR-L2_combined.pdb
Initial score: 32556.82
  Found better pose: 29528.14
  Found better pose: 27317.70
  Found better pose: 25253.62
  Found better pose: 24745.18
  Found better pose: 22717.89
  Found better pose: 19238.20
  Found better pose: 16484.83
  Found better pose: 15899.34
  Found better pose: 15629.72
  Found better pose: 12232.70
  Found better pose: 12019.50
  Found better pose: 10619.16
  Found better pose: 10199.26
  Found better pose: 9091.13
  Found better pose: 8946.14
  Found better pose: 7390.01
  Found better pose: 4998.32
  Found better pose: 3133.36
  Found better pose: 1627.06
  Found better pose: 132.04
  Found better pose: -316.74
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -316.74
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -587.50, improvement = 270.76
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -339.42, improvement = 22.68
After minimization: energy = -508.88, improvement = 192.15

Complex relaxation cycle 2/25
After repacking: energy = -361.02, improvement = 44.28
After minimization: energy = -495.63, improvement = 178.89

Complex relaxation cycle 3/25
After repacking: energy = -437.38, improvement = 120.64
After minimization: energy = -501.70, improvement = 184.96

Complex relaxation cycle 4/25
After repacking: energy = -441.78, improvement = 125.04
After minimization: energy = -510.12, improvement = 193.38

Complex relaxation cycle 5/25
After repacking: energy = -440.73, improvement = 123.99
After minimization: energy = -502.98, improvement = 186.25

Complex relaxation cycle 6/25
After repacking: energy = -444.48, improvement = 127.74
After minimization: energy = -507.40, improvement = 190.66
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -445.22, improvement = 128.48
After minimization: energy = -507.45, improvement = 190.71

Complex relaxation cycle 8/25
After repacking: energy = -444.96, improvement = 128.22
After minimization: energy = -508.38, improvement = 191.64

Complex relaxation cycle 9/25
After repacking: energy = -444.58, improvement = 127.85
After minimization: energy = -508.32, improvement = 191.58
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -442.39, improvement = 125.65
After minimization: energy = -508.24, improvement = 191.51

Complex relaxation cycle 11/25
After repacking: energy = -439.41, improvement = 122.67
After minimization: energy = -508.29, improvement = 191.55

Complex relaxation cycle 12/25
After repacking: energy = -440.34, improvement = 123.60
After minimization: energy = -508.11, improvement = 191.37
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -441.11, improvement = 124.37
After minimization: energy = -508.33, improvement = 191.59

Complex relaxation cycle 14/25
After repacking: energy = -441.62, improvement = 124.89
After minimization: energy = -508.31, improvement = 191.58

Complex relaxation cycle 15/25
After repacking: energy = -440.74, improvement = 124.00
After minimization: energy = -508.11, improvement = 191.37
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -442.53, improvement = 125.79
After minimization: energy = -508.37, improvement = 191.63

Complex relaxation cycle 17/25
After repacking: energy = -441.66, improvement = 124.92
After minimization: energy = -508.05, improvement = 191.31

Complex relaxation cycle 18/25
After repacking: energy = -441.49, improvement = 124.75
After minimization: energy = -508.50, improvement = 191.76
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -440.44, improvement = 123.70
After minimization: energy = -508.23, improvement = 191.49

Complex relaxation cycle 20/25
After repacking: energy = -441.59, improvement = 124.85
After minimization: energy = -508.01, improvement = 191.27

Complex relaxation cycle 21/25
After repacking: energy = -442.09, improvement = 125.35
After minimization: energy = -508.48, improvement = 191.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -440.71, improvement = 123.97
After minimization: energy = -508.36, improvement = 191.62

Complex relaxation cycle 23/25
After repacking: energy = -440.68, improvement = 123.94
After minimization: energy = -508.34, improvement = 191.60

Complex relaxation cycle 24/25
After repacking: energy = -441.82, improvement = 125.08
After minimization: energy = -508.38, improvement = 191.64
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -439.51, improvement = 122.77
After minimization: energy = -508.38, improvement = 191.64

=== Complex Relaxation Summary ===
Initial energy: -316.74
Final energy: -587.50
Total energy improvement: 270.76 (85.5%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.27 Å
Interface energy: -58.59
Saved relaxed complex structure to docking_results/1_peptide_20mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -587.50
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -58.59

Best binding found with CDR-L2, score: -587.50
Docking complete. Results: {'binding_cdr': 'CDR-L2', 'initial_score': -316.7382774852994, 'relaxed_score': -587.4999468540543, 'interface_energy': -58.587803531129, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 6, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/1_peptide_20mer_Ab0_CDR-L2_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/1_peptide_20mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.19675400267922802), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 1_peptide_20mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/1_peptide_20mer_Ab1...
Peptide sequence: ASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLN
Antibody has 240 residues
Peptide has 20 residues
Saving antibody to docking_results/1_peptide_20mer_Ab1_antibody.pdb
Saving peptide to docking_results/1_peptide_20mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab1_CDR-H3_combined.pdb
Initial score: 31288.35
  Found better pose: 30760.72
  Found better pose: 27807.82
  Found better pose: 24907.80
  Found better pose: 22230.89
  Found better pose: 21781.52
  Found better pose: 21054.12
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab1_CDR-H2_combined.pdb
Initial score: 14228.29
  Found better pose: 11311.43
  Found better pose: 6735.77
  Found better pose: 5076.52
  Found better pose: 3087.75
  Found better pose: 2378.13
  Found better pose: 1993.84
  Found better pose: 1035.59
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab1_CDR-H1_combined.pdb
Initial score: 29119.49
  Found better pose: 28792.72
  Found better pose: 27449.60
  Found better pose: 24338.98
  Found better pose: 20437.96
  Found better pose: 19756.91
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab1_CDR-L3_combined.pdb
Initial score: 24198.75
  Found better pose: 22991.19
  Found better pose: 22048.35
  Found better pose: 21009.14
  Found better pose: 19550.78
  Found better pose: 18747.98
  Found better pose: 18705.00
  Found better pose: 17667.74
  Found better pose: 15829.93
  Found better pose: 13604.04
  Found better pose: 13116.61
  Found better pose: 11725.15
  Found better pose: 11659.40
  Found better pose: 10475.85
  Found better pose: 9021.74
  Found better pose: 6133.96
  Found better pose: 3195.20
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 3195.20
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -353.64, improvement = 3548.84
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 2696.15, improvement = 499.05
After minimization: energy = -137.06, improvement = 3332.27

Complex relaxation cycle 2/25
After repacking: energy = -154.37, improvement = 3349.58
After minimization: energy = -241.08, improvement = 3436.28

Complex relaxation cycle 3/25
After repacking: energy = -192.83, improvement = 3388.03
After minimization: energy = -241.51, improvement = 3436.71

Complex relaxation cycle 4/25
After repacking: energy = -189.18, improvement = 3384.39
After minimization: energy = -241.39, improvement = 3436.60

Complex relaxation cycle 5/25
After repacking: energy = -177.08, improvement = 3372.29
After minimization: energy = -233.09, improvement = 3428.29

Complex relaxation cycle 6/25
After repacking: energy = -178.64, improvement = 3373.85
After minimization: energy = -233.97, improvement = 3429.17
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -186.57, improvement = 3381.78
After minimization: energy = -235.25, improvement = 3430.46

Complex relaxation cycle 8/25
After repacking: energy = -173.43, improvement = 3368.64
After minimization: energy = -234.79, improvement = 3429.99

Complex relaxation cycle 9/25
After repacking: energy = 1438.68, improvement = 1756.53
After minimization: energy = -198.30, improvement = 3393.50
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -171.48, improvement = 3366.69
After minimization: energy = -221.09, improvement = 3416.29

Complex relaxation cycle 11/25
After repacking: energy = 201.93, improvement = 2993.28
After minimization: energy = -219.65, improvement = 3414.86

Complex relaxation cycle 12/25
After repacking: energy = -153.83, improvement = 3349.04
After minimization: energy = -221.68, improvement = 3416.88
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -146.80, improvement = 3342.01
After minimization: energy = -221.52, improvement = 3416.73

Complex relaxation cycle 14/25
After repacking: energy = -148.64, improvement = 3343.85
After minimization: energy = -222.92, improvement = 3418.13

Complex relaxation cycle 15/25
After repacking: energy = -159.94, improvement = 3355.15
After minimization: energy = -234.92, improvement = 3430.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -147.16, improvement = 3342.36
After minimization: energy = -222.93, improvement = 3418.13

Complex relaxation cycle 17/25
After repacking: energy = -146.72, improvement = 3341.92
After minimization: energy = -226.22, improvement = 3421.42

Complex relaxation cycle 18/25
After repacking: energy = -174.71, improvement = 3369.92
After minimization: energy = -243.50, improvement = 3438.71
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -185.34, improvement = 3380.54
After minimization: energy = -248.35, improvement = 3443.55

Complex relaxation cycle 20/25
After repacking: energy = -162.83, improvement = 3358.03
After minimization: energy = -221.93, improvement = 3417.13

Complex relaxation cycle 21/25
After repacking: energy = -180.69, improvement = 3375.90
After minimization: energy = -236.53, improvement = 3431.73
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -155.80, improvement = 3351.00
After minimization: energy = -209.55, improvement = 3404.76

Complex relaxation cycle 23/25
After repacking: energy = -197.71, improvement = 3392.91
After minimization: energy = -248.50, improvement = 3443.71

Complex relaxation cycle 24/25
After repacking: energy = -197.38, improvement = 3392.59
After minimization: energy = -248.50, improvement = 3443.70
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -171.10, improvement = 3366.30
After minimization: energy = -221.83, improvement = 3417.04

=== Complex Relaxation Summary ===
Initial energy: 3195.20
Final energy: -353.64
Total energy improvement: 3548.84 (111.1%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.72 Å
Interface energy: -50.21
Saved relaxed complex structure to docking_results/1_peptide_20mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -353.64
Checking contacts between peptide and CDR-L3...
Found 39 contacts with CDR-L3 (354.5% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -50.21

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab1_CDR-L1_combined.pdb
Initial score: 16974.50
  Found better pose: 14267.11
  Found better pose: 13990.10
  Found better pose: 13696.42
  Found better pose: 13140.25
  Found better pose: 12826.79
  Found better pose: 11651.74
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 11651.74
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 405.06, improvement = 11246.68
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 8818.87, improvement = 2832.87
After minimization: energy = 4670.70, improvement = 6981.04

Complex relaxation cycle 2/25
After repacking: energy = 4002.61, improvement = 7649.13
After minimization: energy = -99.27, improvement = 11751.01
Cycle 2 produced the best structure so far

Complex relaxation cycle 3/25
After repacking: energy = 102.91, improvement = 11548.83
After minimization: energy = -140.58, improvement = 11792.32
Cycle 3 produced the best structure so far

Complex relaxation cycle 4/25
After repacking: energy = 1436.61, improvement = 10215.13
After minimization: energy = -135.87, improvement = 11787.61

Complex relaxation cycle 5/25
After repacking: energy = 377.78, improvement = 11273.96
After minimization: energy = -151.45, improvement = 11803.19
Cycle 5 produced the best structure so far

Complex relaxation cycle 6/25
After repacking: energy = 309.29, improvement = 11342.44
After minimization: energy = -157.38, improvement = 11809.12
Cycle 6 produced the best structure so far
Still seeing improvements (best was cycle 7)

Complex relaxation cycle 7/25
After repacking: energy = 507.56, improvement = 11144.18
After minimization: energy = -145.85, improvement = 11797.59

Complex relaxation cycle 8/25
After repacking: energy = 512.59, improvement = 11139.15
After minimization: energy = -159.17, improvement = 11810.91
Cycle 8 produced the best structure so far

Complex relaxation cycle 9/25
After repacking: energy = 554.13, improvement = 11097.61
After minimization: energy = -149.48, improvement = 11801.22
Still seeing improvements (best was cycle 9)

Complex relaxation cycle 10/25
After repacking: energy = 567.15, improvement = 11084.59
After minimization: energy = -137.46, improvement = 11789.20

Complex relaxation cycle 11/25
After repacking: energy = 572.05, improvement = 11079.69
After minimization: energy = -137.49, improvement = 11789.23

Complex relaxation cycle 12/25
After repacking: energy = 557.00, improvement = 11094.74
After minimization: energy = -149.51, improvement = 11801.24
Still seeing improvements (best was cycle 9)

Complex relaxation cycle 13/25
After repacking: energy = 567.56, improvement = 11084.18
After minimization: energy = -137.26, improvement = 11789.00

Complex relaxation cycle 14/25
After repacking: energy = 559.48, improvement = 11092.25
After minimization: energy = -157.76, improvement = 11809.50

Complex relaxation cycle 15/25
After repacking: energy = 628.21, improvement = 11023.53
After minimization: energy = -146.43, improvement = 11798.17
No improvement in last 3 cycles (best was cycle 9)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 533.25, improvement = 11118.49
After minimization: energy = -130.39, improvement = 11782.12

Complex relaxation cycle 17/25
After repacking: energy = 570.67, improvement = 11081.07
After minimization: energy = -118.48, improvement = 11770.22

Complex relaxation cycle 18/25
After repacking: energy = 542.25, improvement = 11109.49
After minimization: energy = -156.25, improvement = 11807.99
No improvement in last 3 cycles (best was cycle 9)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 574.40, improvement = 11077.34
After minimization: energy = -150.24, improvement = 11801.98

Complex relaxation cycle 20/25
After repacking: energy = 563.11, improvement = 11088.63
After minimization: energy = -156.26, improvement = 11808.00

Complex relaxation cycle 21/25
After repacking: energy = 567.00, improvement = 11084.74
After minimization: energy = -147.86, improvement = 11799.60
No improvement in last 3 cycles (best was cycle 9)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 615.90, improvement = 11035.84
After minimization: energy = -144.12, improvement = 11795.86

Complex relaxation cycle 23/25
After repacking: energy = 567.75, improvement = 11083.99
After minimization: energy = -145.06, improvement = 11796.80

Complex relaxation cycle 24/25
After repacking: energy = 570.34, improvement = 11081.40
After minimization: energy = -144.11, improvement = 11795.85
No improvement in last 3 cycles (best was cycle 9)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 583.49, improvement = 11068.25
After minimization: energy = -143.68, improvement = 11795.42

=== Complex Relaxation Summary ===
Initial energy: 11651.74
Final energy: -159.17
Total energy improvement: 11810.91 (101.4%)
Best structure was from cycle 9
Structure change: CA RMSD = 2.24 Å
Interface energy: -46.33
Saved relaxed complex structure to docking_results/1_peptide_20mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -159.17
Checking contacts between peptide and CDR-L1...
Found 54 contacts with CDR-L1 (337.5% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -46.33

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-10.66, 53.76, -7.56)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/1_peptide_20mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/1_peptide_20mer_Ab1_CDR-L2_combined.pdb
Initial score: 25256.58
  Found better pose: 22383.24
  Found better pose: 20624.24
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 20624.24
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 3359.06, improvement = 17265.18
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 17387.73, improvement = 3236.51
After minimization: energy = 7812.96, improvement = 12811.28

Complex relaxation cycle 2/25
After repacking: energy = 5702.29, improvement = 14921.95
After minimization: energy = 5146.19, improvement = 15478.05

Complex relaxation cycle 3/25
After repacking: energy = 5132.55, improvement = 15491.68
After minimization: energy = 5100.09, improvement = 15524.14

Complex relaxation cycle 4/25
After repacking: energy = 5115.85, improvement = 15508.39
After minimization: energy = 5098.02, improvement = 15526.22

Complex relaxation cycle 5/25
After repacking: energy = 5145.68, improvement = 15478.56
After minimization: energy = 5132.48, improvement = 15491.76

Complex relaxation cycle 6/25
After repacking: energy = 5089.01, improvement = 15535.23
After minimization: energy = 5088.90, improvement = 15535.34
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 5103.04, improvement = 15521.20
After minimization: energy = 5103.02, improvement = 15521.22

Complex relaxation cycle 8/25
After repacking: energy = 5142.38, improvement = 15481.86
After minimization: energy = 5142.33, improvement = 15481.91

Complex relaxation cycle 9/25
After repacking: energy = 5116.19, improvement = 15508.05
After minimization: energy = 5116.17, improvement = 15508.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 5104.17, improvement = 15520.07
After minimization: energy = 5104.16, improvement = 15520.08

Complex relaxation cycle 11/25
After repacking: energy = 5088.82, improvement = 15535.42
After minimization: energy = 5088.80, improvement = 15535.44

Complex relaxation cycle 12/25
After repacking: energy = 5141.67, improvement = 15482.57
After minimization: energy = 5141.66, improvement = 15482.58
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 5088.79, improvement = 15535.44
After minimization: energy = 5088.78, improvement = 15535.46

Complex relaxation cycle 14/25
After repacking: energy = 5128.76, improvement = 15495.48
After minimization: energy = 5128.75, improvement = 15495.49

Complex relaxation cycle 15/25
After repacking: energy = 5076.77, improvement = 15547.47
After minimization: energy = 5076.76, improvement = 15547.48
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 5115.49, improvement = 15508.75
After minimization: energy = 5115.48, improvement = 15508.76

Complex relaxation cycle 17/25
After repacking: energy = 5102.90, improvement = 15521.34
After minimization: energy = 5102.88, improvement = 15521.36

Complex relaxation cycle 18/25
After repacking: energy = 5119.96, improvement = 15504.28
After minimization: energy = 5119.95, improvement = 15504.29
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 5088.75, improvement = 15535.49
After minimization: energy = 5088.74, improvement = 15535.50

Complex relaxation cycle 20/25
After repacking: energy = 5076.73, improvement = 15547.51
After minimization: energy = 5076.72, improvement = 15547.52

Complex relaxation cycle 21/25
After repacking: energy = 5088.73, improvement = 15535.51
After minimization: energy = 5088.72, improvement = 15535.52
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 5114.87, improvement = 15509.37
After minimization: energy = 5114.86, improvement = 15509.38

Complex relaxation cycle 23/25
After repacking: energy = 5115.49, improvement = 15508.75
After minimization: energy = 5115.48, improvement = 15508.76

Complex relaxation cycle 24/25
After repacking: energy = 5088.73, improvement = 15535.51
After minimization: energy = 5088.68, improvement = 15535.56
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 5076.68, improvement = 15547.56
After minimization: energy = 5076.67, improvement = 15547.57

=== Complex Relaxation Summary ===
Initial energy: 20624.24
Final energy: 3359.06
Total energy improvement: 17265.18 (83.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 2.12 Å
Interface energy: 3626.07
Saved relaxed complex structure to docking_results/1_peptide_20mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 3359.06
Checking contacts between peptide and CDR-L2...
Found 31 contacts with CDR-L2 (387.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 3626.07

Best binding found with CDR-L3, score: -353.64
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': 3195.2044928255427, 'relaxed_score': -353.63894170939466, 'interface_energy': -50.21262807793573, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 8, 'salt_bridges': 0, 'hydrophobic': 5, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/1_peptide_20mer_Ab1_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/1_peptide_20mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.19675400267922802), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 4_peptide_20mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/4_peptide_20mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 4_peptide_20mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/4_peptide_20mer_Ab0...
Peptide sequence: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYS
Antibody has 232 residues
Peptide has 20 residues
Saving antibody to docking_results/4_peptide_20mer_Ab0_antibody.pdb
Saving peptide to docking_results/4_peptide_20mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab0_CDR-H3_combined.pdb
Initial score: 122.17
  Found better pose: -294.17
  Found better pose: -380.48
  Found better pose: -399.87
  Found better pose: -400.48
  Found better pose: -400.56
  Found better pose: -400.70
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab0_CDR-H2_combined.pdb
Initial score: 1276.20
  Found better pose: 1233.28
  Found better pose: 427.83
  Found better pose: 29.76
  Found better pose: -348.23
  Found better pose: -362.28
  Found better pose: -396.76
  Found better pose: -397.90
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab0_CDR-H1_combined.pdb
Initial score: 25820.10
  Found better pose: 23105.78
  Found better pose: 20501.76
  Found better pose: 19154.92
  Found better pose: 18082.68
  Found better pose: 16588.16
  Found better pose: 15413.12
  Found better pose: 14850.51
  Found better pose: 13691.54
  Found better pose: 13238.19
  Found better pose: 11767.07
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab0_CDR-L3_combined.pdb
Initial score: 1624.83
  Found better pose: 938.06
  Found better pose: 339.39
  Found better pose: 12.85
  Found better pose: -216.39
  Found better pose: -391.03
  Found better pose: -391.87
  Found better pose: -397.70
  Found better pose: -398.25
  Found better pose: -399.10
  Found better pose: -399.14
  Found better pose: -399.51
  Found better pose: -399.64
  Found better pose: -399.72
  Found better pose: -399.73
  Found better pose: -399.74
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -399.74
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -578.68, improvement = 178.94
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -339.47, improvement = -60.27
After minimization: energy = -510.36, improvement = 110.63

Complex relaxation cycle 2/25
After repacking: energy = -367.49, improvement = -32.25
After minimization: energy = -496.03, improvement = 96.29

Complex relaxation cycle 3/25
After repacking: energy = -416.14, improvement = 16.41
After minimization: energy = -505.43, improvement = 105.70

Complex relaxation cycle 4/25
After repacking: energy = -445.82, improvement = 46.09
After minimization: energy = -511.60, improvement = 111.87

Complex relaxation cycle 5/25
After repacking: energy = -441.44, improvement = 41.71
After minimization: energy = -511.13, improvement = 111.39

Complex relaxation cycle 6/25
After repacking: energy = -401.70, improvement = 1.97
After minimization: energy = -471.29, improvement = 71.55
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -442.83, improvement = 43.09
After minimization: energy = -510.67, improvement = 110.93

Complex relaxation cycle 8/25
After repacking: energy = -400.61, improvement = 0.88
After minimization: energy = -471.15, improvement = 71.41

Complex relaxation cycle 9/25
After repacking: energy = -439.29, improvement = 39.56
After minimization: energy = -510.54, improvement = 110.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -440.32, improvement = 40.58
After minimization: energy = -510.72, improvement = 110.99

Complex relaxation cycle 11/25
After repacking: energy = -400.54, improvement = 0.80
After minimization: energy = -470.95, improvement = 71.22

Complex relaxation cycle 12/25
After repacking: energy = -438.80, improvement = 39.06
After minimization: energy = -510.67, improvement = 110.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -439.46, improvement = 39.73
After minimization: energy = -510.67, improvement = 110.94

Complex relaxation cycle 14/25
After repacking: energy = -440.00, improvement = 40.27
After minimization: energy = -510.81, improvement = 111.07

Complex relaxation cycle 15/25
After repacking: energy = -438.44, improvement = 38.71
After minimization: energy = -510.81, improvement = 111.08
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -438.98, improvement = 39.24
After minimization: energy = -510.74, improvement = 111.01

Complex relaxation cycle 17/25
After repacking: energy = -399.76, improvement = 0.03
After minimization: energy = -471.10, improvement = 71.37

Complex relaxation cycle 18/25
After repacking: energy = -439.03, improvement = 39.29
After minimization: energy = -510.76, improvement = 111.03
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -439.16, improvement = 39.42
After minimization: energy = -510.79, improvement = 111.06

Complex relaxation cycle 20/25
After repacking: energy = -439.04, improvement = 39.31
After minimization: energy = -510.70, improvement = 110.97

Complex relaxation cycle 21/25
After repacking: energy = -439.57, improvement = 39.83
After minimization: energy = -510.75, improvement = 111.02
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -439.62, improvement = 39.88
After minimization: energy = -510.68, improvement = 110.94

Complex relaxation cycle 23/25
After repacking: energy = -439.54, improvement = 39.80
After minimization: energy = -510.73, improvement = 111.00

Complex relaxation cycle 24/25
After repacking: energy = -439.45, improvement = 39.72
After minimization: energy = -510.76, improvement = 111.02
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -439.39, improvement = 39.66
After minimization: energy = -510.63, improvement = 110.89

=== Complex Relaxation Summary ===
Initial energy: -399.74
Final energy: -578.68
Total energy improvement: 178.94 (44.8%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.27 Å
Interface energy: -51.23
Saved relaxed complex structure to docking_results/4_peptide_20mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -578.68
Checking contacts between peptide and CDR-L3...
Found 39 contacts with CDR-L3 (354.5% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -51.23

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab0_CDR-L1_combined.pdb
Initial score: 15151.19
  Found better pose: 14230.39
  Found better pose: 14140.67
  Found better pose: 12570.75
  Found better pose: 11952.41
  Found better pose: 11706.55
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 11706.55
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 5482.78, improvement = 6223.77
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 8356.43, improvement = 3350.12
After minimization: energy = 6890.20, improvement = 4816.35

Complex relaxation cycle 2/25
After repacking: energy = 7233.56, improvement = 4472.99
After minimization: energy = 6630.50, improvement = 5076.05

Complex relaxation cycle 3/25
After repacking: energy = 6598.33, improvement = 5108.22
After minimization: energy = 6525.66, improvement = 5180.89

Complex relaxation cycle 4/25
After repacking: energy = 6627.56, improvement = 5078.98
After minimization: energy = 6524.64, improvement = 5181.91

Complex relaxation cycle 5/25
After repacking: energy = 6572.39, improvement = 5134.16
After minimization: energy = 6526.56, improvement = 5179.99

Complex relaxation cycle 6/25
After repacking: energy = 6549.45, improvement = 5157.09
After minimization: energy = 6521.42, improvement = 5185.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 6561.81, improvement = 5144.74
After minimization: energy = 6530.85, improvement = 5175.70

Complex relaxation cycle 8/25
After repacking: energy = 6542.65, improvement = 5163.90
After minimization: energy = 6516.24, improvement = 5190.31

Complex relaxation cycle 9/25
After repacking: energy = 6566.45, improvement = 5140.10
After minimization: energy = 6519.59, improvement = 5186.96
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 6551.50, improvement = 5155.05
After minimization: energy = 6518.89, improvement = 5187.66

Complex relaxation cycle 11/25
After repacking: energy = 6557.66, improvement = 5148.89
After minimization: energy = 6519.33, improvement = 5187.22

Complex relaxation cycle 12/25
After repacking: energy = 6555.61, improvement = 5150.94
After minimization: energy = 6518.70, improvement = 5187.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 6556.72, improvement = 5149.83
After minimization: energy = 6520.52, improvement = 5186.03

Complex relaxation cycle 14/25
After repacking: energy = 6553.41, improvement = 5153.14
After minimization: energy = 6518.56, improvement = 5187.99

Complex relaxation cycle 15/25
After repacking: energy = 6556.77, improvement = 5149.78
After minimization: energy = 6518.79, improvement = 5187.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 6555.51, improvement = 5151.04
After minimization: energy = 6520.31, improvement = 5186.24

Complex relaxation cycle 17/25
After repacking: energy = 6553.91, improvement = 5152.64
After minimization: energy = 6517.81, improvement = 5188.74

Complex relaxation cycle 18/25
After repacking: energy = 6560.48, improvement = 5146.07
After minimization: energy = 6518.42, improvement = 5188.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 6559.76, improvement = 5146.79
After minimization: energy = 6516.95, improvement = 5189.60

Complex relaxation cycle 20/25
After repacking: energy = 6558.95, improvement = 5147.59
After minimization: energy = 6519.79, improvement = 5186.76

Complex relaxation cycle 21/25
After repacking: energy = 6550.06, improvement = 5156.49
After minimization: energy = 6521.95, improvement = 5184.60
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 6548.54, improvement = 5158.01
After minimization: energy = 6520.71, improvement = 5185.84

Complex relaxation cycle 23/25
After repacking: energy = 6552.07, improvement = 5154.48
After minimization: energy = 6523.41, improvement = 5183.13

Complex relaxation cycle 24/25
After repacking: energy = 6544.20, improvement = 5162.35
After minimization: energy = 6519.86, improvement = 5186.69
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 6551.81, improvement = 5154.74
After minimization: energy = 6518.34, improvement = 5188.21

=== Complex Relaxation Summary ===
Initial energy: 11706.55
Final energy: 5482.78
Total energy improvement: 6223.77 (53.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.93 Å
Interface energy: 5953.71
Saved relaxed complex structure to docking_results/4_peptide_20mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: 5482.78
Checking contacts between peptide and CDR-L1...
Found 58 contacts with CDR-L1 (362.5% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 5953.71

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab0_CDR-L2_combined.pdb
Initial score: 5864.30
  Found better pose: 4381.86
  Found better pose: 2731.64
  Found better pose: 2597.75
  Found better pose: 1537.79
  Found better pose: 862.89
  Found better pose: -204.25
  Found better pose: -390.29
  Found better pose: -402.17
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -402.17
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -580.86, improvement = 178.69
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -299.39, improvement = -102.78
After minimization: energy = -470.98, improvement = 68.81

Complex relaxation cycle 2/25
After repacking: energy = -389.94, improvement = -12.23
After minimization: energy = -499.77, improvement = 97.60

Complex relaxation cycle 3/25
After repacking: energy = -383.56, improvement = -18.61
After minimization: energy = -479.32, improvement = 77.15

Complex relaxation cycle 4/25
After repacking: energy = -384.53, improvement = -17.64
After minimization: energy = -504.38, improvement = 102.21

Complex relaxation cycle 5/25
After repacking: energy = -411.95, improvement = 9.78
After minimization: energy = -468.34, improvement = 66.17

Complex relaxation cycle 6/25
After repacking: energy = -443.69, improvement = 41.52
After minimization: energy = -510.65, improvement = 108.48
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -451.48, improvement = 49.31
After minimization: energy = -510.48, improvement = 108.31

Complex relaxation cycle 8/25
After repacking: energy = -437.98, improvement = 35.81
After minimization: energy = -509.08, improvement = 106.91

Complex relaxation cycle 9/25
After repacking: energy = -451.03, improvement = 48.86
After minimization: energy = -509.20, improvement = 107.03
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -451.32, improvement = 49.15
After minimization: energy = -510.14, improvement = 107.97

Complex relaxation cycle 11/25
After repacking: energy = -452.71, improvement = 50.54
After minimization: energy = -510.15, improvement = 107.98

Complex relaxation cycle 12/25
After repacking: energy = -413.17, improvement = 11.00
After minimization: energy = -470.41, improvement = 68.24
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -453.09, improvement = 50.92
After minimization: energy = -510.15, improvement = 107.98

Complex relaxation cycle 14/25
After repacking: energy = -452.98, improvement = 50.81
After minimization: energy = -510.17, improvement = 108.00

Complex relaxation cycle 15/25
After repacking: energy = -413.24, improvement = 11.07
After minimization: energy = -473.11, improvement = 70.94
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -452.55, improvement = 50.38
After minimization: energy = -510.21, improvement = 108.04

Complex relaxation cycle 17/25
After repacking: energy = -453.19, improvement = 51.02
After minimization: energy = -512.68, improvement = 110.51

Complex relaxation cycle 18/25
After repacking: energy = -452.05, improvement = 49.88
After minimization: energy = -510.19, improvement = 108.02
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -413.34, improvement = 11.17
After minimization: energy = -473.12, improvement = 70.95

Complex relaxation cycle 20/25
After repacking: energy = -452.36, improvement = 50.19
After minimization: energy = -510.08, improvement = 107.91

Complex relaxation cycle 21/25
After repacking: energy = -453.19, improvement = 51.02
After minimization: energy = -512.68, improvement = 110.51
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -452.28, improvement = 50.11
After minimization: energy = -503.80, improvement = 101.63

Complex relaxation cycle 23/25
After repacking: energy = -466.62, improvement = 64.45
After minimization: energy = -510.18, improvement = 108.01

Complex relaxation cycle 24/25
After repacking: energy = -454.17, improvement = 52.00
After minimization: energy = -512.78, improvement = 110.61
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -452.69, improvement = 50.52
After minimization: energy = -510.21, improvement = 108.04

=== Complex Relaxation Summary ===
Initial energy: -402.17
Final energy: -580.86
Total energy improvement: 178.69 (44.4%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.25 Å
Interface energy: -55.98
Saved relaxed complex structure to docking_results/4_peptide_20mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -580.86
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -55.98

Best binding found with CDR-L2, score: -580.86
Docking complete. Results: {'binding_cdr': 'CDR-L2', 'initial_score': -402.17030718477287, 'relaxed_score': -580.8623027220914, 'interface_energy': -55.98379982792187, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 6, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/4_peptide_20mer_Ab0_CDR-L2_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/4_peptide_20mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 4_peptide_20mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/4_peptide_20mer_Ab1...
Peptide sequence: ARGTHRGLYLYSASPTYRTYRTYRLEUPHEILETYRALAGLYSERGLUGLYPHEASNCYS
Antibody has 240 residues
Peptide has 20 residues
Saving antibody to docking_results/4_peptide_20mer_Ab1_antibody.pdb
Saving peptide to docking_results/4_peptide_20mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab1_CDR-H3_combined.pdb
Initial score: 16248.81
  Found better pose: 16237.60
  Found better pose: 15818.58
  Found better pose: 15072.22
  Found better pose: 12713.61
  Found better pose: 10552.85
  Found better pose: 7606.40
  Found better pose: 5267.39
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab1_CDR-H2_combined.pdb
Initial score: -87.49
  Found better pose: -213.64
  Found better pose: -218.98
  Found better pose: -219.46
  Found better pose: -219.87
  Found better pose: -220.05
  Found better pose: -221.06
  Found better pose: -221.09
  Found better pose: -221.27
  Found better pose: -221.46
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab1_CDR-H1_combined.pdb
Initial score: 22662.48
  Found better pose: 18880.61
  Found better pose: 16978.17
  Found better pose: 15943.58
  Found better pose: 15632.08
  Found better pose: 13083.60
  Found better pose: 12593.39
  Found better pose: 9624.90
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab1_CDR-L3_combined.pdb
Initial score: 1697.14
  Found better pose: 898.24
  Found better pose: 515.99
  Found better pose: 313.11
  Found better pose: 261.24
  Found better pose: 27.89
  Found better pose: -164.40
  Found better pose: -166.94
  Found better pose: -224.10
  Found better pose: -224.17
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -224.17
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -383.01, improvement = 158.84
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 320.79, improvement = -544.96
After minimization: energy = -186.30, improvement = -37.87

Complex relaxation cycle 2/25
After repacking: energy = -202.59, improvement = -21.58
After minimization: energy = -264.54, improvement = 40.37

Complex relaxation cycle 3/25
After repacking: energy = -206.53, improvement = -17.64
After minimization: energy = -257.03, improvement = 32.86

Complex relaxation cycle 4/25
After repacking: energy = -210.85, improvement = -13.32
After minimization: energy = -257.02, improvement = 32.85

Complex relaxation cycle 5/25
After repacking: energy = -210.68, improvement = -13.49
After minimization: energy = -256.56, improvement = 32.39

Complex relaxation cycle 6/25
After repacking: energy = -223.41, improvement = -0.76
After minimization: energy = -269.27, improvement = 45.10
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -211.63, improvement = -12.54
After minimization: energy = -257.27, improvement = 33.10

Complex relaxation cycle 8/25
After repacking: energy = -223.46, improvement = -0.72
After minimization: energy = -269.27, improvement = 45.10

Complex relaxation cycle 9/25
After repacking: energy = -223.56, improvement = -0.61
After minimization: energy = -269.18, improvement = 45.01
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -211.07, improvement = -13.11
After minimization: energy = -257.28, improvement = 33.11

Complex relaxation cycle 11/25
After repacking: energy = -211.57, improvement = -12.60
After minimization: energy = -257.28, improvement = 33.11

Complex relaxation cycle 12/25
After repacking: energy = -211.60, improvement = -12.57
After minimization: energy = -257.27, improvement = 33.10
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -217.54, improvement = -6.63
After minimization: energy = -263.29, improvement = 39.12

Complex relaxation cycle 14/25
After repacking: energy = -223.55, improvement = -0.62
After minimization: energy = -269.23, improvement = 45.06

Complex relaxation cycle 15/25
After repacking: energy = -211.91, improvement = -12.26
After minimization: energy = -257.27, improvement = 33.10
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -211.58, improvement = -12.59
After minimization: energy = -257.20, improvement = 33.03

Complex relaxation cycle 17/25
After repacking: energy = -211.37, improvement = -12.80
After minimization: energy = -257.27, improvement = 33.10

Complex relaxation cycle 18/25
After repacking: energy = -223.58, improvement = -0.59
After minimization: energy = -268.89, improvement = 44.72
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -223.79, improvement = -0.38
After minimization: energy = -269.27, improvement = 45.10

Complex relaxation cycle 20/25
After repacking: energy = -223.28, improvement = -0.89
After minimization: energy = -269.21, improvement = 45.04

Complex relaxation cycle 21/25
After repacking: energy = -223.59, improvement = -0.58
After minimization: energy = -269.29, improvement = 45.12
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -222.63, improvement = -1.54
After minimization: energy = -268.57, improvement = 44.40

Complex relaxation cycle 23/25
After repacking: energy = -211.57, improvement = -12.61
After minimization: energy = -257.27, improvement = 33.10

Complex relaxation cycle 24/25
After repacking: energy = -211.56, improvement = -12.61
After minimization: energy = -257.27, improvement = 33.10
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -217.48, improvement = -6.69
After minimization: energy = -262.80, improvement = 38.63

=== Complex Relaxation Summary ===
Initial energy: -224.17
Final energy: -383.01
Total energy improvement: 158.84 (70.9%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.45 Å
Interface energy: -51.30
Saved relaxed complex structure to docking_results/4_peptide_20mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -383.01
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -51.30

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab1_CDR-L1_combined.pdb
Initial score: 11968.34
  Found better pose: 11581.91
  Found better pose: 11361.94
  Found better pose: 11330.07
  Found better pose: 11042.05
  Found better pose: 10607.53
  Found better pose: 10404.69
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 10404.69
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 5680.89, improvement = 4723.80
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 8183.55, improvement = 2221.15
After minimization: energy = 7713.65, improvement = 2691.04

Complex relaxation cycle 2/25
After repacking: energy = 7724.19, improvement = 2680.50
After minimization: energy = 7652.19, improvement = 2752.50

Complex relaxation cycle 3/25
After repacking: energy = 7705.11, improvement = 2699.58
After minimization: energy = 7663.33, improvement = 2741.36

Complex relaxation cycle 4/25
After repacking: energy = 7678.23, improvement = 2726.47
After minimization: energy = 7649.13, improvement = 2755.57

Complex relaxation cycle 5/25
After repacking: energy = 7704.78, improvement = 2699.91
After minimization: energy = 7669.65, improvement = 2735.05

Complex relaxation cycle 6/25
After repacking: energy = 7676.53, improvement = 2728.16
After minimization: energy = 7638.96, improvement = 2765.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 7677.80, improvement = 2726.90
After minimization: energy = 7586.81, improvement = 2817.89

Complex relaxation cycle 8/25
After repacking: energy = 7643.23, improvement = 2761.46
After minimization: energy = 7602.83, improvement = 2801.86

Complex relaxation cycle 9/25
After repacking: energy = 7628.21, improvement = 2776.48
After minimization: energy = 7601.77, improvement = 2802.93
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 7627.59, improvement = 2777.10
After minimization: energy = 7595.77, improvement = 2808.93

Complex relaxation cycle 11/25
After repacking: energy = 7616.21, improvement = 2788.48
After minimization: energy = 7580.11, improvement = 2824.58

Complex relaxation cycle 12/25
After repacking: energy = 7622.55, improvement = 2782.15
After minimization: energy = 7587.33, improvement = 2817.37
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 7611.44, improvement = 2793.25
After minimization: energy = 7587.06, improvement = 2817.63

Complex relaxation cycle 14/25
After repacking: energy = 7622.02, improvement = 2782.67
After minimization: energy = 7598.30, improvement = 2806.40

Complex relaxation cycle 15/25
After repacking: energy = 7622.11, improvement = 2782.59
After minimization: energy = 7597.28, improvement = 2807.41
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 7608.28, improvement = 2796.41
After minimization: energy = 7582.20, improvement = 2822.50

Complex relaxation cycle 17/25
After repacking: energy = 7625.41, improvement = 2779.28
After minimization: energy = 7594.48, improvement = 2810.21

Complex relaxation cycle 18/25
After repacking: energy = 7632.51, improvement = 2772.18
After minimization: energy = 7599.38, improvement = 2805.32
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 7628.55, improvement = 2776.14
After minimization: energy = 7595.73, improvement = 2808.97

Complex relaxation cycle 20/25
After repacking: energy = 7607.86, improvement = 2796.83
After minimization: energy = 7580.08, improvement = 2824.61

Complex relaxation cycle 21/25
After repacking: energy = 7617.15, improvement = 2787.54
After minimization: energy = 7586.02, improvement = 2818.67
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 7618.89, improvement = 2785.81
After minimization: energy = 7597.40, improvement = 2807.30

Complex relaxation cycle 23/25
After repacking: energy = 7617.41, improvement = 2787.29
After minimization: energy = 7597.67, improvement = 2807.02

Complex relaxation cycle 24/25
After repacking: energy = 7606.65, improvement = 2798.05
After minimization: energy = 7585.06, improvement = 2819.63
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 7607.16, improvement = 2797.53
After minimization: energy = 7585.67, improvement = 2819.02

=== Complex Relaxation Summary ===
Initial energy: 10404.69
Final energy: 5680.89
Total energy improvement: 4723.80 (45.4%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.63 Å
Interface energy: 5809.47
Saved relaxed complex structure to docking_results/4_peptide_20mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: 5680.89
Checking contacts between peptide and CDR-L1...
Found 62 contacts with CDR-L1 (387.5% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 5809.47

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-46.78, 51.68, -14.39)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/4_peptide_20mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/4_peptide_20mer_Ab1_CDR-L2_combined.pdb
Initial score: 18696.23
  Found better pose: 17405.61
  Found better pose: 17024.64
  Found better pose: 16496.41
  Found better pose: 16159.28
  Found better pose: 14879.57
  Found better pose: 13430.56
  Found better pose: 12577.69
  Found better pose: 11422.88
  Found better pose: 9224.25
  Found better pose: 9138.87
  Found better pose: 7189.30
  Found better pose: 5041.56
  Found better pose: 4964.77
  Found better pose: 2950.97
  Found better pose: 1750.99
  Found better pose: 1670.62
  Found better pose: 1214.60
  Found better pose: 1137.99
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 1137.99
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -212.72, improvement = 1350.71
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 1630.93, improvement = -492.94
After minimization: energy = -7.53, improvement = 1145.52

Complex relaxation cycle 2/25
After repacking: energy = -34.03, improvement = 1172.02
After minimization: energy = -106.57, improvement = 1244.55

Complex relaxation cycle 3/25
After repacking: energy = -69.41, improvement = 1207.40
After minimization: energy = -123.48, improvement = 1261.47

Complex relaxation cycle 4/25
After repacking: energy = -68.82, improvement = 1206.80
After minimization: energy = -119.77, improvement = 1257.76

Complex relaxation cycle 5/25
After repacking: energy = -64.11, improvement = 1202.10
After minimization: energy = -113.76, improvement = 1251.75

Complex relaxation cycle 6/25
After repacking: energy = -63.47, improvement = 1201.46
After minimization: energy = -112.48, improvement = 1250.47
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -77.21, improvement = 1215.20
After minimization: energy = -125.78, improvement = 1263.77

Complex relaxation cycle 8/25
After repacking: energy = -64.64, improvement = 1202.63
After minimization: energy = -113.77, improvement = 1251.76

Complex relaxation cycle 9/25
After repacking: energy = -76.01, improvement = 1214.00
After minimization: energy = -125.68, improvement = 1263.67
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -75.56, improvement = 1213.55
After minimization: energy = -125.74, improvement = 1263.73

Complex relaxation cycle 11/25
After repacking: energy = -74.25, improvement = 1212.24
After minimization: energy = -126.82, improvement = 1264.80

Complex relaxation cycle 12/25
After repacking: energy = -50.23, improvement = 1188.22
After minimization: energy = -100.30, improvement = 1238.29
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -66.65, improvement = 1204.64
After minimization: energy = -115.01, improvement = 1253.00

Complex relaxation cycle 14/25
After repacking: energy = -71.43, improvement = 1209.42
After minimization: energy = -128.23, improvement = 1266.22

Complex relaxation cycle 15/25
After repacking: energy = -81.15, improvement = 1219.14
After minimization: energy = -131.70, improvement = 1269.68
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -77.04, improvement = 1215.03
After minimization: energy = -126.70, improvement = 1264.69

Complex relaxation cycle 17/25
After repacking: energy = -68.59, improvement = 1206.58
After minimization: energy = -116.74, improvement = 1254.73

Complex relaxation cycle 18/25
After repacking: energy = -73.89, improvement = 1211.88
After minimization: energy = -128.14, improvement = 1266.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -42.78, improvement = 1180.77
After minimization: energy = -91.24, improvement = 1229.22

Complex relaxation cycle 20/25
After repacking: energy = -74.64, improvement = 1212.63
After minimization: energy = -130.82, improvement = 1268.81

Complex relaxation cycle 21/25
After repacking: energy = -55.27, improvement = 1193.26
After minimization: energy = -103.38, improvement = 1241.37
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -63.76, improvement = 1201.75
After minimization: energy = -118.81, improvement = 1256.79

Complex relaxation cycle 23/25
After repacking: energy = -69.75, improvement = 1207.73
After minimization: energy = -118.09, improvement = 1256.08

Complex relaxation cycle 24/25
After repacking: energy = -74.93, improvement = 1212.92
After minimization: energy = -130.81, improvement = 1268.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -81.92, improvement = 1219.91
After minimization: energy = -130.11, improvement = 1268.10

=== Complex Relaxation Summary ===
Initial energy: 1137.99
Final energy: -212.72
Total energy improvement: 1350.71 (118.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.80 Å
Interface energy: 103.94
Saved relaxed complex structure to docking_results/4_peptide_20mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -212.72
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 103.94

Best binding found with CDR-L3, score: -383.01
Docking complete. Results: {'binding_cdr': 'CDR-L3', 'initial_score': -224.17111134634484, 'relaxed_score': -383.0130168357283, 'interface_energy': -51.3032429647734, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 8, 'salt_bridges': 0, 'hydrophobic': 5, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/4_peptide_20mer_Ab1_CDR-L3_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/4_peptide_20mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.0), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 3_peptide_12mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/3_peptide_12mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 3_peptide_12mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/3_peptide_12mer_Ab0...
Peptide sequence: GLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLN
Antibody has 232 residues
Peptide has 12 residues
Saving antibody to docking_results/3_peptide_12mer_Ab0_antibody.pdb
Saving peptide to docking_results/3_peptide_12mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab0_CDR-H3_combined.pdb
Initial score: 1891.39
  Found better pose: 560.30
  Found better pose: 130.66
  Found better pose: -45.53
  Found better pose: -60.21
  Found better pose: -247.96
  Found better pose: -319.72
  Found better pose: -347.19
  Found better pose: -396.03
  Found better pose: -402.95
  Found better pose: -403.61
  Found better pose: -403.73
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab0_CDR-H2_combined.pdb
Initial score: 7032.84
  Found better pose: 6577.98
  Found better pose: 6575.06
  Found better pose: 6527.32
  Found better pose: 6215.02
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab0_CDR-H1_combined.pdb
Initial score: 27341.39
  Found better pose: 25432.12
  Found better pose: 24436.38
  Found better pose: 23893.26
  Found better pose: 23571.17
  Found better pose: 23516.26
  Found better pose: 22406.26
  Found better pose: 22240.73
  Found better pose: 21690.48
  Found better pose: 21588.07
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab0_CDR-L3_combined.pdb
Initial score: -403.33
  Found better pose: -403.76
  Found better pose: -403.79
  Found better pose: -403.99
  Found better pose: -404.05
  Found better pose: -404.17
  Found better pose: -404.18
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -404.18
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -590.04, improvement = 185.86
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -343.32, improvement = -60.86
After minimization: energy = -516.00, improvement = 111.82

Complex relaxation cycle 2/25
After repacking: energy = -375.34, improvement = -28.84
After minimization: energy = -502.95, improvement = 98.77

Complex relaxation cycle 3/25
After repacking: energy = -446.47, improvement = 42.29
After minimization: energy = -508.84, improvement = 104.66

Complex relaxation cycle 4/25
After repacking: energy = -448.52, improvement = 44.34
After minimization: energy = -511.61, improvement = 107.43

Complex relaxation cycle 5/25
After repacking: energy = -450.42, improvement = 46.23
After minimization: energy = -515.60, improvement = 111.41

Complex relaxation cycle 6/25
After repacking: energy = -445.22, improvement = 41.04
After minimization: energy = -515.45, improvement = 111.27
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -447.99, improvement = 43.81
After minimization: energy = -515.29, improvement = 111.11

Complex relaxation cycle 8/25
After repacking: energy = -445.06, improvement = 40.88
After minimization: energy = -515.27, improvement = 111.09

Complex relaxation cycle 9/25
After repacking: energy = -444.70, improvement = 40.52
After minimization: energy = -515.19, improvement = 111.01
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -443.81, improvement = 39.63
After minimization: energy = -514.65, improvement = 110.47

Complex relaxation cycle 11/25
After repacking: energy = -443.28, improvement = 39.10
After minimization: energy = -515.10, improvement = 110.92

Complex relaxation cycle 12/25
After repacking: energy = -444.10, improvement = 39.92
After minimization: energy = -514.78, improvement = 110.60
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -442.94, improvement = 38.76
After minimization: energy = -515.60, improvement = 111.42

Complex relaxation cycle 14/25
After repacking: energy = -444.19, improvement = 40.01
After minimization: energy = -515.55, improvement = 111.37

Complex relaxation cycle 15/25
After repacking: energy = -427.16, improvement = 22.98
After minimization: energy = -514.60, improvement = 110.41
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -446.24, improvement = 42.06
After minimization: energy = -516.55, improvement = 112.37

Complex relaxation cycle 17/25
After repacking: energy = -446.48, improvement = 42.29
After minimization: energy = -516.66, improvement = 112.48

Complex relaxation cycle 18/25
After repacking: energy = -445.29, improvement = 41.11
After minimization: energy = -516.72, improvement = 112.53
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -445.15, improvement = 40.97
After minimization: energy = -517.89, improvement = 113.71

Complex relaxation cycle 20/25
After repacking: energy = -448.77, improvement = 44.59
After minimization: energy = -515.05, improvement = 110.87

Complex relaxation cycle 21/25
After repacking: energy = -444.80, improvement = 40.62
After minimization: energy = -515.16, improvement = 110.98
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -445.50, improvement = 41.32
After minimization: energy = -515.11, improvement = 110.93

Complex relaxation cycle 23/25
After repacking: energy = -444.48, improvement = 40.30
After minimization: energy = -515.06, improvement = 110.88

Complex relaxation cycle 24/25
After repacking: energy = -445.63, improvement = 41.44
After minimization: energy = -515.10, improvement = 110.92
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -404.49, improvement = 0.31
After minimization: energy = -474.75, improvement = 70.57

=== Complex Relaxation Summary ===
Initial energy: -404.18
Final energy: -590.04
Total energy improvement: 185.86 (46.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.25 Å
Interface energy: -55.29
Saved relaxed complex structure to docking_results/3_peptide_12mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -590.04
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -55.29

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab0_CDR-L1_combined.pdb
Initial score: 3576.20
  Found better pose: 2476.86
  Found better pose: 2230.60
  Found better pose: 2142.44
  Found better pose: 1944.55
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 1944.55
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -42.62, improvement = 1987.17
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 1077.65, improvement = 866.90
After minimization: energy = 185.99, improvement = 1758.57

Complex relaxation cycle 2/25
After repacking: energy = 398.51, improvement = 1546.04
After minimization: energy = 187.53, improvement = 1757.02

Complex relaxation cycle 3/25
After repacking: energy = 284.10, improvement = 1660.46
After minimization: energy = 182.32, improvement = 1762.23

Complex relaxation cycle 4/25
After repacking: energy = 296.17, improvement = 1648.38
After minimization: energy = 182.39, improvement = 1762.16

Complex relaxation cycle 5/25
After repacking: energy = 276.05, improvement = 1668.50
After minimization: energy = 183.02, improvement = 1761.53

Complex relaxation cycle 6/25
After repacking: energy = 278.28, improvement = 1666.27
After minimization: energy = 181.59, improvement = 1762.97
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 275.95, improvement = 1668.60
After minimization: energy = 181.31, improvement = 1763.24

Complex relaxation cycle 8/25
After repacking: energy = 316.98, improvement = 1627.57
After minimization: energy = 216.33, improvement = 1728.22

Complex relaxation cycle 9/25
After repacking: energy = 272.20, improvement = 1672.35
After minimization: energy = 174.93, improvement = 1769.62
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 276.35, improvement = 1668.20
After minimization: energy = 175.33, improvement = 1769.22

Complex relaxation cycle 11/25
After repacking: energy = 311.37, improvement = 1633.19
After minimization: energy = 215.52, improvement = 1729.04

Complex relaxation cycle 12/25
After repacking: energy = 269.75, improvement = 1674.80
After minimization: energy = 175.65, improvement = 1768.90
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 270.15, improvement = 1674.40
After minimization: energy = 174.95, improvement = 1769.60

Complex relaxation cycle 14/25
After repacking: energy = 270.31, improvement = 1674.24
After minimization: energy = 174.98, improvement = 1769.58

Complex relaxation cycle 15/25
After repacking: energy = 271.05, improvement = 1673.50
After minimization: energy = 175.58, improvement = 1768.97
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 271.67, improvement = 1672.88
After minimization: energy = 175.64, improvement = 1768.91

Complex relaxation cycle 17/25
After repacking: energy = 271.33, improvement = 1673.22
After minimization: energy = 176.71, improvement = 1767.84

Complex relaxation cycle 18/25
After repacking: energy = 270.88, improvement = 1673.67
After minimization: energy = 176.25, improvement = 1768.30
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 271.77, improvement = 1672.78
After minimization: energy = 175.49, improvement = 1769.06

Complex relaxation cycle 20/25
After repacking: energy = 271.08, improvement = 1673.47
After minimization: energy = 175.18, improvement = 1769.37

Complex relaxation cycle 21/25
After repacking: energy = 279.23, improvement = 1665.33
After minimization: energy = 176.25, improvement = 1768.30
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 270.49, improvement = 1674.06
After minimization: energy = 175.76, improvement = 1768.79

Complex relaxation cycle 23/25
After repacking: energy = 270.87, improvement = 1673.68
After minimization: energy = 175.66, improvement = 1768.89

Complex relaxation cycle 24/25
After repacking: energy = 271.15, improvement = 1673.40
After minimization: energy = 176.41, improvement = 1768.14
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 270.79, improvement = 1673.76
After minimization: energy = 175.65, improvement = 1768.90

=== Complex Relaxation Summary ===
Initial energy: 1944.55
Final energy: -42.62
Total energy improvement: 1987.17 (102.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.87 Å
Interface energy: 470.96
Saved relaxed complex structure to docking_results/3_peptide_12mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -42.62
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 470.96

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab0_CDR-L2_combined.pdb
Initial score: -398.83
  Found better pose: -403.10
  Found better pose: -403.73
  Found better pose: -404.10
  Found better pose: -404.14
  Found better pose: -404.18
  Found better pose: -404.45
  Found better pose: -404.46
  Found better pose: -404.74
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -404.74
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -590.20, improvement = 185.46
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -344.50, improvement = -60.24
After minimization: energy = -516.82, improvement = 112.08

Complex relaxation cycle 2/25
After repacking: energy = -367.43, improvement = -37.31
After minimization: energy = -503.44, improvement = 98.71

Complex relaxation cycle 3/25
After repacking: energy = -437.23, improvement = 32.49
After minimization: energy = -508.82, improvement = 104.08

Complex relaxation cycle 4/25
After repacking: energy = -468.03, improvement = 63.30
After minimization: energy = -516.02, improvement = 111.28

Complex relaxation cycle 5/25
After repacking: energy = -447.55, improvement = 42.81
After minimization: energy = -516.19, improvement = 111.46

Complex relaxation cycle 6/25
After repacking: energy = -447.60, improvement = 42.86
After minimization: energy = -512.66, improvement = 107.92
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -410.61, improvement = 5.88
After minimization: energy = -473.11, improvement = 68.37

Complex relaxation cycle 8/25
After repacking: energy = -443.88, improvement = 39.14
After minimization: energy = -513.07, improvement = 108.33

Complex relaxation cycle 9/25
After repacking: energy = -447.54, improvement = 42.81
After minimization: energy = -512.79, improvement = 108.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -445.71, improvement = 40.97
After minimization: energy = -512.41, improvement = 107.67

Complex relaxation cycle 11/25
After repacking: energy = -448.19, improvement = 43.45
After minimization: energy = -512.82, improvement = 108.08

Complex relaxation cycle 12/25
After repacking: energy = -444.73, improvement = 40.00
After minimization: energy = -512.38, improvement = 107.65
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -442.62, improvement = 37.88
After minimization: energy = -512.85, improvement = 108.12

Complex relaxation cycle 14/25
After repacking: energy = -403.35, improvement = -1.39
After minimization: energy = -472.66, improvement = 67.93

Complex relaxation cycle 15/25
After repacking: energy = -445.22, improvement = 40.49
After minimization: energy = -513.24, improvement = 108.51
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -404.66, improvement = -0.08
After minimization: energy = -473.52, improvement = 68.78

Complex relaxation cycle 17/25
After repacking: energy = -444.18, improvement = 39.44
After minimization: energy = -513.02, improvement = 108.29

Complex relaxation cycle 18/25
After repacking: energy = -431.05, improvement = 26.31
After minimization: energy = -512.98, improvement = 108.25
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -446.64, improvement = 41.90
After minimization: energy = -516.65, improvement = 111.91

Complex relaxation cycle 20/25
After repacking: energy = -441.09, improvement = 36.36
After minimization: energy = -512.03, improvement = 107.29

Complex relaxation cycle 21/25
After repacking: energy = -429.91, improvement = 25.18
After minimization: energy = -513.53, improvement = 108.80
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -441.53, improvement = 36.79
After minimization: energy = -516.50, improvement = 111.77

Complex relaxation cycle 23/25
After repacking: energy = -438.75, improvement = 34.01
After minimization: energy = -514.39, improvement = 109.66

Complex relaxation cycle 24/25
After repacking: energy = -385.31, improvement = -19.43
After minimization: energy = -473.19, improvement = 68.45
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -401.94, improvement = -2.80
After minimization: energy = -477.00, improvement = 72.26

=== Complex Relaxation Summary ===
Initial energy: -404.74
Final energy: -590.20
Total energy improvement: 185.46 (45.8%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.26 Å
Interface energy: -57.33
Saved relaxed complex structure to docking_results/3_peptide_12mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -590.20
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -57.33

Best binding found with CDR-L2, score: -590.20
Docking complete. Results: {'binding_cdr': 'CDR-L2', 'initial_score': -404.7370100854784, 'relaxed_score': -590.1954761006537, 'interface_energy': -57.32735980421762, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 6, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/3_peptide_12mer_Ab0_CDR-L2_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/3_peptide_12mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.3338617943906437), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 3_peptide_12mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/3_peptide_12mer_Ab1...
Peptide sequence: GLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLN
Antibody has 240 residues
Peptide has 12 residues
Saving antibody to docking_results/3_peptide_12mer_Ab1_antibody.pdb
Saving peptide to docking_results/3_peptide_12mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab1_CDR-H3_combined.pdb
Initial score: 6782.51
  Found better pose: 6507.06
  Found better pose: 5449.29
  Found better pose: 4673.41
  Found better pose: 4541.71
  Found better pose: 3986.50
  Found better pose: 3414.23
  Found better pose: 2319.49
  Found better pose: 2097.46
  Found better pose: 1455.16
  Found better pose: 661.81
  Found better pose: 190.95
  Found better pose: 101.68
  Found better pose: -134.29
  Found better pose: -206.09
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab1_CDR-H2_combined.pdb
Initial score: 11588.56
  Found better pose: 10913.78
  Found better pose: 10134.36
  Found better pose: 10060.14
  Found better pose: 9779.50
  Found better pose: 9547.88
  Found better pose: 9101.60
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab1_CDR-H1_combined.pdb
Initial score: 28634.30
  Found better pose: 27771.20
  Found better pose: 25349.46
  Found better pose: 22486.97
  Found better pose: 21905.27
  Found better pose: 19853.15
  Found better pose: 17595.12
  Found better pose: 17207.80
  Found better pose: 16522.66
  Found better pose: 16286.63
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab1_CDR-L3_combined.pdb
Initial score: -226.24
  Found better pose: -226.24
  Found better pose: -226.26
  Found better pose: -226.26
  Found better pose: -226.28
  Found better pose: -226.49
  Found better pose: -226.80
  Found better pose: -226.91
  Found better pose: -227.21
  Found better pose: -227.35
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -227.35
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -389.71, improvement = 162.36
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 331.45, improvement = -558.80
After minimization: energy = -174.57, improvement = -52.79

Complex relaxation cycle 2/25
After repacking: energy = -169.34, improvement = -58.01
After minimization: energy = -267.13, improvement = 39.78

Complex relaxation cycle 3/25
After repacking: energy = -166.25, improvement = -61.11
After minimization: energy = -266.91, improvement = 39.56

Complex relaxation cycle 4/25
After repacking: energy = -195.70, improvement = -31.65
After minimization: energy = -270.20, improvement = 42.85

Complex relaxation cycle 5/25
After repacking: energy = -200.23, improvement = -27.12
After minimization: energy = -269.89, improvement = 42.54

Complex relaxation cycle 6/25
After repacking: energy = -211.20, improvement = -16.15
After minimization: energy = -280.40, improvement = 53.05
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -195.45, improvement = -31.90
After minimization: energy = -267.69, improvement = 40.34

Complex relaxation cycle 8/25
After repacking: energy = -208.39, improvement = -18.96
After minimization: energy = -282.23, improvement = 54.88

Complex relaxation cycle 9/25
After repacking: energy = -215.47, improvement = -11.88
After minimization: energy = -286.44, improvement = 59.09
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -223.62, improvement = -3.73
After minimization: energy = -288.01, improvement = 60.66

Complex relaxation cycle 11/25
After repacking: energy = -219.40, improvement = -7.95
After minimization: energy = -280.68, improvement = 53.33

Complex relaxation cycle 12/25
After repacking: energy = -205.53, improvement = -21.82
After minimization: energy = -272.69, improvement = 45.34
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -219.86, improvement = -7.49
After minimization: energy = -284.12, improvement = 56.76

Complex relaxation cycle 14/25
After repacking: energy = -212.50, improvement = -14.86
After minimization: energy = -275.89, improvement = 48.54

Complex relaxation cycle 15/25
After repacking: energy = -211.06, improvement = -16.29
After minimization: energy = -275.18, improvement = 47.83
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -213.02, improvement = -14.33
After minimization: energy = -278.31, improvement = 50.96

Complex relaxation cycle 17/25
After repacking: energy = -207.91, improvement = -19.44
After minimization: energy = -275.46, improvement = 48.11

Complex relaxation cycle 18/25
After repacking: energy = -218.24, improvement = -9.11
After minimization: energy = -288.23, improvement = 60.88
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -180.86, improvement = -46.49
After minimization: energy = -251.62, improvement = 24.27

Complex relaxation cycle 20/25
After repacking: energy = -220.35, improvement = -7.01
After minimization: energy = -288.78, improvement = 61.43

Complex relaxation cycle 21/25
After repacking: energy = -208.21, improvement = -19.14
After minimization: energy = -277.60, improvement = 50.25
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -208.18, improvement = -19.17
After minimization: energy = -276.78, improvement = 49.43

Complex relaxation cycle 23/25
After repacking: energy = -208.98, improvement = -18.37
After minimization: energy = -276.61, improvement = 49.26

Complex relaxation cycle 24/25
After repacking: energy = -206.94, improvement = -20.41
After minimization: energy = -278.30, improvement = 50.95
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -208.44, improvement = -18.91
After minimization: energy = -276.77, improvement = 49.42

=== Complex Relaxation Summary ===
Initial energy: -227.35
Final energy: -389.71
Total energy improvement: 162.36 (71.4%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.48 Å
Interface energy: -55.87
Saved relaxed complex structure to docking_results/3_peptide_12mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -389.71
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -55.87

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab1_CDR-L1_combined.pdb
Initial score: 3509.48
  Found better pose: 3226.22
  Found better pose: 2896.66
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 2896.66
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 1159.11, improvement = 1737.56
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 4490.30, improvement = -1593.63
After minimization: energy = 1355.04, improvement = 1541.63

Complex relaxation cycle 2/25
After repacking: energy = 1315.45, improvement = 1581.22
After minimization: energy = 1261.44, improvement = 1635.22

Complex relaxation cycle 3/25
After repacking: energy = 1291.58, improvement = 1605.09
After minimization: energy = 1254.67, improvement = 1641.99

Complex relaxation cycle 4/25
After repacking: energy = 1299.11, improvement = 1597.55
After minimization: energy = 1266.00, improvement = 1630.66

Complex relaxation cycle 5/25
After repacking: energy = 1300.74, improvement = 1595.93
After minimization: energy = 1265.74, improvement = 1630.92

Complex relaxation cycle 6/25
After repacking: energy = 1288.13, improvement = 1608.53
After minimization: energy = 1253.77, improvement = 1642.90
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 1293.79, improvement = 1602.88
After minimization: energy = 1259.95, improvement = 1636.72

Complex relaxation cycle 8/25
After repacking: energy = 1286.59, improvement = 1610.07
After minimization: energy = 1255.28, improvement = 1641.39

Complex relaxation cycle 9/25
After repacking: energy = 1302.40, improvement = 1594.27
After minimization: energy = 1272.57, improvement = 1624.10
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 1325.51, improvement = 1571.16
After minimization: energy = 1296.89, improvement = 1599.77

Complex relaxation cycle 11/25
After repacking: energy = 1292.10, improvement = 1604.57
After minimization: energy = 1269.45, improvement = 1627.22

Complex relaxation cycle 12/25
After repacking: energy = 1280.87, improvement = 1615.80
After minimization: energy = 1256.83, improvement = 1639.83
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 1313.39, improvement = 1583.28
After minimization: energy = 1281.83, improvement = 1614.83

Complex relaxation cycle 14/25
After repacking: energy = 1298.41, improvement = 1598.25
After minimization: energy = 1266.79, improvement = 1629.88

Complex relaxation cycle 15/25
After repacking: energy = 1297.63, improvement = 1599.04
After minimization: energy = 1266.49, improvement = 1630.18
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 1286.61, improvement = 1610.06
After minimization: energy = 1254.76, improvement = 1641.90

Complex relaxation cycle 17/25
After repacking: energy = 1296.35, improvement = 1600.32
After minimization: energy = 1269.86, improvement = 1626.80

Complex relaxation cycle 18/25
After repacking: energy = 1280.90, improvement = 1615.76
After minimization: energy = 1254.83, improvement = 1641.83
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 1285.92, improvement = 1610.75
After minimization: energy = 1254.75, improvement = 1641.91

Complex relaxation cycle 20/25
After repacking: energy = 1291.28, improvement = 1605.38
After minimization: energy = 1260.52, improvement = 1636.14

Complex relaxation cycle 21/25
After repacking: energy = 1297.79, improvement = 1598.87
After minimization: energy = 1266.84, improvement = 1629.82
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 1285.10, improvement = 1611.56
After minimization: energy = 1256.97, improvement = 1639.69

Complex relaxation cycle 23/25
After repacking: energy = 1308.00, improvement = 1588.67
After minimization: energy = 1281.22, improvement = 1615.44

Complex relaxation cycle 24/25
After repacking: energy = 1284.46, improvement = 1612.21
After minimization: energy = 1257.20, improvement = 1639.46
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 1280.76, improvement = 1615.90
After minimization: energy = 1255.57, improvement = 1641.10

=== Complex Relaxation Summary ===
Initial energy: 2896.66
Final energy: 1159.11
Total energy improvement: 1737.56 (60.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.72 Å
Interface energy: 1446.40
Saved relaxed complex structure to docking_results/3_peptide_12mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: 1159.11
Checking contacts between peptide and CDR-L1...
Found 61 contacts with CDR-L1 (381.2% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: 1446.40

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-32.11, 42.18, 10.08)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/3_peptide_12mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/3_peptide_12mer_Ab1_CDR-L2_combined.pdb
Initial score: 5790.17
  Found better pose: 5595.98
  Found better pose: 5313.09
  Found better pose: 3187.45
  Found better pose: 2457.16
  Found better pose: 1270.03
  Found better pose: -33.07
  Found better pose: -186.09
  Found better pose: -216.02
  Found better pose: -223.51
  Found better pose: -227.12
  Found better pose: -229.22
  Found better pose: -229.79
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -229.79
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -391.27, improvement = 161.49
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 366.36, improvement = -596.15
After minimization: energy = -167.67, improvement = -62.12

Complex relaxation cycle 2/25
After repacking: energy = -204.22, improvement = -25.57
After minimization: energy = -269.28, improvement = 39.49

Complex relaxation cycle 3/25
After repacking: energy = -204.99, improvement = -24.79
After minimization: energy = -254.79, improvement = 25.01

Complex relaxation cycle 4/25
After repacking: energy = -227.86, improvement = -1.93
After minimization: energy = -272.46, improvement = 42.67

Complex relaxation cycle 5/25
After repacking: energy = -218.85, improvement = -10.94
After minimization: energy = -261.73, improvement = 31.94

Complex relaxation cycle 6/25
After repacking: energy = -205.11, improvement = -24.67
After minimization: energy = -246.27, improvement = 16.49
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -195.21, improvement = -34.58
After minimization: energy = -234.89, improvement = 5.10

Complex relaxation cycle 8/25
After repacking: energy = -220.01, improvement = -9.77
After minimization: energy = -261.59, improvement = 31.80

Complex relaxation cycle 9/25
After repacking: energy = -221.24, improvement = -8.54
After minimization: energy = -261.87, improvement = 32.09
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -231.63, improvement = 1.85
After minimization: energy = -272.94, improvement = 43.15

Complex relaxation cycle 11/25
After repacking: energy = -220.80, improvement = -8.99
After minimization: energy = -261.90, improvement = 32.11

Complex relaxation cycle 12/25
After repacking: energy = -220.43, improvement = -9.36
After minimization: energy = -261.44, improvement = 31.65
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -220.44, improvement = -9.35
After minimization: energy = -261.91, improvement = 32.13

Complex relaxation cycle 14/25
After repacking: energy = -200.10, improvement = -29.69
After minimization: energy = -241.28, improvement = 11.49

Complex relaxation cycle 15/25
After repacking: energy = -220.81, improvement = -8.97
After minimization: energy = -261.91, improvement = 32.13
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -220.84, improvement = -8.95
After minimization: energy = -261.87, improvement = 32.08

Complex relaxation cycle 17/25
After repacking: energy = -220.57, improvement = -9.21
After minimization: energy = -261.57, improvement = 31.78

Complex relaxation cycle 18/25
After repacking: energy = -206.07, improvement = -23.72
After minimization: energy = -247.18, improvement = 17.39
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -220.16, improvement = -9.63
After minimization: energy = -261.65, improvement = 31.86

Complex relaxation cycle 20/25
After repacking: energy = -220.68, improvement = -9.10
After minimization: energy = -261.88, improvement = 32.09

Complex relaxation cycle 21/25
After repacking: energy = -232.20, improvement = 2.42
After minimization: energy = -273.57, improvement = 43.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -232.31, improvement = 2.53
After minimization: energy = -273.57, improvement = 43.78

Complex relaxation cycle 23/25
After repacking: energy = -220.57, improvement = -9.22
After minimization: energy = -261.88, improvement = 32.09

Complex relaxation cycle 24/25
After repacking: energy = -232.14, improvement = 2.35
After minimization: energy = -273.68, improvement = 43.89
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -220.72, improvement = -9.07
After minimization: energy = -261.87, improvement = 32.08

=== Complex Relaxation Summary ===
Initial energy: -229.79
Final energy: -391.27
Total energy improvement: 161.49 (70.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.46 Å
Interface energy: -57.78
Saved relaxed complex structure to docking_results/3_peptide_12mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -391.27
Checking contacts between peptide and CDR-L2...
Found 28 contacts with CDR-L2 (350.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -57.78

Best binding found with CDR-L2, score: -391.27
Docking complete. Results: {'binding_cdr': 'CDR-L2', 'initial_score': -229.78680868189008, 'relaxed_score': -391.2737368644531, 'interface_energy': -57.78281506664865, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 6, 'salt_bridges': 0, 'hydrophobic': 15, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/3_peptide_12mer_Ab1_CDR-L2_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/3_peptide_12mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.3338617943906437), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

===== Processing peptide: 5_peptide_20mer =====
Peptide stability class: Very Low
Loading relaxed peptide structure for docking: stability_results/5_peptide_20mer_relaxed.pdb

----- Processing antibody Ab0 with peptide 5_peptide_20mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/5_peptide_20mer_Ab0...
Peptide sequence: PHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHR
Antibody has 232 residues
Peptide has 20 residues
Saving antibody to docking_results/5_peptide_20mer_Ab0_antibody.pdb
Saving peptide to docking_results/5_peptide_20mer_Ab0_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (11.02, 6.89, -8.35)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-H3_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (31.02, 6.89, -8.35)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-H3_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab0_CDR-H3_combined.pdb
Initial score: -404.78
  Found better pose: -404.83
  Found better pose: -405.05
  Found better pose: -405.33
  Found better pose: -405.82
  Found better pose: -406.49
  Found better pose: -406.81
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.72, 14.20, 1.89)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-H2_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (21.72, 14.20, 1.89)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-H2_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab0_CDR-H2_combined.pdb
Initial score: -345.00
  Found better pose: -406.33
  Found better pose: -406.57
  Found better pose: -407.14
  Found better pose: -407.41
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-12.04, 10.64, -5.27)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-H1_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (7.96, 10.64, -5.27)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-H1_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab0_CDR-H1_combined.pdb
Initial score: 20912.16
  Found better pose: 19764.63
  Found better pose: 17575.60
  Found better pose: 15577.10
  Found better pose: 14507.13
  Found better pose: 13867.94
  Found better pose: 13605.22
  Found better pose: 13486.05
  Found better pose: 13367.33
  Found better pose: 13328.64
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-4.14, -19.67, -0.50)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-L3_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (15.86, -19.67, -0.50)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-L3_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab0_CDR-L3_combined.pdb
Initial score: 4995.99
  Found better pose: 2742.22
  Found better pose: 1594.51
  Found better pose: 267.99
  Found better pose: -222.59
  Found better pose: -367.61
  Found better pose: -385.39
  Found better pose: -387.05
Checking contacts between peptide and CDR-L3...
Found 42 contacts with CDR-L3 (381.8% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -387.05
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -586.62, improvement = 199.57
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -339.98, improvement = -47.07
After minimization: energy = -513.50, improvement = 126.46

Complex relaxation cycle 2/25
After repacking: energy = -349.30, improvement = -37.75
After minimization: energy = -503.89, improvement = 116.85

Complex relaxation cycle 3/25
After repacking: energy = -426.72, improvement = 39.67
After minimization: energy = -506.77, improvement = 119.72

Complex relaxation cycle 4/25
After repacking: energy = -447.53, improvement = 60.48
After minimization: energy = -511.90, improvement = 124.86

Complex relaxation cycle 5/25
After repacking: energy = -450.15, improvement = 63.10
After minimization: energy = -509.13, improvement = 122.09

Complex relaxation cycle 6/25
After repacking: energy = -451.66, improvement = 64.62
After minimization: energy = -508.79, improvement = 121.75
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -449.18, improvement = 62.13
After minimization: energy = -508.89, improvement = 121.85

Complex relaxation cycle 8/25
After repacking: energy = -448.89, improvement = 61.85
After minimization: energy = -509.57, improvement = 122.53

Complex relaxation cycle 9/25
After repacking: energy = -448.26, improvement = 61.21
After minimization: energy = -509.42, improvement = 122.37
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -448.24, improvement = 61.19
After minimization: energy = -509.46, improvement = 122.42

Complex relaxation cycle 11/25
After repacking: energy = -408.53, improvement = 21.48
After minimization: energy = -462.06, improvement = 75.01

Complex relaxation cycle 12/25
After repacking: energy = -471.45, improvement = 84.41
After minimization: energy = -509.40, improvement = 122.35
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -450.06, improvement = 63.01
After minimization: energy = -508.94, improvement = 121.89

Complex relaxation cycle 14/25
After repacking: energy = -447.59, improvement = 60.55
After minimization: energy = -508.76, improvement = 121.71

Complex relaxation cycle 15/25
After repacking: energy = -448.55, improvement = 61.51
After minimization: energy = -509.64, improvement = 122.60
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -448.85, improvement = 61.80
After minimization: energy = -509.72, improvement = 122.67

Complex relaxation cycle 17/25
After repacking: energy = -447.31, improvement = 60.26
After minimization: energy = -508.65, improvement = 121.61

Complex relaxation cycle 18/25
After repacking: energy = -447.61, improvement = 60.56
After minimization: energy = -508.71, improvement = 121.67
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -442.24, improvement = 55.19
After minimization: energy = -507.85, improvement = 120.80

Complex relaxation cycle 20/25
After repacking: energy = -372.00, improvement = -15.04
After minimization: energy = -501.62, improvement = 114.57

Complex relaxation cycle 21/25
After repacking: energy = -402.22, improvement = 15.18
After minimization: energy = -468.62, improvement = 81.57
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -445.01, improvement = 57.96
After minimization: energy = -510.74, improvement = 123.69

Complex relaxation cycle 23/25
After repacking: energy = -443.95, improvement = 56.90
After minimization: energy = -508.41, improvement = 121.37

Complex relaxation cycle 24/25
After repacking: energy = -444.49, improvement = 57.45
After minimization: energy = -510.59, improvement = 123.54
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -442.90, improvement = 55.86
After minimization: energy = -509.82, improvement = 122.78

=== Complex Relaxation Summary ===
Initial energy: -387.05
Final energy: -586.62
Total energy improvement: 199.57 (51.6%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.31 Å
Interface energy: -59.82
Saved relaxed complex structure to docking_results/5_peptide_20mer_Ab0_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -586.62
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 7
  Salt bridges: 0
  Hydrophobic interactions: 8
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -59.82

Attempting to dock to CDR-L1...
CDR-L1 center: (-4.96, -0.77, 17.44)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-L1_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (15.04, -0.77, 17.44)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-L1_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab0_CDR-L1_combined.pdb
Initial score: -193.76
  Found better pose: -402.40
  Found better pose: -404.99
  Found better pose: -405.13
  Found better pose: -405.22
Checking contacts between peptide and CDR-L1...
Found 57 contacts with CDR-L1 (356.2% of CDR residues)
  Hydrogen bonds: 11
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -405.22
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -587.52, improvement = 182.30
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -342.09, improvement = -63.13
After minimization: energy = -515.53, improvement = 110.31

Complex relaxation cycle 2/25
After repacking: energy = -344.07, improvement = -61.14
After minimization: energy = -501.57, improvement = 96.35

Complex relaxation cycle 3/25
After repacking: energy = -444.76, improvement = 39.54
After minimization: energy = -516.02, improvement = 110.81

Complex relaxation cycle 4/25
After repacking: energy = -445.16, improvement = 39.94
After minimization: energy = -512.52, improvement = 107.31

Complex relaxation cycle 5/25
After repacking: energy = -445.08, improvement = 39.87
After minimization: energy = -512.50, improvement = 107.29

Complex relaxation cycle 6/25
After repacking: energy = -445.24, improvement = 40.03
After minimization: energy = -512.16, improvement = 106.95
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -445.11, improvement = 39.90
After minimization: energy = -512.16, improvement = 106.95

Complex relaxation cycle 8/25
After repacking: energy = -444.02, improvement = 38.80
After minimization: energy = -512.28, improvement = 107.07

Complex relaxation cycle 9/25
After repacking: energy = -443.33, improvement = 38.12
After minimization: energy = -512.28, improvement = 107.07
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -443.46, improvement = 38.24
After minimization: energy = -512.30, improvement = 107.08

Complex relaxation cycle 11/25
After repacking: energy = -443.73, improvement = 38.52
After minimization: energy = -512.20, improvement = 106.99

Complex relaxation cycle 12/25
After repacking: energy = -443.29, improvement = 38.08
After minimization: energy = -512.31, improvement = 107.10
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -443.07, improvement = 37.86
After minimization: energy = -512.03, improvement = 106.81

Complex relaxation cycle 14/25
After repacking: energy = -445.13, improvement = 39.92
After minimization: energy = -512.28, improvement = 107.06

Complex relaxation cycle 15/25
After repacking: energy = -443.04, improvement = 37.83
After minimization: energy = -512.14, improvement = 106.92
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -444.71, improvement = 39.49
After minimization: energy = -512.23, improvement = 107.02

Complex relaxation cycle 17/25
After repacking: energy = -442.96, improvement = 37.74
After minimization: energy = -512.19, improvement = 106.97

Complex relaxation cycle 18/25
After repacking: energy = -444.29, improvement = 39.08
After minimization: energy = -512.22, improvement = 107.00
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -444.57, improvement = 39.36
After minimization: energy = -512.07, improvement = 106.86

Complex relaxation cycle 20/25
After repacking: energy = -443.63, improvement = 38.41
After minimization: energy = -512.16, improvement = 106.95

Complex relaxation cycle 21/25
After repacking: energy = -444.08, improvement = 38.86
After minimization: energy = -512.33, improvement = 107.12
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -444.08, improvement = 38.87
After minimization: energy = -512.20, improvement = 106.98

Complex relaxation cycle 23/25
After repacking: energy = -442.37, improvement = 37.16
After minimization: energy = -511.98, improvement = 106.77

Complex relaxation cycle 24/25
After repacking: energy = -443.52, improvement = 38.30
After minimization: energy = -512.66, improvement = 107.45
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -442.97, improvement = 37.76
After minimization: energy = -512.75, improvement = 107.53

=== Complex Relaxation Summary ===
Initial energy: -405.22
Final energy: -587.52
Total energy improvement: 182.30 (45.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.26 Å
Interface energy: -54.55
Saved relaxed complex structure to docking_results/5_peptide_20mer_Ab0_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -587.52
Checking contacts between peptide and CDR-L1...
Found 58 contacts with CDR-L1 (362.5% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -54.55

Attempting to dock to CDR-L2...
CDR-L2 center: (-1.75, -6.60, -5.69)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-L2_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (18.25, -6.60, -5.69)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab0_CDR-L2_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab0_CDR-L2_combined.pdb
Initial score: 9513.83
  Found better pose: 6164.70
  Found better pose: 5767.04
  Found better pose: 3953.34
  Found better pose: 2179.10
  Found better pose: 1895.24
  Found better pose: 1786.07
  Found better pose: 823.05
  Found better pose: 775.36
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 10
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 775.36
Antibody/MHC residues: 1-119
Peptide residues: 120-232
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -559.81, improvement = 1335.17
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = -271.05, improvement = 1046.41
After minimization: energy = -442.28, improvement = 1217.64

Complex relaxation cycle 2/25
After repacking: energy = -278.99, improvement = 1054.35
After minimization: energy = -428.60, improvement = 1203.96

Complex relaxation cycle 3/25
After repacking: energy = -356.68, improvement = 1132.04
After minimization: energy = -440.42, improvement = 1215.78

Complex relaxation cycle 4/25
After repacking: energy = -370.68, improvement = 1146.04
After minimization: energy = -440.32, improvement = 1215.68

Complex relaxation cycle 5/25
After repacking: energy = -375.17, improvement = 1150.53
After minimization: energy = -441.23, improvement = 1216.59

Complex relaxation cycle 6/25
After repacking: energy = -373.53, improvement = 1148.89
After minimization: energy = -441.58, improvement = 1216.94
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -372.29, improvement = 1147.65
After minimization: energy = -440.88, improvement = 1216.24

Complex relaxation cycle 8/25
After repacking: energy = -373.47, improvement = 1148.83
After minimization: energy = -440.94, improvement = 1216.30

Complex relaxation cycle 9/25
After repacking: energy = -372.80, improvement = 1148.16
After minimization: energy = -440.95, improvement = 1216.31
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -373.12, improvement = 1148.48
After minimization: energy = -440.92, improvement = 1216.29

Complex relaxation cycle 11/25
After repacking: energy = -332.68, improvement = 1108.04
After minimization: energy = -401.33, improvement = 1176.69

Complex relaxation cycle 12/25
After repacking: energy = -373.41, improvement = 1148.77
After minimization: energy = -440.88, improvement = 1216.24
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -372.43, improvement = 1147.79
After minimization: energy = -440.67, improvement = 1216.03

Complex relaxation cycle 14/25
After repacking: energy = -372.41, improvement = 1147.77
After minimization: energy = -440.42, improvement = 1215.78

Complex relaxation cycle 15/25
After repacking: energy = -372.84, improvement = 1148.20
After minimization: energy = -441.40, improvement = 1216.76
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -333.32, improvement = 1108.68
After minimization: energy = -401.12, improvement = 1176.48

Complex relaxation cycle 17/25
After repacking: energy = -373.45, improvement = 1148.81
After minimization: energy = -440.52, improvement = 1215.88

Complex relaxation cycle 18/25
After repacking: energy = -374.07, improvement = 1149.43
After minimization: energy = -441.33, improvement = 1216.69
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -373.44, improvement = 1148.80
After minimization: energy = -441.39, improvement = 1216.76

Complex relaxation cycle 20/25
After repacking: energy = -372.93, improvement = 1148.29
After minimization: energy = -441.38, improvement = 1216.74

Complex relaxation cycle 21/25
After repacking: energy = -373.52, improvement = 1148.88
After minimization: energy = -441.43, improvement = 1216.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -373.31, improvement = 1148.67
After minimization: energy = -440.79, improvement = 1216.15

Complex relaxation cycle 23/25
After repacking: energy = -373.56, improvement = 1148.92
After minimization: energy = -440.35, improvement = 1215.71

Complex relaxation cycle 24/25
After repacking: energy = -332.80, improvement = 1108.16
After minimization: energy = -400.89, improvement = 1176.25
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -373.53, improvement = 1148.89
After minimization: energy = -441.25, improvement = 1216.61

=== Complex Relaxation Summary ===
Initial energy: 775.36
Final energy: -559.81
Total energy improvement: 1335.17 (172.2%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.28 Å
Interface energy: -37.93
Saved relaxed complex structure to docking_results/5_peptide_20mer_Ab0_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: -559.81
Checking contacts between peptide and CDR-L2...
Found 26 contacts with CDR-L2 (325.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: -37.93

Best binding found with CDR-L1, score: -587.52
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -405.21564438060534, 'relaxed_score': -587.5178283116094, 'interface_energy': -54.54904132502122, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 10, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/5_peptide_20mer_Ab0_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/5_peptide_20mer_Ab0_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.25917553221193285), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

----- Processing antibody Ab1 with peptide 5_peptide_20mer -----
Identified CDR regions:
  CDR-H1: 11 residues
  CDR-H2: 18 residues
  CDR-H3: 14 residues
  CDR-L1: 16 residues
  CDR-L2: 8 residues
  CDR-L3: 11 residues
Could not find CDR3 sequence CASSLDRGSEKLFF in antibody
Could not find CDR3 sequence CASSVGQGYEQYF in antibody

Docking peptide to specific CDR regions for docking_results/5_peptide_20mer_Ab1...
Peptide sequence: PHEILETYRALAGLYSERGLUGLYPHEASNCYSTYRPHEPROGLNSERTYRGLYGLNTHR
Antibody has 240 residues
Peptide has 20 residues
Saving antibody to docking_results/5_peptide_20mer_Ab1_antibody.pdb
Saving peptide to docking_results/5_peptide_20mer_Ab1_peptide.pdb
No epitope match found, using CDR-H3 as initial target
Will try CDRs in this order: ['CDR-H3', 'CDR-H2', 'CDR-H1', 'CDR-L3', 'CDR-L1', 'CDR-L2']

Attempting to dock to CDR-H3...
CDR-H3 center: (1.18, 3.74, -4.16)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-H3_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (21.18, 3.74, -4.16)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-H3_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab1_CDR-H3_combined.pdb
Initial score: 15487.83
  Found better pose: 13672.44
  Found better pose: 12956.26
  Found better pose: 12419.65
  Found better pose: 11646.97
  Found better pose: 8427.60
  Found better pose: 7406.34
  Found better pose: 6688.47
  Found better pose: 6361.21
  Found better pose: 4982.20
  Found better pose: 4771.97
Checking contacts between peptide and CDR-H3...
Found 0 contacts with CDR-H3 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H3
Peptide does not bind to CDR-H3 before relaxation, trying next CDR

Attempting to dock to CDR-H2...
CDR-H2 center: (1.45, 15.10, 2.19)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-H2_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (21.45, 15.10, 2.19)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-H2_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab1_CDR-H2_combined.pdb
Initial score: 1004.42
  Found better pose: 232.99
  Found better pose: 185.94
  Found better pose: 27.25
  Found better pose: -215.22
  Found better pose: -221.81
  Found better pose: -227.34
Checking contacts between peptide and CDR-H2...
Found 0 contacts with CDR-H2 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H2
Peptide does not bind to CDR-H2 before relaxation, trying next CDR

Attempting to dock to CDR-H1...
CDR-H1 center: (-9.60, 10.06, -4.65)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-H1_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (10.40, 10.06, -4.65)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-H1_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab1_CDR-H1_combined.pdb
Initial score: 20505.16
  Found better pose: 18220.19
  Found better pose: 18219.73
  Found better pose: 17409.07
  Found better pose: 16862.76
  Found better pose: 16413.26
  Found better pose: 16105.28
  Found better pose: 16030.61
Checking contacts between peptide and CDR-H1...
Found 0 contacts with CDR-H1 (0.0% of CDR residues)
  Hydrogen bonds: 0
  Salt bridges: 0
  Hydrophobic interactions: 0
Peptide is NOT binding to CDR-H1
Peptide does not bind to CDR-H1 before relaxation, trying next CDR

Attempting to dock to CDR-L3...
CDR-L3 center: (-2.42, -19.23, -1.67)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-L3_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (17.58, -19.23, -1.67)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-L3_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab1_CDR-L3_combined.pdb
Initial score: 3432.41
  Found better pose: 1877.57
  Found better pose: 1425.62
  Found better pose: 757.66
  Found better pose: 36.17
  Found better pose: -120.34
  Found better pose: -206.52
  Found better pose: -229.14
  Found better pose: -229.19
  Found better pose: -229.34
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -229.34
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L3 residues in movemap: 11 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -381.28, improvement = 151.94
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 317.74, improvement = -547.08
After minimization: energy = -185.21, improvement = -44.13

Complex relaxation cycle 2/25
After repacking: energy = -139.14, improvement = -90.20
After minimization: energy = -248.02, improvement = 18.68

Complex relaxation cycle 3/25
After repacking: energy = -218.94, improvement = -10.40
After minimization: energy = -264.34, improvement = 35.00

Complex relaxation cycle 4/25
After repacking: energy = -206.93, improvement = -22.41
After minimization: energy = -254.19, improvement = 24.86

Complex relaxation cycle 5/25
After repacking: energy = -181.28, improvement = -48.05
After minimization: energy = -227.51, improvement = -1.83

Complex relaxation cycle 6/25
After repacking: energy = -212.89, improvement = -16.45
After minimization: energy = -268.65, improvement = 39.31
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -198.97, improvement = -30.37
After minimization: energy = -258.37, improvement = 29.03

Complex relaxation cycle 8/25
After repacking: energy = -205.45, improvement = -23.89
After minimization: energy = -259.02, improvement = 29.68

Complex relaxation cycle 9/25
After repacking: energy = -222.60, improvement = -6.74
After minimization: energy = -277.50, improvement = 48.16
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -209.33, improvement = -20.01
After minimization: energy = -262.67, improvement = 33.33

Complex relaxation cycle 11/25
After repacking: energy = -220.96, improvement = -8.37
After minimization: energy = -274.85, improvement = 45.51

Complex relaxation cycle 12/25
After repacking: energy = -222.23, improvement = -7.11
After minimization: energy = -277.61, improvement = 48.27
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -207.29, improvement = -22.05
After minimization: energy = -263.95, improvement = 34.61

Complex relaxation cycle 14/25
After repacking: energy = -184.63, improvement = -44.71
After minimization: energy = -241.26, improvement = 11.92

Complex relaxation cycle 15/25
After repacking: energy = -191.58, improvement = -37.76
After minimization: energy = -242.13, improvement = 12.79
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -222.85, improvement = -6.49
After minimization: energy = -276.37, improvement = 47.03

Complex relaxation cycle 17/25
After repacking: energy = -221.97, improvement = -7.37
After minimization: energy = -275.22, improvement = 45.88

Complex relaxation cycle 18/25
After repacking: energy = -222.40, improvement = -6.94
After minimization: energy = -275.40, improvement = 46.06
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -200.12, improvement = -29.22
After minimization: energy = -258.75, improvement = 29.41

Complex relaxation cycle 20/25
After repacking: energy = -209.60, improvement = -19.74
After minimization: energy = -264.67, improvement = 35.33

Complex relaxation cycle 21/25
After repacking: energy = -209.38, improvement = -19.96
After minimization: energy = -264.77, improvement = 35.43
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -222.12, improvement = -7.22
After minimization: energy = -276.64, improvement = 47.31

Complex relaxation cycle 23/25
After repacking: energy = -208.61, improvement = -20.73
After minimization: energy = -264.44, improvement = 35.10

Complex relaxation cycle 24/25
After repacking: energy = -206.15, improvement = -23.19
After minimization: energy = -258.77, improvement = 29.43
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -221.45, improvement = -7.89
After minimization: energy = -276.92, improvement = 47.58

=== Complex Relaxation Summary ===
Initial energy: -229.34
Final energy: -381.28
Total energy improvement: 151.94 (66.3%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.54 Å
Interface energy: -52.44
Saved relaxed complex structure to docking_results/5_peptide_20mer_Ab1_CDR-L3_relaxed_complex.pdb
Score after complex relaxation: -381.28
Checking contacts between peptide and CDR-L3...
Found 40 contacts with CDR-L3 (363.6% of CDR residues)
  Hydrogen bonds: 8
  Salt bridges: 0
  Hydrophobic interactions: 5
Peptide is binding to CDR-L3 with Strong estimated binding strength
Peptide binds to CDR-L3 after relaxation
Interface energy: -52.44

Attempting to dock to CDR-L1...
CDR-L1 center: (-0.77, -2.21, 13.23)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-L1_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (19.23, -2.21, 13.23)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-L1_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab1_CDR-L1_combined.pdb
Initial score: -59.63
  Found better pose: -222.16
  Found better pose: -225.75
  Found better pose: -226.16
  Found better pose: -227.05
  Found better pose: -227.08
  Found better pose: -227.62
  Found better pose: -228.31
  Found better pose: -228.76
  Found better pose: -229.41
Checking contacts between peptide and CDR-L1...
Found 63 contacts with CDR-L1 (393.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: -229.41
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L1 residues in movemap: 16 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = -386.93, improvement = 157.51
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 331.66, improvement = -561.07
After minimization: energy = -204.55, improvement = -24.87

Complex relaxation cycle 2/25
After repacking: energy = -203.44, improvement = -25.97
After minimization: energy = -267.54, improvement = 38.12

Complex relaxation cycle 3/25
After repacking: energy = -220.60, improvement = -8.81
After minimization: energy = -267.78, improvement = 38.37

Complex relaxation cycle 4/25
After repacking: energy = -223.44, improvement = -5.97
After minimization: energy = -259.38, improvement = 29.97

Complex relaxation cycle 5/25
After repacking: energy = -219.37, improvement = -10.05
After minimization: energy = -260.45, improvement = 31.04

Complex relaxation cycle 6/25
After repacking: energy = -214.58, improvement = -14.84
After minimization: energy = -264.85, improvement = 35.43
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = -212.53, improvement = -16.88
After minimization: energy = -260.79, improvement = 31.37

Complex relaxation cycle 8/25
After repacking: energy = -215.70, improvement = -13.71
After minimization: energy = -261.75, improvement = 32.34

Complex relaxation cycle 9/25
After repacking: energy = -206.34, improvement = -23.08
After minimization: energy = -263.42, improvement = 34.01
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = -226.82, improvement = -2.59
After minimization: energy = -274.56, improvement = 45.15

Complex relaxation cycle 11/25
After repacking: energy = -209.01, improvement = -20.41
After minimization: energy = -265.14, improvement = 35.73

Complex relaxation cycle 12/25
After repacking: energy = -222.84, improvement = -6.57
After minimization: energy = -277.74, improvement = 48.32
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = -217.41, improvement = -12.01
After minimization: energy = -269.39, improvement = 39.98

Complex relaxation cycle 14/25
After repacking: energy = -56.83, improvement = -172.58
After minimization: energy = -277.71, improvement = 48.30

Complex relaxation cycle 15/25
After repacking: energy = -204.01, improvement = -25.41
After minimization: energy = -261.63, improvement = 32.22
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = -207.71, improvement = -21.70
After minimization: energy = -263.24, improvement = 33.83

Complex relaxation cycle 17/25
After repacking: energy = -208.89, improvement = -20.53
After minimization: energy = -263.12, improvement = 33.71

Complex relaxation cycle 18/25
After repacking: energy = -210.56, improvement = -18.85
After minimization: energy = -263.09, improvement = 33.68
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = -210.29, improvement = -19.12
After minimization: energy = -263.10, improvement = 33.69

Complex relaxation cycle 20/25
After repacking: energy = -183.14, improvement = -46.28
After minimization: energy = -236.18, improvement = 6.76

Complex relaxation cycle 21/25
After repacking: energy = -222.35, improvement = -7.06
After minimization: energy = -275.15, improvement = 45.74
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = -210.36, improvement = -19.06
After minimization: energy = -263.10, improvement = 33.69

Complex relaxation cycle 23/25
After repacking: energy = -209.83, improvement = -19.58
After minimization: energy = -262.90, improvement = 33.48

Complex relaxation cycle 24/25
After repacking: energy = -221.90, improvement = -7.52
After minimization: energy = -274.77, improvement = 45.35
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = -222.37, improvement = -7.05
After minimization: energy = -275.11, improvement = 45.70

=== Complex Relaxation Summary ===
Initial energy: -229.41
Final energy: -386.93
Total energy improvement: 157.51 (68.7%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.48 Å
Interface energy: -52.69
Saved relaxed complex structure to docking_results/5_peptide_20mer_Ab1_CDR-L1_relaxed_complex.pdb
Score after complex relaxation: -386.93
Checking contacts between peptide and CDR-L1...
Found 59 contacts with CDR-L1 (368.8% of CDR residues)
  Hydrogen bonds: 10
  Salt bridges: 0
  Hydrophobic interactions: 11
Peptide is binding to CDR-L1 with Strong estimated binding strength
Peptide binds to CDR-L1 after relaxation
Interface energy: -52.69

Attempting to dock to CDR-L2...
CDR-L2 center: (-5.72, -5.83, 0.36)
Creating combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-L2_combined.pdb
Peptide center of mass: (-37.72, 8.25, 1.51)
Positioning peptide at: (14.28, -5.83, 0.36)
Successfully created combined PDB file: docking_results/5_peptide_20mer_Ab1_CDR-L2_combined.pdb
Loading combined pose from docking_results/5_peptide_20mer_Ab1_CDR-L2_combined.pdb
Initial score: 17836.27
  Found better pose: 16845.82
  Found better pose: 16558.32
  Found better pose: 14730.71
  Found better pose: 11620.35
  Found better pose: 9818.42
  Found better pose: 8691.46
  Found better pose: 8199.93
  Found better pose: 3739.75
  Found better pose: 3095.82
  Found better pose: 2144.71
Checking contacts between peptide and CDR-L2...
Found 29 contacts with CDR-L2 (362.5% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2, performing energy relaxation...

=== Relaxing Peptide-Antibody Complex (25 cycles) ===
Initial complex energy: 2144.71
Antibody/MHC residues: 1-129
Peptide residues: 130-240
Including CDR-L2 residues in movemap: 8 residues

Attempting FastRelax protocol for complex...
FastRelax result: energy = 1093.81, improvement = 1050.89
FastRelax produced the best structure so far

Performing 25 cycles of manual complex optimization...

Complex relaxation cycle 1/25
After repacking: energy = 2214.11, improvement = -69.40
After minimization: energy = 1488.70, improvement = 656.01

Complex relaxation cycle 2/25
After repacking: energy = 1651.94, improvement = 492.77
After minimization: energy = 1328.29, improvement = 816.41

Complex relaxation cycle 3/25
After repacking: energy = 1642.31, improvement = 502.39
After minimization: energy = 1338.21, improvement = 806.50

Complex relaxation cycle 4/25
After repacking: energy = 1614.76, improvement = 529.94
After minimization: energy = 1328.21, improvement = 816.49

Complex relaxation cycle 5/25
After repacking: energy = 1652.73, improvement = 491.98
After minimization: energy = 1364.66, improvement = 780.05

Complex relaxation cycle 6/25
After repacking: energy = 1626.99, improvement = 517.72
After minimization: energy = 1337.83, improvement = 806.88
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 7/25
After repacking: energy = 1614.53, improvement = 530.18
After minimization: energy = 1325.50, improvement = 819.20

Complex relaxation cycle 8/25
After repacking: energy = 1642.02, improvement = 502.69
After minimization: energy = 1352.47, improvement = 792.24

Complex relaxation cycle 9/25
After repacking: energy = 1627.04, improvement = 517.66
After minimization: energy = 1338.02, improvement = 806.68
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 10/25
After repacking: energy = 1615.79, improvement = 528.92
After minimization: energy = 1325.77, improvement = 818.94

Complex relaxation cycle 11/25
After repacking: energy = 1652.69, improvement = 492.01
After minimization: energy = 1364.25, improvement = 780.46

Complex relaxation cycle 12/25
After repacking: energy = 1626.45, improvement = 518.25
After minimization: energy = 1337.42, improvement = 807.28
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 13/25
After repacking: energy = 1630.32, improvement = 514.38
After minimization: energy = 1337.89, improvement = 806.82

Complex relaxation cycle 14/25
After repacking: energy = 1626.51, improvement = 518.20
After minimization: energy = 1337.51, improvement = 807.19

Complex relaxation cycle 15/25
After repacking: energy = 1627.16, improvement = 517.55
After minimization: energy = 1337.93, improvement = 806.78
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 16/25
After repacking: energy = 1627.51, improvement = 517.20
After minimization: energy = 1337.66, improvement = 807.05

Complex relaxation cycle 17/25
After repacking: energy = 1626.69, improvement = 518.02
After minimization: energy = 1336.98, improvement = 807.73

Complex relaxation cycle 18/25
After repacking: energy = 1653.29, improvement = 491.42
After minimization: energy = 1366.80, improvement = 777.91
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 19/25
After repacking: energy = 1631.44, improvement = 513.26
After minimization: energy = 1336.78, improvement = 807.93

Complex relaxation cycle 20/25
After repacking: energy = 1617.28, improvement = 527.43
After minimization: energy = 1331.89, improvement = 812.82

Complex relaxation cycle 21/25
After repacking: energy = 1621.11, improvement = 523.59
After minimization: energy = 1331.89, improvement = 812.82
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 22/25
After repacking: energy = 1626.50, improvement = 518.20
After minimization: energy = 1337.69, improvement = 807.02

Complex relaxation cycle 23/25
After repacking: energy = 1627.36, improvement = 517.35
After minimization: energy = 1337.80, improvement = 806.91

Complex relaxation cycle 24/25
After repacking: energy = 1626.35, improvement = 518.36
After minimization: energy = 1359.86, improvement = 784.85
No improvement in last 3 cycles (best was cycle 1)
Continuing relaxation in case we can escape local minimum...

Complex relaxation cycle 25/25
After repacking: energy = 1604.46, improvement = 540.25
After minimization: energy = 1325.11, improvement = 819.60

=== Complex Relaxation Summary ===
Initial energy: 2144.71
Final energy: 1093.81
Total energy improvement: 1050.89 (49.0%)
Best structure was from cycle 1
Structure change: CA RMSD = 0.67 Å
Interface energy: 1418.48
Saved relaxed complex structure to docking_results/5_peptide_20mer_Ab1_CDR-L2_relaxed_complex.pdb
Score after complex relaxation: 1093.81
Checking contacts between peptide and CDR-L2...
Found 28 contacts with CDR-L2 (350.0% of CDR residues)
  Hydrogen bonds: 6
  Salt bridges: 0
  Hydrophobic interactions: 15
Peptide is binding to CDR-L2 with Strong estimated binding strength
Peptide binds to CDR-L2 after relaxation
Interface energy: 1418.48

Best binding found with CDR-L1, score: -386.93
Docking complete. Results: {'binding_cdr': 'CDR-L1', 'initial_score': -229.41323804836603, 'relaxed_score': -386.9282290664485, 'interface_energy': -52.68821371488315, 'binding_to_cdr': True, 'binding_strength': 'Strong', 'hydrogen_bonds': 10, 'salt_bridges': 0, 'hydrophobic': 11, 'contains_epitope': False, 'matching_epitope': None, 'output_pdb': 'docking_results/5_peptide_20mer_Ab1_CDR-L1_relaxed_complex.pdb', 'best_complex_pdb': 'docking_results/5_peptide_20mer_Ab1_best_complex.pdb', 'peptide_stability_class': 'Very Low', 'peptide_stability_score': np.float64(0.25917553221193285), 'peptide_structured_percent': 0.0, 'peptide_flexibility': 'Low (Rigid)'}

Analysis complete! Check the 'docking_results' and 'stability_results' directories for all outputs.
